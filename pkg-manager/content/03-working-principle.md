# åŒ…ç®¡ç†å™¨å·¥ä½œåŸç†

## æ¦‚è¿°

æ·±å…¥ç†è§£åŒ…ç®¡ç†å™¨çš„å†…éƒ¨æœºåˆ¶ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°æ’æŸ¥é—®é¢˜å’Œä¼˜åŒ–æ€§èƒ½ã€‚

## ä¸€ã€npm å®‰è£…æµç¨‹

### 1.1 å®Œæ•´å®‰è£…è¿‡ç¨‹

```bash
npm install lodash
```

**æ­¥éª¤è§£æï¼š**

```
1. æ£€æŸ¥é…ç½®
   â†“
2. è§£æä¾èµ–
   â†“
3. æŸ¥è¯¢ç¼“å­˜
   â†“
4. ä¸‹è½½åŒ…
   â†“
5. è§£å‹æ–‡ä»¶
   â†“
6. é“¾æ¥ä¾èµ–
   â†“
7. æ‰§è¡Œç”Ÿå‘½å‘¨æœŸè„šæœ¬
   â†“
8. æ›´æ–° package.json å’Œ lock æ–‡ä»¶
```

### 1.2 è¯¦ç»†æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. è¯»å– package.json                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. è§£æä¾èµ–ç‰ˆæœ¬                     â”‚
â”‚    - è¯»å– package-lock.json         â”‚
â”‚    - è®¡ç®—ç‰ˆæœ¬èŒƒå›´                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. æ„å»ºä¾èµ–æ ‘                       â”‚
â”‚    - é€’å½’è§£ææ‰€æœ‰ä¾èµ–               â”‚
â”‚    - å¤„ç†ç‰ˆæœ¬å†²çª                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. æ‰å¹³åŒ–ä¾èµ–æ ‘                     â”‚
â”‚    - æå‡å…¬å…±ä¾èµ–                   â”‚
â”‚    - å¤„ç†åµŒå¥—ä¾èµ–                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. æ£€æŸ¥ç¼“å­˜                         â”‚
â”‚    ~/.npm/_cacache/                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
         â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
         â”‚           â”‚
    å‘½ä¸­ç¼“å­˜      æœªå‘½ä¸­
         â”‚           â”‚
         â†“           â†“
    å¤åˆ¶æ–‡ä»¶    ä¸‹è½½åŒ…ï¼ˆregistryï¼‰
         â”‚           â”‚
         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. è§£å‹åˆ° node_modules              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. é“¾æ¥äºŒè¿›åˆ¶æ–‡ä»¶                   â”‚
â”‚    node_modules/.bin/               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. æ‰§è¡Œç”Ÿå‘½å‘¨æœŸé’©å­                 â”‚
â”‚    - preinstall                     â”‚
â”‚    - install                        â”‚
â”‚    - postinstall                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 9. æ›´æ–° package-lock.json           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## äºŒã€node_modules ç»“æ„

### 2.1 npm v2 - åµŒå¥—ç»“æ„

```
node_modules/
â”œâ”€â”€ A@1.0.0/
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ node_modules/
â”‚       â”œâ”€â”€ C@1.0.0/
â”‚       â””â”€â”€ D@1.0.0/
â””â”€â”€ B@1.0.0/
    â”œâ”€â”€ package.json
    â””â”€â”€ node_modules/
        â”œâ”€â”€ C@2.0.0/
        â””â”€â”€ E@1.0.0/
```

**ç‰¹ç‚¹ï¼š**
- âœ… ç»“æ„æ¸…æ™°ï¼Œä¾èµ–å…³ç³»æ˜ç¡®
- âŒ ç›®å½•å±‚çº§æ·±ï¼ˆWindows è·¯å¾„é™åˆ¶ï¼‰
- âŒ é‡å¤ä¾èµ–ï¼Œç£ç›˜æµªè´¹

### 2.2 npm v3+ - æ‰å¹³åŒ–ç»“æ„

```
node_modules/
â”œâ”€â”€ A@1.0.0/
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ B@1.0.0/
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ node_modules/
â”‚       â””â”€â”€ C@2.0.0/    # ç‰ˆæœ¬å†²çªï¼Œä¿æŒåµŒå¥—
â”œâ”€â”€ C@1.0.0/            # æå‡åˆ°é¡¶å±‚
â”œâ”€â”€ D@1.0.0/
â””â”€â”€ E@1.0.0/
```

**æå‡ç®—æ³•ï¼š**

```javascript
// ç®€åŒ–çš„æå‡ç®—æ³•
function hoist(dependencies) {
  const hoisted = new Map();
  const nested = new Map();
  
  for (const [name, version] of dependencies) {
    // å¦‚æœé¡¶å±‚å·²æœ‰è¯¥åŒ…
    if (hoisted.has(name)) {
      const existingVersion = hoisted.get(name);
      // ç‰ˆæœ¬ä¸å…¼å®¹ï¼Œä¿æŒåµŒå¥—
      if (!isCompatible(existingVersion, version)) {
        nested.set(`${name}@${version}`, version);
      }
    } else {
      // æå‡åˆ°é¡¶å±‚
      hoisted.set(name, version);
    }
  }
  
  return { hoisted, nested };
}
```

**å¹½çµä¾èµ–ï¼ˆPhantom Dependenciesï¼‰é—®é¢˜ï¼š**

```javascript
// package.json ä¸­æ²¡æœ‰å£°æ˜ lodash
{
  "dependencies": {
    "some-package": "^1.0.0"
  }
}

// ä½†å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼ˆsome-package ä¾èµ–äº† lodashï¼‰
import _ from 'lodash';  // âš ï¸ å¯ä»¥ç”¨ï¼Œä½†ä¸åº”è¯¥
```

**é—®é¢˜ï¼š**
- âŒ ä¾èµ–ä¸æ˜ç¡®
- âŒ some-package æ›´æ–°å¯èƒ½ç§»é™¤ lodash
- âŒ ä»£ç çªç„¶æŠ¥é”™

### 2.3 pnpm - å†…å®¹å¯»å€å­˜å‚¨

```
node_modules/
â”œâ”€â”€ .pnpm/                        # çœŸå®æ–‡ä»¶å­˜å‚¨
â”‚   â”œâ”€â”€ lodash@4.17.21/
â”‚   â”‚   â””â”€â”€ node_modules/
â”‚   â”‚       â””â”€â”€ lodash/           # ç¡¬é“¾æ¥åˆ°å…¨å±€ store
â”‚   â””â”€â”€ react@18.2.0/
â”‚       â””â”€â”€ node_modules/
â”‚           â”œâ”€â”€ react/
â”‚           â””â”€â”€ loose-envify/     # react çš„ä¾èµ–ä¹Ÿåœ¨è¿™
â””â”€â”€ lodash -> .pnpm/lodash@4.17.21/node_modules/lodash  # ç¬¦å·é“¾æ¥
```

**å…¨å±€ storeï¼š**

```
~/.pnpm-store/
â””â”€â”€ v3/
    â””â”€â”€ files/
        â””â”€â”€ 00/
            â””â”€â”€ 1a2b3c4d...  # ä»¥æ–‡ä»¶å†…å®¹å“ˆå¸Œå‘½å
                â””â”€â”€ index.js
```

**ä¼˜åŠ¿ï¼š**
- âœ… ä¸¥æ ¼ä¾èµ–ï¼šæ²¡æœ‰å¹½çµä¾èµ–
- âœ… èŠ‚çœç©ºé—´ï¼šç¡¬é“¾æ¥ï¼Œä¸€ä»½æ–‡ä»¶å¤šå¤„ä½¿ç”¨
- âœ… é€Ÿåº¦å¿«ï¼šç¡¬é“¾æ¥å‡ ä¹ç¬é—´å®Œæˆ

## ä¸‰ã€é“¾æ¥æœºåˆ¶è¯¦è§£

### 3.1 ç¡¬é“¾æ¥ï¼ˆHard Linkï¼‰

**æ¦‚å¿µï¼š** å¤šä¸ªæ–‡ä»¶åæŒ‡å‘åŒä¸€ä¸ª inodeï¼ˆæ–‡ä»¶æ•°æ®ï¼‰

```bash
# pnpm ä½¿ç”¨ç¡¬é“¾æ¥
~/.pnpm-store/v3/files/00/1a2b3c/index.js  # æºæ–‡ä»¶
                   â†“
node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/index.js  # ç¡¬é“¾æ¥
```

**ç‰¹ç‚¹ï¼š**
- âš¡ åˆ›å»ºé€Ÿåº¦æå¿«
- ğŸ’¾ ä¸å ç”¨é¢å¤–ç©ºé—´
- âœ… ä¿®æ”¹ä¸€å¤„ï¼Œæ‰€æœ‰åœ°æ–¹ç”Ÿæ•ˆ
- âš ï¸ è·¨æ–‡ä»¶ç³»ç»Ÿä¸æ”¯æŒ

**éªŒè¯ç¡¬é“¾æ¥ï¼š**

```bash
# æŸ¥çœ‹ inode å·
ls -li node_modules/lodash/index.js
ls -li ~/.pnpm-store/v3/files/00/1a2b3c/index.js

# inode å·ç›¸åŒï¼Œè¯´æ˜æ˜¯ç¡¬é“¾æ¥
```

### 3.2 ç¬¦å·é“¾æ¥ï¼ˆSymbolic Link / Soft Linkï¼‰

**æ¦‚å¿µï¼š** æŒ‡å‘å¦ä¸€ä¸ªæ–‡ä»¶è·¯å¾„çš„ç‰¹æ®Šæ–‡ä»¶

```bash
# pnpm ä½¿ç”¨ç¬¦å·é“¾æ¥è¿æ¥åˆ° .pnpm ç›®å½•
node_modules/lodash -> .pnpm/lodash@4.17.21/node_modules/lodash
```

**ç‰¹ç‚¹ï¼š**
- ğŸ“ æŒ‡å‘è·¯å¾„ï¼ˆä¸æ˜¯ inodeï¼‰
- âœ… å¯è·¨æ–‡ä»¶ç³»ç»Ÿ
- âš ï¸ ç›®æ ‡åˆ é™¤ï¼Œé“¾æ¥å¤±æ•ˆ

**éªŒè¯ç¬¦å·é“¾æ¥ï¼š**

```bash
ls -l node_modules/lodash
# lrwxr-xr-x  1 user  staff  .pnpm/lodash@4.17.21/node_modules/lodash
```

### 3.3 npm linkï¼ˆæœ¬åœ°å¼€å‘ï¼‰

**åœºæ™¯ï¼š** æœ¬åœ°å¼€å‘å¤šä¸ªäº’ç›¸ä¾èµ–çš„åŒ…

```bash
# 1. åœ¨åŒ… A ç›®å½•
cd ~/projects/package-a
npm link  # åˆ›å»ºå…¨å±€ç¬¦å·é“¾æ¥

# 2. åœ¨é¡¹ç›®ä¸­ä½¿ç”¨
cd ~/projects/my-app
npm link package-a  # é“¾æ¥åˆ°æœ¬åœ° package-a
```

**åŸç†ï¼š**

```
~/.npm/lib/node_modules/package-a  # å…¨å±€ç¬¦å·é“¾æ¥
           â†“
~/projects/package-a               # æœ¬åœ°å¼€å‘ç›®å½•
           â†“
~/projects/my-app/node_modules/package-a  # é¡¹ç›®ä¸­çš„é“¾æ¥
```

**æ¸…ç†ï¼š**

```bash
cd ~/projects/my-app
npm unlink package-a

cd ~/projects/package-a
npm unlink
```

## å››ã€ç¼“å­˜æœºåˆ¶

### 4.1 npm ç¼“å­˜

**ç¼“å­˜ä½ç½®ï¼š**

```bash
~/.npm/_cacache/
â”œâ”€â”€ content-v2/        # å‹ç¼©çš„åŒ…å†…å®¹
â”‚   â””â”€â”€ sha512/
â”‚       â””â”€â”€ 00/
â”‚           â””â”€â”€ 1a2b3c...
â”œâ”€â”€ index-v5/          # åŒ…å…ƒæ•°æ®ç´¢å¼•
â””â”€â”€ tmp/               # ä¸´æ—¶æ–‡ä»¶
```

**ç¼“å­˜æµç¨‹ï¼š**

```javascript
// ç®€åŒ–çš„ç¼“å­˜é€»è¾‘
async function downloadPackage(name, version) {
  const cacheKey = `${name}@${version}`;
  
  // 1. æ£€æŸ¥ç¼“å­˜
  const cached = await cache.get(cacheKey);
  if (cached) {
    console.log('ä»ç¼“å­˜è¯»å–');
    return cached;
  }
  
  // 2. ä¸‹è½½åŒ…
  const tarball = await download(name, version);
  
  // 3. å†™å…¥ç¼“å­˜
  await cache.put(cacheKey, tarball);
  
  return tarball;
}
```

**ç¼“å­˜ç®¡ç†ï¼š**

```bash
# æŸ¥çœ‹ç¼“å­˜ä½ç½®
npm config get cache

# æ¸…ç†ç¼“å­˜
npm cache clean --force

# éªŒè¯ç¼“å­˜
npm cache verify
```

### 4.2 Yarn ç¼“å­˜

**ç¼“å­˜ä½ç½®ï¼š**

```bash
~/.yarn/cache/
â””â”€â”€ npm-lodash-4.17.21-6382451519-b0b0c7b24a.zip
```

**ç‰¹ç‚¹ï¼š**
- ğŸ“¦ ä»¥ `.zip` æ ¼å¼å­˜å‚¨å®Œæ•´åŒ…
- ğŸ”’ ä½¿ç”¨å®Œæ•´æ€§æ ¡éªŒï¼ˆintegrity hashï¼‰
- âš¡ ç¦»çº¿æ¨¡å¼ï¼šå®Œå…¨ä¸éœ€è¦ç½‘ç»œ

**ç¦»çº¿å®‰è£…ï¼š**

```bash
# é…ç½®ç¦»çº¿æ¨¡å¼
yarn config set yarn-offline-mirror ./npm-packages-offline-cache

# ç¬¬äºŒæ¬¡å®‰è£…å®Œå…¨ç¦»çº¿
yarn install --offline
```

### 4.3 pnpm store

**Store ä½ç½®ï¼š**

```bash
~/.pnpm-store/
â””â”€â”€ v3/
    â””â”€â”€ files/
        â””â”€â”€ 00/
            â””â”€â”€ 1a2b3c4d...  # å†…å®¹å¯»å€
```

**å†…å®¹å¯»å€ï¼ˆContent-Addressableï¼‰ï¼š**

```javascript
// æ–‡ä»¶ä»¥å†…å®¹å“ˆå¸Œå‘½å
const hash = sha512(fileContent);
const storePath = `~/.pnpm-store/v3/files/${hash.slice(0,2)}/${hash}`;

// åŒæ ·çš„æ–‡ä»¶å†…å®¹åªå­˜ä¸€ä»½
```

**Store ç®¡ç†ï¼š**

```bash
# æŸ¥çœ‹ store ä½ç½®
pnpm store path

# æ¸…ç†æœªä½¿ç”¨çš„åŒ…
pnpm store prune

# æŸ¥çœ‹ store çŠ¶æ€
pnpm store status
```

## äº”ã€ä¾èµ–è§£æç®—æ³•

### 5.1 ç‰ˆæœ¬è§£æ

```javascript
// ç®€åŒ–çš„ç‰ˆæœ¬è§£æ
function resolveVersion(versionRange, availableVersions) {
  // 1. è§£æç‰ˆæœ¬èŒƒå›´
  const range = parseRange(versionRange);  // ^1.2.3 â†’ >=1.2.3 <2.0.0
  
  // 2. è¿‡æ»¤ç¬¦åˆæ¡ä»¶çš„ç‰ˆæœ¬
  const validVersions = availableVersions.filter(v => 
    satisfies(v, range)
  );
  
  // 3. è¿”å›æœ€é«˜ç‰ˆæœ¬
  return max(validVersions);
}

// ç¤ºä¾‹
resolveVersion('^1.2.3', ['1.2.3', '1.3.0', '1.9.9', '2.0.0']);
// è¿”å› '1.9.9'
```

### 5.2 ä¾èµ–æ ‘æ„å»º

```javascript
// é€’å½’æ„å»ºä¾èµ–æ ‘
async function buildDependencyTree(packageName, version) {
  const tree = {
    name: packageName,
    version,
    dependencies: {}
  };
  
  // 1. è·å–åŒ…ä¿¡æ¯
  const pkg = await getPackageInfo(packageName, version);
  
  // 2. é€’å½’å¤„ç†ä¾èµ–
  for (const [depName, depRange] of Object.entries(pkg.dependencies)) {
    const depVersion = await resolveVersion(depRange);
    tree.dependencies[depName] = await buildDependencyTree(depName, depVersion);
  }
  
  return tree;
}
```

### 5.3 å¾ªç¯ä¾èµ–å¤„ç†

```javascript
// æ£€æµ‹å¾ªç¯ä¾èµ–
function detectCyclicDependency(tree, visited = new Set()) {
  const key = `${tree.name}@${tree.version}`;
  
  // æ£€æµ‹åˆ°å¾ªç¯
  if (visited.has(key)) {
    console.warn(`å¾ªç¯ä¾èµ–: ${key}`);
    return true;
  }
  
  visited.add(key);
  
  // é€’å½’æ£€æŸ¥å­ä¾èµ–
  for (const dep of Object.values(tree.dependencies)) {
    if (detectCyclicDependency(dep, new Set(visited))) {
      return true;
    }
  }
  
  return false;
}
```

**å¾ªç¯ä¾èµ–ç¤ºä¾‹ï¼š**

```
A â†’ B â†’ C â†’ A  # å¾ªç¯
```

**CommonJS å¤„ç†ï¼š** è¿”å›éƒ¨åˆ†å¯¼å‡ºçš„å¯¹è±¡  
**ESM å¤„ç†ï¼š** å¼•ç”¨ç»‘å®šï¼Œæ›´å¥½åœ°å¤„ç†å¾ªç¯

## å…­ã€Lock æ–‡ä»¶æœºåˆ¶

### 6.1 ä¸ºä»€ä¹ˆéœ€è¦ Lock æ–‡ä»¶

**æ²¡æœ‰ Lock æ–‡ä»¶ï¼š**

```json
// package.json
{
  "dependencies": {
    "lodash": "^4.17.0"
  }
}

// ç¬¬ä¸€æ¬¡å®‰è£…ï¼šå®‰è£… 4.17.20
// ç¬¬äºŒæ¬¡å®‰è£…ï¼šå®‰è£… 4.17.21ï¼ˆæ–°ç‰ˆæœ¬å‘å¸ƒï¼‰
// âŒ ä¸åŒæ—¶é—´å®‰è£…ï¼Œç‰ˆæœ¬ä¸ä¸€è‡´
```

**æœ‰äº† Lock æ–‡ä»¶ï¼š**

```yaml
# package-lock.json / yarn.lock / pnpm-lock.yaml
lodash@^4.17.0:
  version: 4.17.20  # é”å®šç²¾ç¡®ç‰ˆæœ¬
  resolved: https://registry.npmjs.org/lodash/-/lodash-4.17.20.tgz
  integrity: sha512-...
```

### 6.2 Lock æ–‡ä»¶å¯¹æ¯”

| Lock æ–‡ä»¶ | æ ¼å¼ | ç‰¹ç‚¹ |
|-----------|------|------|
| package-lock.json | JSON | npm ä½¿ç”¨ï¼Œè¯¦ç»†ä½†å†—é•¿ |
| yarn.lock | YAML-like | Yarn ä½¿ç”¨ï¼Œç®€æ´ |
| pnpm-lock.yaml | YAML | pnpm ä½¿ç”¨ï¼Œæœ€ç®€æ´ |

## å‚è€ƒèµ„æ–™

- [npm å®‰è£…æœºåˆ¶](https://docs.npmjs.com/cli/v9/commands/npm-install)
- [pnpm å·¥ä½œåŸç†](https://pnpm.io/motivation)
- [Yarn ç¼“å­˜æœºåˆ¶](https://yarnpkg.com/features/offline-cache)
- [Node.js æ¨¡å—è§£æç®—æ³•](https://nodejs.org/api/modules.html#modules_all_together)

---

**å¯¼èˆª**  
[ä¸Šä¸€ç« ï¼šæ¨¡å—åŒ–ä¸ä¾èµ–ç®¡ç†](./02-modularity.md) | [è¿”å›ç›®å½•](../README.md) | [ä¸‹ä¸€ç« ï¼šregistryä¸é•œåƒæº](./04-registry.md)
