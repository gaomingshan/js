# ç¬¬ 2 ç« ï¼šæ¨¡å—åŒ–ä¸ä¾èµ–ç®¡ç† - é¢è¯•é¢˜

**éš¾åº¦åˆ†å¸ƒï¼š** ğŸŸ¢ ç®€å• x3 | ğŸŸ¡ ä¸­ç­‰ x4 | ğŸ”´ å›°éš¾ x3

---

## ç¬¬ 1 é¢˜ ğŸŸ¢

**ç±»å‹ï¼š** å•é€‰é¢˜  
**æ ‡ç­¾ï¼š** æ¨¡å—åŒ–åŸºç¡€

### é¢˜ç›®

CommonJS å’Œ ES Modules çš„ä¸»è¦åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ

**é€‰é¡¹ï¼š**
- A. CommonJS æ˜¯åŒæ­¥åŠ è½½ï¼ŒES Modules æ˜¯å¼‚æ­¥åŠ è½½
- B. CommonJS åªèƒ½åœ¨æµè§ˆå™¨ä½¿ç”¨ï¼ŒES Modules åªèƒ½åœ¨ Node.js ä½¿ç”¨
- C. ä¸¤è€…å®Œå…¨ç›¸åŒ
- D. ES Modules ä¸æ”¯æŒå¯¼å‡º

<details>
<summary>æŸ¥çœ‹ç­”æ¡ˆ</summary>

### âœ… æ­£ç¡®ç­”æ¡ˆï¼šA

### ğŸ“– è§£æ

**CommonJS vs ES Modules**

#### CommonJSï¼ˆåŒæ­¥åŠ è½½ï¼‰

```javascript
// å¯¼å‡º
module.exports = {
  add: (a, b) => a + b
};

// å¯¼å…¥ï¼ˆåŒæ­¥ï¼‰
const math = require('./math');
console.log(math.add(1, 2));
```

**ç‰¹ç‚¹ï¼š**
- åŒæ­¥åŠ è½½ï¼Œé€‚åˆæœåŠ¡ç«¯
- è¿è¡Œæ—¶åŠ è½½
- å€¼æ‹·è´
- `require()` å’Œ `module.exports`

#### ES Modulesï¼ˆå¼‚æ­¥åŠ è½½ï¼‰

```javascript
// å¯¼å‡º
export const add = (a, b) => a + b;

// å¯¼å…¥ï¼ˆå¼‚æ­¥ï¼‰
import { add } from './math.js';
console.log(add(1, 2));
```

**ç‰¹ç‚¹ï¼š**
- å¼‚æ­¥åŠ è½½ï¼Œé€‚åˆæµè§ˆå™¨
- ç¼–è¯‘æ—¶åŠ è½½ï¼ˆé™æ€åˆ†æï¼‰
- å€¼å¼•ç”¨
- `import` å’Œ `export`
- æ”¯æŒ Tree Shaking

**å¯¹æ¯”è¡¨ï¼š**

| ç‰¹æ€§ | CommonJS | ES Modules |
|------|----------|------------|
| åŠ è½½æ–¹å¼ | åŒæ­¥ | å¼‚æ­¥ |
| åŠ è½½æ—¶æœº | è¿è¡Œæ—¶ | ç¼–è¯‘æ—¶ |
| å¯¼å‡º | module.exports | export |
| å¯¼å…¥ | require() | import |
| Tree Shaking | âŒ | âœ… |

</details>

---

## ç¬¬ 2 é¢˜ ğŸŸ¢

**ç±»å‹ï¼š** åˆ¤æ–­é¢˜  
**æ ‡ç­¾ï¼š** ä¾èµ–ç®¡ç†

### é¢˜ç›®

package.json ä¸­çš„ dependencies å’Œ devDependencies åœ¨ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ—¶éƒ½ä¼šè¢«å®‰è£…ã€‚

**é€‰é¡¹ï¼š**
- A. âœ… æ­£ç¡®
- B. âŒ é”™è¯¯

<details>
<summary>æŸ¥çœ‹ç­”æ¡ˆ</summary>

### âœ… æ­£ç¡®ç­”æ¡ˆï¼šBï¼ˆé”™è¯¯ï¼‰

### ğŸ“– è§£æ

**ä¾èµ–ç±»å‹åŒºåˆ†**

#### dependenciesï¼ˆç”Ÿäº§ä¾èµ–ï¼‰

```json
{
  "dependencies": {
    "express": "^4.18.0",
    "lodash": "^4.17.21"
  }
}
```

- âœ… ç”Ÿäº§ç¯å¢ƒéœ€è¦
- âœ… è¿è¡Œæ—¶å¿…éœ€
- âœ… `npm install --production` ä¼šå®‰è£…

#### devDependenciesï¼ˆå¼€å‘ä¾èµ–ï¼‰

```json
{
  "devDependencies": {
    "eslint": "^8.0.0",
    "jest": "^29.0.0",
    "typescript": "^5.0.0"
  }
}
```

- âŒ ç”Ÿäº§ç¯å¢ƒä¸éœ€è¦
- âœ… å¼€å‘/æµ‹è¯•æ—¶ä½¿ç”¨
- âŒ `npm install --production` ä¸å®‰è£…

**ç”Ÿäº§ç¯å¢ƒå®‰è£…ï¼š**

```bash
# åªå®‰è£… dependencies
npm install --production
npm ci --production
pnpm install --prod
```

**Docker ç¤ºä¾‹ï¼š**

```dockerfile
# ç”Ÿäº§ç¯å¢ƒ
FROM node:18-alpine
COPY package.json package-lock.json ./
RUN npm ci --production  # ä¸å®‰è£… devDependencies
COPY . .
CMD ["node", "server.js"]
```

</details>

---

## ç¬¬ 3 é¢˜ ğŸŸ¢

**ç±»å‹ï¼š** å•é€‰é¢˜  
**æ ‡ç­¾ï¼š** Semver

### é¢˜ç›®

ç‰ˆæœ¬å· `2.1.0` ä¸­ï¼Œ`1` ä»£è¡¨ä»€ä¹ˆï¼Ÿ

**é€‰é¡¹ï¼š**
- A. MAJORï¼ˆä¸»ç‰ˆæœ¬å·ï¼‰
- B. MINORï¼ˆæ¬¡ç‰ˆæœ¬å·ï¼‰
- C. PATCHï¼ˆä¿®è®¢å·ï¼‰
- D. BUILDï¼ˆæ„å»ºå·ï¼‰

<details>
<summary>æŸ¥çœ‹ç­”æ¡ˆ</summary>

### âœ… æ­£ç¡®ç­”æ¡ˆï¼šB

### ğŸ“– è§£æ

**è¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼ˆSemverï¼‰**

ç‰ˆæœ¬å·æ ¼å¼ï¼š`MAJOR.MINOR.PATCH`

```
2.1.0
â”‚ â”‚ â””â”€ PATCH (ä¿®è®¢å·) = 0
â”‚ â””â”€â”€â”€ MINOR (æ¬¡ç‰ˆæœ¬å·) = 1  âœ…
â””â”€â”€â”€â”€â”€ MAJOR (ä¸»ç‰ˆæœ¬å·) = 2
```

**å„éƒ¨åˆ†å«ä¹‰ï¼š**

1. **MAJORï¼ˆä¸»ç‰ˆæœ¬å·ï¼‰**
   - ä¸å…¼å®¹çš„ API å˜æ›´
   - ä¾‹ï¼š1.x.x â†’ 2.0.0

2. **MINORï¼ˆæ¬¡ç‰ˆæœ¬å·ï¼‰**
   - å‘åå…¼å®¹çš„æ–°åŠŸèƒ½
   - ä¾‹ï¼š2.0.0 â†’ 2.1.0

3. **PATCHï¼ˆä¿®è®¢å·ï¼‰**
   - å‘åå…¼å®¹çš„ bug ä¿®å¤
   - ä¾‹ï¼š2.1.0 â†’ 2.1.1

**å®ä¾‹ï¼š**

```
React ç‰ˆæœ¬æ¼”è¿›ï¼š
16.13.1 â†’ 17.0.0  # MAJORï¼ˆæ–° JSX è½¬æ¢ï¼‰
17.0.0 â†’ 17.0.1  # PATCHï¼ˆbug ä¿®å¤ï¼‰
17.0.1 â†’ 17.1.0  # MINORï¼ˆæ–°ç‰¹æ€§ï¼‰
17.1.0 â†’ 18.0.0  # MAJORï¼ˆå¹¶å‘ç‰¹æ€§ï¼‰
```

</details>

---

## ç¬¬ 4 é¢˜ ğŸŸ¡

**ç±»å‹ï¼š** å¤šé€‰é¢˜  
**æ ‡ç­¾ï¼š** ä¾èµ–æ ‘

### é¢˜ç›®

ä¾èµ–æ ‘ï¼ˆDependency Treeï¼‰çš„ä½œç”¨åŒ…æ‹¬å“ªäº›ï¼Ÿ

**é€‰é¡¹ï¼š**
- A. å±•ç¤ºåŒ…ä¹‹é—´çš„ä¾èµ–å…³ç³»
- B. æ£€æµ‹å¾ªç¯ä¾èµ–
- C. è®¡ç®—å®‰è£…é¡ºåº
- D. è‡ªåŠ¨ä¿®å¤ä»£ç é”™è¯¯

<details>
<summary>æŸ¥çœ‹ç­”æ¡ˆ</summary>

### âœ… æ­£ç¡®ç­”æ¡ˆï¼šAã€Bã€C

### ğŸ“– è§£æ

**ä¾èµ–æ ‘çš„ä½œç”¨**

#### 1. å±•ç¤ºä¾èµ–å…³ç³»ï¼ˆé€‰é¡¹ A âœ…ï¼‰

```bash
npm ls

my-app@1.0.0
â”œâ”€â”€ express@4.18.0
â”‚   â”œâ”€â”€ body-parser@1.20.0
â”‚   â”‚   â””â”€â”€ bytes@3.1.2
â”‚   â””â”€â”€ cookie@0.5.0
â””â”€â”€ lodash@4.17.21
```

**å¯è§†åŒ–ä¾èµ–å…³ç³»**

#### 2. æ£€æµ‹å¾ªç¯ä¾èµ–ï¼ˆé€‰é¡¹ B âœ…ï¼‰

```
A ä¾èµ– B
B ä¾èµ– C
C ä¾èµ– A  â† å¾ªç¯ä¾èµ–
```

**npm ä¼šè­¦å‘Šæˆ–æ‹’ç»å®‰è£…**

#### 3. è®¡ç®—å®‰è£…é¡ºåºï¼ˆé€‰é¡¹ C âœ…ï¼‰

```bash
# æ‹“æ‰‘æ’åº
1. å…ˆå®‰è£… bytesï¼ˆæ— ä¾èµ–ï¼‰
2. å†å®‰è£… body-parserï¼ˆä¾èµ– bytesï¼‰
3. æœ€åå®‰è£… expressï¼ˆä¾èµ– body-parserï¼‰
```

#### 4. ä¸ä¼šè‡ªåŠ¨ä¿®å¤ä»£ç ï¼ˆé€‰é¡¹ D âŒï¼‰

ä¾èµ–æ ‘åªç®¡ç†åŒ…çš„å…³ç³»ï¼Œä¸æ¶‰åŠä»£ç é€»è¾‘ã€‚

**æŸ¥çœ‹ä¾èµ–æ ‘å‘½ä»¤ï¼š**

```bash
# npm
npm ls
npm ls lodash  # æŸ¥çœ‹ç‰¹å®šåŒ…

# yarn
yarn list
yarn why lodash

# pnpm
pnpm list
pnpm why lodash
```

**ä¾èµ–æ·±åº¦ï¼š**

```bash
# åªæ˜¾ç¤ºé¡¶å±‚
npm ls --depth=0

# æ˜¾ç¤º2å±‚
npm ls --depth=2
```

</details>

---

## ç¬¬ 5 é¢˜ ğŸŸ¡

**ç±»å‹ï¼š** ä»£ç åˆ†æé¢˜  
**æ ‡ç­¾ï¼š** ç‰ˆæœ¬èŒƒå›´

### é¢˜ç›®

ä»¥ä¸‹å“ªä¸ªç‰ˆæœ¬èŒƒå›´æœ€å®½æ¾ï¼ˆå…è®¸çš„ç‰ˆæœ¬æœ€å¤šï¼‰ï¼Ÿ

**é€‰é¡¹ï¼š**
- A. `~1.2.3`
- B. `^1.2.3`
- C. `1.2.x`
- D. `1.2.3`

<details>
<summary>æŸ¥çœ‹ç­”æ¡ˆ</summary>

### âœ… æ­£ç¡®ç­”æ¡ˆï¼šB

### ğŸ“– è§£æ

**ç‰ˆæœ¬èŒƒå›´å¯¹æ¯”**

#### A. `~1.2.3`ï¼ˆTildeï¼‰

```
å…è®¸ï¼š>=1.2.3 <1.3.0
```

**åŒ¹é…ï¼š**
- âœ… 1.2.3
- âœ… 1.2.4
- âœ… 1.2.99
- âŒ 1.3.0

**åªå…è®¸ PATCH æ›´æ–°**

#### B. `^1.2.3`ï¼ˆCaretï¼‰âœ… æœ€å®½æ¾

```
å…è®¸ï¼š>=1.2.3 <2.0.0
```

**åŒ¹é…ï¼š**
- âœ… 1.2.3
- âœ… 1.2.4
- âœ… 1.3.0
- âœ… 1.9.99
- âŒ 2.0.0

**å…è®¸ MINOR å’Œ PATCH æ›´æ–°**

#### C. `1.2.x`ï¼ˆé€šé…ç¬¦ï¼‰

```
å…è®¸ï¼š>=1.2.0 <1.3.0
```

**åŒ¹é…ï¼š**
- âœ… 1.2.0
- âœ… 1.2.3
- âœ… 1.2.99
- âŒ 1.3.0

**ç­‰åŒäº ~1.2.0**

#### D. `1.2.3`ï¼ˆç²¾ç¡®ç‰ˆæœ¬ï¼‰

```
åªå…è®¸ï¼š1.2.3
```

**æœ€ä¸¥æ ¼**

**å®½æ¾åº¦æ’åºï¼š**

```
æœ€å®½æ¾ â† â†’ æœ€ä¸¥æ ¼
^1.2.3 > ~1.2.3 = 1.2.x > 1.2.3
```

**å®é™…ä½¿ç”¨å»ºè®®ï¼š**

```json
{
  "dependencies": {
    "react": "^18.2.0",        // å¸¸è§„ä¾èµ–ï¼šä½¿ç”¨ ^
    "critical-lib": "1.2.3",   // å…³é”®ä¾èµ–ï¼šç²¾ç¡®ç‰ˆæœ¬
    "plugin": "~2.1.0"         // æ’ä»¶ï¼šä½¿ç”¨ ~
  }
}
```

</details>

---

## ç¬¬ 6 é¢˜ ğŸŸ¡

**ç±»å‹ï¼š** å•é€‰é¢˜  
**æ ‡ç­¾ï¼š** peerDependencies

### é¢˜ç›®

peerDependencies çš„ä¸»è¦ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿ

**é€‰é¡¹ï¼š**
- A. å£°æ˜æ’ä»¶éœ€è¦çš„å®¿ä¸»åŒ…ç‰ˆæœ¬
- B. å£°æ˜å¼€å‘æ—¶ä½¿ç”¨çš„å·¥å…·
- C. å£°æ˜å¯é€‰çš„ä¾èµ–
- D. å£°æ˜éœ€è¦å…¨å±€å®‰è£…çš„åŒ…

<details>
<summary>æŸ¥çœ‹ç­”æ¡ˆ</summary>

### âœ… æ­£ç¡®ç­”æ¡ˆï¼šA

### ğŸ“– è§£æ

**peerDependenciesï¼ˆå¯¹ç­‰ä¾èµ–ï¼‰**

#### ä½¿ç”¨åœºæ™¯ï¼šæ’ä»¶å’Œå®¿ä¸»

```json
// react-router package.json
{
  "name": "react-router",
  "peerDependencies": {
    "react": ">=16.8.0"  // è¦æ±‚å®¿ä¸»é¡¹ç›®å®‰è£… React
  }
}
```

**å«ä¹‰ï¼š**
- react-router æ˜¯ React çš„æ’ä»¶
- éœ€è¦ç”¨æˆ·é¡¹ç›®ä¸­å·²å®‰è£…å…¼å®¹ç‰ˆæœ¬çš„ React
- é¿å…é‡å¤å®‰è£… React

#### ç”¨æˆ·é¡¹ç›®

```json
// ç”¨æˆ·çš„ package.json
{
  "dependencies": {
    "react": "^18.2.0",      // æ»¡è¶³ >=16.8.0
    "react-router": "^6.0.0"
  }
}
```

**å¦‚æœä¸æ»¡è¶³ï¼š**

```bash
npm install
# WARN peerDependencies react@>=16.8.0 required by react-router
# but react@15.0.0 is installed
```

#### npm 7+ è‡ªåŠ¨å®‰è£…

```bash
npm install react-router
# è‡ªåŠ¨å®‰è£… peerDependenciesï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
```

**pnpm é…ç½®ï¼š**

```ini
# .npmrc
auto-install-peers=true  # è‡ªåŠ¨å®‰è£…
strict-peer-dependencies=false  # ä¸ä¸¥æ ¼æ£€æŸ¥
```

**å¸¸è§ peerDependenciesï¼š**

```json
{
  "peerDependencies": {
    // UI åº“
    "react": ">=16.8.0",
    
    // æ’ä»¶
    "webpack": "^5.0.0",
    "eslint": ">=7.0.0",
    
    // ç±»å‹å®šä¹‰
    "typescript": ">=4.0.0"
  }
}
```

</details>

---

## ç¬¬ 7 é¢˜ ğŸŸ¡

**ç±»å‹ï¼š** ä»£ç è¾“å‡ºé¢˜  
**æ ‡ç­¾ï¼š** æ¨¡å—å¯¼å…¥

### é¢˜ç›®

ä»¥ä¸‹ä»£ç çš„è¾“å‡ºæ˜¯ä»€ä¹ˆï¼Ÿ

```javascript
// math.js
let count = 0;
export const add = (a, b) => {
  count++;
  return a + b;
};
export { count };

// main.js
import { add, count } from './math.js';
console.log(count);  // ?
add(1, 2);
console.log(count);  // ?
```

**é€‰é¡¹ï¼š**
- A. 0, 0
- B. 0, 1
- C. 1, 2
- D. undefined, undefined

<details>
<summary>æŸ¥çœ‹ç­”æ¡ˆ</summary>

### âœ… æ­£ç¡®ç­”æ¡ˆï¼šB

### ğŸ“– è§£æ

**ES Modules çš„å€¼å¼•ç”¨**

#### æ‰§è¡Œæµç¨‹

```javascript
// 1. å¯¼å…¥æ—¶
import { add, count } from './math.js';
console.log(count);  // 0ï¼ˆåˆå§‹å€¼ï¼‰

// 2. è°ƒç”¨å‡½æ•°
add(1, 2);  // count++ æ‰§è¡Œï¼Œcount å˜ä¸º 1

// 3. å†æ¬¡è®¿é—®
console.log(count);  // 1ï¼ˆæ›´æ–°åçš„å€¼ï¼‰
```

**è¾“å‡ºï¼š0, 1**

#### å…³é”®æ¦‚å¿µï¼šå€¼å¼•ç”¨

**ES Modulesï¼š**
- å¯¼å…¥çš„æ˜¯**å€¼çš„å¼•ç”¨**
- æ¨¡å—å†…éƒ¨ä¿®æ”¹ä¼šåæ˜ åˆ°å¯¼å…¥å¤„
- åŠ¨æ€ç»‘å®š

**å¯¹æ¯” CommonJSï¼ˆå€¼æ‹·è´ï¼‰ï¼š**

```javascript
// math.js
let count = 0;
const add = (a, b) => {
  count++;
  return a + b;
};
module.exports = { add, count };

// main.js
const { add, count } = require('./math');
console.log(count);  // 0
add(1, 2);
console.log(count);  // 0ï¼ˆä»æ˜¯åˆå§‹å€¼çš„æ‹·è´ï¼‰

// å¦‚æœè¦è·å–æœ€æ–°å€¼
const math = require('./math');
console.log(math.count);  // éœ€è¦è®¿é—®å¯¹è±¡å±æ€§
```

**å¯¹æ¯”æ€»ç»“ï¼š**

| ç‰¹æ€§ | CommonJS | ES Modules |
|------|----------|------------|
| å¯¼å‡ºæ–¹å¼ | å€¼æ‹·è´ | å€¼å¼•ç”¨ |
| æ›´æ–° | ä¸åŒæ­¥ | åŒæ­¥ |
| åŠ¨æ€æ€§ | é™æ€ | åŠ¨æ€ |

</details>

---

## ç¬¬ 8 é¢˜ ğŸ”´

**ç±»å‹ï¼š** ç»¼åˆåˆ†æé¢˜  
**æ ‡ç­¾ï¼š** ä¾èµ–è§£æ

### é¢˜ç›®

ä»¥ä¸‹ package.json ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Ÿ

```json
{
  "dependencies": {
    "pkg-a": "^1.0.0",
    "pkg-b": "^2.0.0"
  }
}
```

å…¶ä¸­ï¼š
- pkg-a ä¾èµ– lodash@^4.17.0
- pkg-b ä¾èµ– lodash@^3.10.0

**é€‰é¡¹ï¼š**
- A. æ— æ³•å®‰è£…ï¼Œç‰ˆæœ¬å†²çª
- B. åªå®‰è£… lodash@4.17.21
- C. å®‰è£…ä¸¤ä¸ªç‰ˆæœ¬çš„ lodash
- D. éšæœºé€‰æ‹©ä¸€ä¸ªç‰ˆæœ¬

<details>
<summary>æŸ¥çœ‹ç­”æ¡ˆ</summary>

### âœ… æ­£ç¡®ç­”æ¡ˆï¼šC

### ğŸ“– è§£æ

**ä¾èµ–å†²çªå¤„ç†**

#### npm/Yarn çš„æ‰å¹³åŒ–ç­–ç•¥

```
node_modules/
â”œâ”€â”€ pkg-a/
â”œâ”€â”€ pkg-b/
â”‚   â””â”€â”€ node_modules/
â”‚       â””â”€â”€ lodash@3.10.1  # åµŒå¥—å®‰è£…
â”œâ”€â”€ lodash@4.17.21  # æå‡åˆ°é¡¶å±‚
```

**å®‰è£…ä¸¤ä¸ªç‰ˆæœ¬ï¼š**
1. lodash@4.17.21ï¼ˆé¡¶å±‚ï¼Œå…ˆå®‰è£…ï¼‰
2. lodash@3.10.1ï¼ˆpkg-b åµŒå¥—ï¼‰

#### ä¸ºä»€ä¹ˆä¸å†²çªï¼Ÿ

**æ‰å¹³åŒ–è§„åˆ™ï¼š**
- å…ˆå®‰è£…çš„åŒ…æå‡åˆ°é¡¶å±‚
- ä¸å…¼å®¹çš„ç‰ˆæœ¬åµŒå¥—å®‰è£…
- æ¯ä¸ªåŒ…éƒ½èƒ½è®¿é—®åˆ°æ­£ç¡®çš„ç‰ˆæœ¬

#### pnpm çš„å¤„ç†

```
node_modules/
â”œâ”€â”€ .pnpm/
â”‚   â”œâ”€â”€ lodash@4.17.21/
â”‚   â””â”€â”€ lodash@3.10.1/
â”œâ”€â”€ pkg-a -> .pnpm/pkg-a/.../pkg-a
â””â”€â”€ pkg-b -> .pnpm/pkg-b/.../pkg-b
```

**ä¸¥æ ¼éš”ç¦»ï¼š**
- æ¯ä¸ªåŒ…åªèƒ½è®¿é—®è‡ªå·±çš„ä¾èµ–
- ä¸ä¼šäº§ç”Ÿå¹½çµä¾èµ–

#### ä¼˜åŒ–æ–¹æ¡ˆ

**1. ç»Ÿä¸€ç‰ˆæœ¬ï¼ˆæ¨èï¼‰**

```json
{
  "dependencies": {
    "pkg-a": "^1.0.0",
    "pkg-b": "^2.0.0"
  },
  "overrides": {
    "lodash": "^4.17.21"  // å¼ºåˆ¶ä½¿ç”¨åŒä¸€ç‰ˆæœ¬
  }
}
```

**2. ä½¿ç”¨ resolutions (Yarn)**

```json
{
  "resolutions": {
    "lodash": "4.17.21"
  }
}
```

**3. æ£€æŸ¥é‡å¤ä¾èµ–**

```bash
npm ls lodash
# æŸ¥çœ‹å®‰è£…äº†å“ªäº›ç‰ˆæœ¬

npm dedupe
# å»é‡ï¼ˆå¦‚æœç‰ˆæœ¬å…¼å®¹ï¼‰
```

</details>

---

## ç¬¬ 9 é¢˜ ğŸ”´

**ç±»å‹ï¼š** åœºæ™¯é¢˜  
**æ ‡ç­¾ï¼š** æ¨¡å—å¾ªç¯ä¾èµ–

### é¢˜ç›®

ä»¥ä¸‹ä»£ç ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

```javascript
// a.js
import { b } from './b.js';
export const a = 'A';
console.log('a.js:', b);

// b.js
import { a } from './a.js';
export const b = 'B';
console.log('b.js:', a);

// main.js
import { a } from './a.js';
```

**é€‰é¡¹ï¼š**
- A. æŠ¥é”™ï¼šå¾ªç¯ä¾èµ–
- B. a.js: B, b.js: undefined
- C. a.js: undefined, b.js: A
- D. æ­£å¸¸è¾“å‡º a.js: B, b.js: A

<details>
<summary>æŸ¥çœ‹ç­”æ¡ˆ</summary>

### âœ… æ­£ç¡®ç­”æ¡ˆï¼šB

### ğŸ“– è§£æ

**ES Modules å¾ªç¯ä¾èµ–å¤„ç†**

#### æ‰§è¡Œé¡ºåº

```
1. main.js å¯¼å…¥ a.js
2. a.js å¯¼å…¥ b.jsï¼ˆæš‚åœ a.js æ‰§è¡Œï¼‰
3. b.js å¯¼å…¥ a.js
   - a.js å·²åœ¨åŠ è½½ä¸­ï¼Œè¿”å›å½“å‰å¯¼å‡ºï¼ˆç©ºï¼‰
   - a æ­¤æ—¶æ˜¯ undefined
4. b.js ç»§ç»­æ‰§è¡Œ
   - export const b = 'B'
   - console.log('b.js:', undefined)  â† a è¿˜æœªèµ‹å€¼
5. b.js å®Œæˆï¼Œè¿”å› a.js
6. a.js ç»§ç»­æ‰§è¡Œ
   - export const a = 'A'
   - console.log('a.js:', 'B')  â† b å·²å®Œæˆ
7. a.js å®Œæˆ
```

**è¾“å‡ºï¼š**
```
b.js: undefined
a.js: B
```

#### ä¸ºä»€ä¹ˆä¸æŠ¥é”™ï¼Ÿ

**ES Modulesï¼š**
- å…è®¸å¾ªç¯ä¾èµ–
- ä½¿ç”¨"æš‚æ—¶æ€§æ­»åŒº"ï¼ˆTDZï¼‰
- è¿”å›éƒ¨åˆ†åˆå§‹åŒ–çš„æ¨¡å—

**CommonJS å¯¹æ¯”ï¼š**

```javascript
// a.js
const { b } = require('./b');
exports.a = 'A';
console.log('a.js:', b);

// b.js
const { a } = require('./a');
exports.b = 'B';
console.log('b.js:', a);

// è¾“å‡ºï¼š
// b.js: undefined  # exports.a è¿˜æœªæ‰§è¡Œ
// a.js: B
```

#### æœ€ä½³å®è·µ

**é¿å…å¾ªç¯ä¾èµ–ï¼š**

```javascript
// æ–¹æ¡ˆ1ï¼šæå–å…¬å…±æ¨¡å—
// common.js
export const shared = {};

// a.js
import { shared } from './common.js';

// b.js
import { shared } from './common.js';

// æ–¹æ¡ˆ2ï¼šå»¶è¿Ÿå¯¼å…¥
// b.js
export const getA = () => {
  const { a } = require('./a');  // è¿è¡Œæ—¶å¯¼å…¥
  return a;
};
```

**æ£€æµ‹å¾ªç¯ä¾èµ–ï¼š**

```bash
# ä½¿ç”¨å·¥å…·
npm install -g madge

madge --circular src/
# è¾“å‡ºå¾ªç¯ä¾èµ–åˆ—è¡¨
```

</details>

---

## ç¬¬ 10 é¢˜ ğŸ”´

**ç±»å‹ï¼š** ä»£ç å®ç°é¢˜  
**æ ‡ç­¾ï¼š** ä¾èµ–æ³¨å…¥

### é¢˜ç›®

å¦‚ä½•åœ¨ package.json ä¸­å£°æ˜ä¸€ä¸ªåŒ…æ—¢æ˜¯ç”Ÿäº§ä¾èµ–åˆæ˜¯å¼€å‘ä¾èµ–ï¼Ÿ

**é€‰é¡¹ï¼š**
- A. åŒæ—¶åœ¨ dependencies å’Œ devDependencies ä¸­å£°æ˜
- B. ä½¿ç”¨ optionalDependencies
- C. åªåœ¨ dependencies ä¸­å£°æ˜ï¼ˆå¼€å‘æ—¶ä¹Ÿä¼šå®‰è£…ï¼‰
- D. ä½¿ç”¨ bundledDependencies

<details>
<summary>æŸ¥çœ‹ç­”æ¡ˆ</summary>

### âœ… æ­£ç¡®ç­”æ¡ˆï¼šC

### ğŸ“– è§£æ

**ä¾èµ–åˆ†ç±»åŸåˆ™**

#### æ­£ç¡®åšæ³•ï¼šåªåœ¨ dependencies å£°æ˜ âœ…

```json
{
  "dependencies": {
    "typescript": "^5.0.0"  // ç”Ÿäº§å’Œå¼€å‘éƒ½éœ€è¦
  }
}
```

**åŸå› ï¼š**
- `npm install` ä¼šå®‰è£… dependenciesï¼ˆå¼€å‘ç¯å¢ƒï¼‰
- `npm install --production` ä¹Ÿä¼šå®‰è£… dependenciesï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- æ»¡è¶³ä¸¤ä¸ªç¯å¢ƒçš„éœ€æ±‚

#### é”™è¯¯åšæ³•ï¼šé‡å¤å£°æ˜ âŒ

```json
{
  "dependencies": {
    "typescript": "^5.0.0"
  },
  "devDependencies": {
    "typescript": "^5.0.0"  // âŒ é‡å¤ï¼Œä¼šè­¦å‘Š
  }
}
```

**npm è­¦å‘Šï¼š**
```
npm WARN package.json typescript is also in devDependencies
```

#### ä¾èµ–åˆ†ç±»æŒ‡å—

**1. dependenciesï¼ˆç”Ÿäº§ä¾èµ–ï¼‰**
```json
{
  "dependencies": {
    "express": "^4.18.0",     // è¿è¡Œæ—¶éœ€è¦
    "lodash": "^4.17.21",     // ä»£ç ä¸­ä½¿ç”¨
    "react": "^18.2.0"        // æ¡†æ¶
  }
}
```

**ä½¿ç”¨åœºæ™¯ï¼š**
- è¿è¡Œæ—¶å¿…éœ€çš„åŒ…
- ç”Ÿäº§ç¯å¢ƒéœ€è¦

**2. devDependenciesï¼ˆå¼€å‘ä¾èµ–ï¼‰**
```json
{
  "devDependencies": {
    "eslint": "^8.0.0",       // ä»£ç æ£€æŸ¥
    "jest": "^29.0.0",        // æµ‹è¯•å·¥å…·
    "webpack": "^5.0.0"       // æ„å»ºå·¥å…·
  }
}
```

**ä½¿ç”¨åœºæ™¯ï¼š**
- å¼€å‘/æµ‹è¯•å·¥å…·
- æ„å»ºå·¥å…·
- ä»£ç è§„èŒƒå·¥å…·

**3. optionalDependenciesï¼ˆå¯é€‰ä¾èµ–ï¼‰**
```json
{
  "optionalDependencies": {
    "fsevents": "^2.3.0"  // macOS ç‰¹å®šï¼Œå®‰è£…å¤±è´¥ä¸å½±å“
  }
}
```

**ä½¿ç”¨åœºæ™¯ï¼š**
- å¹³å°ç‰¹å®šçš„åŒ…
- å¢å¼ºåŠŸèƒ½ä½†éå¿…éœ€

**4. peerDependenciesï¼ˆå¯¹ç­‰ä¾èµ–ï¼‰**
```json
{
  "peerDependencies": {
    "react": ">=16.8.0"  // æ’ä»¶è¦æ±‚å®¿ä¸»æä¾›
  }
}
```

**5. bundledDependenciesï¼ˆæ‰“åŒ…ä¾èµ–ï¼‰**
```json
{
  "bundledDependencies": ["pkg1", "pkg2"]
}
```

**ä½¿ç”¨åœºæ™¯ï¼š**
- å‘å¸ƒæ—¶æ‰“åŒ…è¿› tarball
- ç¦»çº¿å®‰è£…

#### ç‰¹æ®Šåœºæ™¯ï¼šTypeScript

```json
{
  "dependencies": {
    "typescript": "^5.0.0"  // âœ… å¦‚æœè¿è¡Œæ—¶éœ€è¦ï¼ˆtscï¼‰
  }
}

// æˆ–

{
  "devDependencies": {
    "typescript": "^5.0.0"  // âœ… å¦‚æœåªç”¨äºå¼€å‘æ„å»º
  }
}
```

**åˆ¤æ–­ä¾æ®ï¼š**
- ç”Ÿäº§ç¯å¢ƒè¿è¡Œ `tsc`ï¼Ÿâ†’ dependencies
- åªåœ¨å¼€å‘æ—¶ç¼–è¯‘ï¼Ÿâ†’ devDependencies

</details>

---

**å¯¼èˆª**  
[ä¸Šä¸€ç« ï¼šç¬¬ 1 ç« é¢è¯•é¢˜](./chapter-01.md) | [è¿”å›ç›®å½•](../README.md) | [ä¸‹ä¸€ç« ï¼šç¬¬ 3 ç« é¢è¯•é¢˜](./chapter-03.md)
