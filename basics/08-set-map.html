<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Set ä¸ Map - JavaScript æ·±åº¦å­¦ä¹ </title>
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="../assets/css/page.css">
</head>
<body>
    <div class="page-layout">
        <div class="doc-panel">
            <h1>Set ä¸ Map</h1>
            
            <h2>æ¦‚è¿°</h2>
            <p>Set å’Œ Map æ˜¯ ES6 å¼•å…¥çš„ä¸¤ç§æ–°çš„æ•°æ®ç»“æ„ã€‚Set ç”¨äºå­˜å‚¨å”¯ä¸€å€¼çš„é›†åˆï¼ŒMap ç”¨äºå­˜å‚¨é”®å€¼å¯¹ã€‚</p>
            
            <h2>ä¸€ã€Set</h2>
            
            <h3>1.1 åˆ›å»º Set</h3>
            <pre><code>// ç©º Set
const set1 = new Set();

// ä»æ•°ç»„åˆ›å»º
const set2 = new Set([1, 2, 3, 4, 5]);

// ä»å­—ç¬¦ä¸²åˆ›å»º
const set3 = new Set('hello'); // {'h', 'e', 'l', 'o'}</code></pre>
            
            <h3>1.2 Set ç‰¹æ€§</h3>
            <div class="info">
                <ul>
                    <li>æˆå‘˜å€¼å”¯ä¸€ï¼ˆè‡ªåŠ¨å»é‡ï¼‰</li>
                    <li>å¯ä»¥å­˜å‚¨ä»»ä½•ç±»å‹çš„å€¼</li>
                    <li>ä½¿ç”¨ SameValueZero ç®—æ³•åˆ¤æ–­ç›¸ç­‰ï¼ˆNaN ç­‰äº NaNï¼‰</li>
                    <li>ä¿æŒæ’å…¥é¡ºåº</li>
                </ul>
            </div>
            
            <h3>1.3 Set æ–¹æ³•</h3>
            <table>
                <thead>
                    <tr>
                        <th>æ–¹æ³•</th>
                        <th>è¯´æ˜</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>add(value)</code></td>
                        <td>æ·»åŠ å€¼</td>
                    </tr>
                    <tr>
                        <td><code>delete(value)</code></td>
                        <td>åˆ é™¤å€¼</td>
                    </tr>
                    <tr>
                        <td><code>has(value)</code></td>
                        <td>æ£€æŸ¥æ˜¯å¦å­˜åœ¨</td>
                    </tr>
                    <tr>
                        <td><code>clear()</code></td>
                        <td>æ¸…ç©ºæ‰€æœ‰å€¼</td>
                    </tr>
                    <tr>
                        <td><code>size</code></td>
                        <td>è·å–æˆå‘˜æ•°é‡ï¼ˆå±æ€§ï¼‰</td>
                    </tr>
                </tbody>
            </table>
            
            <h3>1.4 Set éå†</h3>
            <pre><code>const set = new Set([1, 2, 3, 4, 5]);

// forEach
set.forEach((value, key, set) => {
    console.log(value); // key å’Œ value ç›¸åŒ
});

// for...of
for (const value of set) {
    console.log(value);
}

// keys() / values() / entries()
for (const value of set.values()) {
    console.log(value);
}

for (const [key, value] of set.entries()) {
    console.log(key, value); // key å’Œ value ç›¸åŒ
}</code></pre>
            
            <h3>1.5 Set åº”ç”¨</h3>
            <pre><code>// æ•°ç»„å»é‡
const arr = [1, 2, 2, 3, 3, 4];
const unique = [...new Set(arr)];

// å¹¶é›†
const union = new Set([...set1, ...set2]);

// äº¤é›†
const intersection = new Set(
    [...set1].filter(x => set2.has(x))
);

// å·®é›†
const difference = new Set(
    [...set1].filter(x => !set2.has(x))
);</code></pre>
            
            <h2>äºŒã€WeakSet</h2>
            
            <h3>2.1 WeakSet ç‰¹æ€§</h3>
            <div class="info">
                <ul>
                    <li>åªèƒ½å­˜å‚¨å¯¹è±¡</li>
                    <li>å¼±å¼•ç”¨ï¼Œä¸å½±å“åƒåœ¾å›æ”¶</li>
                    <li>ä¸å¯éå†</li>
                    <li>æ²¡æœ‰ size å±æ€§</li>
                </ul>
            </div>
            
            <h3>2.2 WeakSet æ–¹æ³•</h3>
            <pre><code>const ws = new WeakSet();
const obj = { name: 'Alice' };

ws.add(obj);
ws.has(obj);    // true
ws.delete(obj);
// æ²¡æœ‰ sizeã€clearã€éå†æ–¹æ³•</code></pre>
            
            <h2>ä¸‰ã€Map</h2>
            
            <h3>3.1 åˆ›å»º Map</h3>
            <pre><code>// ç©º Map
const map1 = new Map();

// ä»æ•°ç»„åˆ›å»º
const map2 = new Map([
    ['name', 'Alice'],
    ['age', 25]
]);

// ä»å¯¹è±¡åˆ›å»º
const obj = { name: 'Bob', age: 30 };
const map3 = new Map(Object.entries(obj));</code></pre>
            
            <h3>3.2 Map vs Object</h3>
            <table>
                <thead>
                    <tr>
                        <th>ç‰¹æ€§</th>
                        <th>Map</th>
                        <th>Object</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>é”®çš„ç±»å‹</td>
                        <td>ä»»ä½•å€¼</td>
                        <td>å­—ç¬¦ä¸²/Symbol</td>
                    </tr>
                    <tr>
                        <td>é”®çš„é¡ºåº</td>
                        <td>æ’å…¥é¡ºåº</td>
                        <td>æ— ä¿è¯</td>
                    </tr>
                    <tr>
                        <td>size</td>
                        <td>æœ‰</td>
                        <td>æ‰‹åŠ¨è®¡ç®—</td>
                    </tr>
                    <tr>
                        <td>æ€§èƒ½</td>
                        <td>é¢‘ç¹å¢åˆ æ›´å¿«</td>
                        <td>é™æ€é”®æ›´å¿«</td>
                    </tr>
                    <tr>
                        <td>å¯è¿­ä»£</td>
                        <td>ç›´æ¥å¯è¿­ä»£</td>
                        <td>éœ€è½¬æ¢</td>
                    </tr>
                </tbody>
            </table>
            
            <h3>3.3 Map æ–¹æ³•</h3>
            <table>
                <thead>
                    <tr>
                        <th>æ–¹æ³•</th>
                        <th>è¯´æ˜</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>set(key, value)</code></td>
                        <td>è®¾ç½®é”®å€¼å¯¹</td>
                    </tr>
                    <tr>
                        <td><code>get(key)</code></td>
                        <td>è·å–å€¼</td>
                    </tr>
                    <tr>
                        <td><code>has(key)</code></td>
                        <td>æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨</td>
                    </tr>
                    <tr>
                        <td><code>delete(key)</code></td>
                        <td>åˆ é™¤é”®å€¼å¯¹</td>
                    </tr>
                    <tr>
                        <td><code>clear()</code></td>
                        <td>æ¸…ç©ºæ‰€æœ‰é”®å€¼å¯¹</td>
                    </tr>
                    <tr>
                        <td><code>size</code></td>
                        <td>è·å–é”®å€¼å¯¹æ•°é‡ï¼ˆå±æ€§ï¼‰</td>
                    </tr>
                </tbody>
            </table>
            
            <h3>3.4 Map éå†</h3>
            <pre><code>const map = new Map([
    ['name', 'Alice'],
    ['age', 25],
    ['city', 'Beijing']
]);

// forEach
map.forEach((value, key, map) => {
    console.log(key, value);
});

// for...of
for (const [key, value] of map) {
    console.log(key, value);
}

// keys() / values() / entries()
for (const key of map.keys()) {
    console.log(key);
}

for (const value of map.values()) {
    console.log(value);
}

for (const [key, value] of map.entries()) {
    console.log(key, value);
}</code></pre>
            
            <h3>3.5 Map åº”ç”¨</h3>
            <pre><code>// å¯¹è±¡ä½œä¸ºé”®
const keyObj = { id: 1 };
const map = new Map();
map.set(keyObj, 'value');

// å‡½æ•°ä½œä¸ºé”®
const keyFunc = () => {};
map.set(keyFunc, 'function value');

// è®¡æ•°å™¨
const counter = new Map();
const word = 'hello';
for (const char of word) {
    counter.set(char, (counter.get(char) || 0) + 1);
}</code></pre>
            
            <h2>å››ã€WeakMap</h2>
            
            <h3>4.1 WeakMap ç‰¹æ€§</h3>
            <div class="info">
                <ul>
                    <li>é”®å¿…é¡»æ˜¯å¯¹è±¡</li>
                    <li>é”®æ˜¯å¼±å¼•ç”¨</li>
                    <li>ä¸å¯éå†</li>
                    <li>æ²¡æœ‰ size å±æ€§</li>
                </ul>
            </div>
            
            <h3>4.2 WeakMap æ–¹æ³•</h3>
            <pre><code>const wm = new WeakMap();
const key = { id: 1 };

wm.set(key, 'value');
wm.get(key);     // 'value'
wm.has(key);     // true
wm.delete(key);
// æ²¡æœ‰ sizeã€clearã€éå†æ–¹æ³•</code></pre>
            
            <h3>4.3 WeakMap åº”ç”¨</h3>
            <pre><code>// DOM èŠ‚ç‚¹å…³è”æ•°æ®
const domData = new WeakMap();
const element = document.getElementById('app');
domData.set(element, { clicks: 0 });

// ç§æœ‰æ•°æ®
const privateData = new WeakMap();
class Person {
    constructor(name) {
        privateData.set(this, { name });
    }
    getName() {
        return privateData.get(this).name;
    }
}</code></pre>
            
            <h2>äº”ã€æ€§èƒ½æ¯”è¾ƒ</h2>
            
            <div class="tip">
                <strong>ä½¿ç”¨å»ºè®®ï¼š</strong>
                <ul>
                    <li><strong>Set</strong>ï¼šéœ€è¦å”¯ä¸€å€¼é›†åˆæ—¶</li>
                    <li><strong>Map</strong>ï¼šéœ€è¦é”®å€¼å¯¹ä¸”é”®å¯ä»¥æ˜¯ä»»ä½•ç±»å‹æ—¶</li>
                    <li><strong>WeakSet/WeakMap</strong>ï¼šéœ€è¦å¼±å¼•ç”¨é¿å…å†…å­˜æ³„æ¼æ—¶</li>
                    <li><strong>Object</strong>ï¼šç®€å•çš„å­—ç¬¦ä¸²é”®å€¼å¯¹</li>
                    <li><strong>Array</strong>ï¼šéœ€è¦ç´¢å¼•è®¿é—®å’Œæ•°ç»„æ–¹æ³•æ—¶</li>
                </ul>
            </div>
            
            <h2>å…­ã€æœ€ä½³å®è·µ</h2>
            
            <div class="tip">
                <ol>
                    <li><strong>æ•°ç»„å»é‡</strong>ï¼šä½¿ç”¨ Set</li>
                    <li><strong>ç¼“å­˜</strong>ï¼šä½¿ç”¨ Mapï¼ˆé”®å¯ä»¥æ˜¯å¯¹è±¡ï¼‰</li>
                    <li><strong>DOM å…³è”æ•°æ®</strong>ï¼šä½¿ç”¨ WeakMap</li>
                    <li><strong>é›†åˆè¿ç®—</strong>ï¼šä½¿ç”¨ Setï¼ˆå¹¶é›†ã€äº¤é›†ã€å·®é›†ï¼‰</li>
                    <li><strong>è®¡æ•°å™¨</strong>ï¼šä½¿ç”¨ Map</li>
                </ol>
            </div>
            
            <h2>å‚è€ƒèµ„æ–™</h2>
            <ul>
                <li><a href="https://tc39.es/ecma262/#sec-set-objects" target="_blank">ECMAScript - Set Objects</a></li>
                <li><a href="https://tc39.es/ecma262/#sec-map-objects" target="_blank">ECMAScript - Map Objects</a></li>
                <li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Set" target="_blank">MDN - Set</a></li>
                <li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Map" target="_blank">MDN - Map</a></li>
            </ul>
            
            <div class="nav-links">
                <a href="08-math-date.html" class="nav-link prev">ä¸Šä¸€èŠ‚ï¼šMath ä¸ Date</a>
                <a href="../index.html" class="nav-link home">è¿”å›é¦–é¡µ</a>
                <a href="08-symbol-bigint.html" class="nav-link next">ä¸‹ä¸€èŠ‚ï¼šSymbol ä¸ BigInt</a>
            </div>
        </div>
        
        <div class="code-panel">
            <h2 style="color: #60a5fa; margin-bottom: 1.5rem;">ğŸ’» äº¤äº’å¼ä»£ç ç¤ºä¾‹</h2>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 1ï¼šSet åŸºç¡€æ“ä½œ</h3>
                <div class="code-block">
                    <pre><code>// åˆ›å»º Set
const set = new Set([1, 2, 3, 4, 5]);
console.log('set:', set);
console.log('size:', set.size);

// add
set.add(6);
set.add(3); // é‡å¤å€¼ä¸ä¼šæ·»åŠ 
console.log('\naddå:', set);

// has
console.log('\nhas(3):', set.has(3));
console.log('has(10):', set.has(10));

// delete
set.delete(3);
console.log('\ndelete(3)å:', set);

// æ•°ç»„å»é‡
const arr = [1, 2, 2, 3, 3, 4, 5, 5];
const unique = [...new Set(arr)];
console.log('\næ•°ç»„å»é‡:', unique);</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 2ï¼šSet éå†</h3>
                <div class="code-block">
                    <pre><code>const set = new Set(['a', 'b', 'c']);

// forEach
console.log('forEach:');
set.forEach(value => console.log('  ', value));

// for...of
console.log('\nfor...of:');
for (const value of set) {
    console.log('  ', value);
}

// values()
console.log('\nvalues():');
for (const value of set.values()) {
    console.log('  ', value);
}

// entries()
console.log('\nentries():');
for (const [key, value] of set.entries()) {
    console.log('  ', key, '===', value);
}</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 3ï¼šSet é›†åˆè¿ç®—</h3>
                <div class="code-block">
                    <pre><code>const set1 = new Set([1, 2, 3, 4]);
const set2 = new Set([3, 4, 5, 6]);

// å¹¶é›†
const union = new Set([...set1, ...set2]);
console.log('å¹¶é›†:', [...union]);

// äº¤é›†
const intersection = new Set(
    [...set1].filter(x => set2.has(x))
);
console.log('äº¤é›†:', [...intersection]);

// å·®é›†
const difference = new Set(
    [...set1].filter(x => !set2.has(x))
);
console.log('å·®é›† (set1 - set2):', [...difference]);

// å¯¹ç§°å·®é›†
const symDiff = new Set([
    ...[...set1].filter(x => !set2.has(x)),
    ...[...set2].filter(x => !set1.has(x))
]);
console.log('å¯¹ç§°å·®é›†:', [...symDiff]);</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 4ï¼šMap åŸºç¡€æ“ä½œ</h3>
                <div class="code-block">
                    <pre><code>// åˆ›å»º Map
const map = new Map([
    ['name', 'Alice'],
    ['age', 25],
    ['city', 'Beijing']
]);

console.log('map:', map);
console.log('size:', map.size);

// get
console.log('\nget("name"):', map.get('name'));
console.log('get("age"):', map.get('age'));

// set
map.set('email', 'alice@example.com');
console.log('\nsetå size:', map.size);

// has
console.log('\nhas("name"):', map.has('name'));
console.log('has("phone"):', map.has('phone'));

// delete
map.delete('city');
console.log('\ndelete("city")å size:', map.size);

// é“¾å¼è°ƒç”¨
const map2 = new Map();
map2.set('a', 1).set('b', 2).set('c', 3);
console.log('\né“¾å¼è°ƒç”¨:', map2);</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 5ï¼šMap éå†</h3>
                <div class="code-block">
                    <pre><code>const map = new Map([
    ['name', 'Alice'],
    ['age', 25],
    ['city', 'Beijing']
]);

// forEach
console.log('forEach:');
map.forEach((value, key) => {
    console.log(`  ${key}: ${value}`);
});

// for...of
console.log('\nfor...of:');
for (const [key, value] of map) {
    console.log(`  ${key}: ${value}`);
}

// keys()
console.log('\nkeys():');
for (const key of map.keys()) {
    console.log('  ', key);
}

// values()
console.log('\nvalues():');
for (const value of map.values()) {
    console.log('  ', value);
}</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 6ï¼šMap å®ç”¨æŠ€å·§</h3>
                <div class="code-block">
                    <pre><code>// å¯¹è±¡ä½œä¸ºé”®
const map = new Map();
const key1 = { id: 1 };
const key2 = { id: 2 };

map.set(key1, 'value1');
map.set(key2, 'value2');
console.log('å¯¹è±¡ä½œä¸ºé”®:');
console.log('  get(key1):', map.get(key1));
console.log('  get(key2):', map.get(key2));

// å­—ç¬¦ç»Ÿè®¡
function countChars(str) {
    const map = new Map();
    for (const char of str) {
        map.set(char, (map.get(char) || 0) + 1);
    }
    return map;
}

const result = countChars('hello world');
console.log('\nå­—ç¬¦ç»Ÿè®¡:');
for (const [char, count] of result) {
    console.log(`  "${char}": ${count}`);
}

// Map è½¬å¯¹è±¡
const mapToObj = (map) => Object.fromEntries(map);
console.log('\nMapè½¬å¯¹è±¡:', mapToObj(new Map([['a', 1], ['b', 2]])));

// å¯¹è±¡è½¬ Map
const obj = { x: 10, y: 20 };
const objToMap = new Map(Object.entries(obj));
console.log('å¯¹è±¡è½¬Map:', objToMap);</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
        </div>
    </div>
    
    <script src="../assets/js/common.js"></script>
</body>
</html>
