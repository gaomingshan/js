<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç±»å‹è½¬æ¢ä¸åˆ¤æ–­ - JavaScript æ·±åº¦å­¦ä¹ </title>
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="../assets/css/page.css">
</head>
<body>
    <div class="page-layout">
        <div class="doc-panel">
            <h1>ç±»å‹è½¬æ¢ä¸åˆ¤æ–­</h1>
            
            <h2>æ¦‚è¿°</h2>
            <p>JavaScript æ˜¯åŠ¨æ€ç±»å‹è¯­è¨€ï¼Œä¼šåœ¨éœ€è¦æ—¶è‡ªåŠ¨è¿›è¡Œç±»å‹è½¬æ¢ï¼ˆéšå¼è½¬æ¢ï¼‰ã€‚ç†è§£ç±»å‹è½¬æ¢è§„åˆ™å¯¹äºé¿å… bug è‡³å…³é‡è¦ã€‚</p>
            <p>æœ¬ç« å°†æ·±å…¥åˆ° ECMAScript è§„èŒƒå±‚é¢ï¼Œè®²è§£ JavaScript è§£é‡Šå™¨å¦‚ä½•æ‰§è¡Œç±»å‹è½¬æ¢çš„åº•å±‚åŸç†ã€‚</p>
            
            <h2>ä¸€ã€ç±»å‹è½¬æ¢åˆ†ç±»</h2>
            
            <h3>1.1 æ˜¾å¼è½¬æ¢ï¼ˆExplicit Conversionï¼‰</h3>
            <p>ç¨‹åºå‘˜ä¸»åŠ¨è°ƒç”¨è½¬æ¢å‡½æ•°ï¼š</p>
            <ul>
                <li><code>Number()</code> - è½¬æ¢ä¸ºæ•°å­—</li>
                <li><code>String()</code> - è½¬æ¢ä¸ºå­—ç¬¦ä¸²</li>
                <li><code>Boolean()</code> - è½¬æ¢ä¸ºå¸ƒå°”å€¼</li>
            </ul>
            
            <h3>1.2 éšå¼è½¬æ¢ï¼ˆImplicit Conversionï¼‰</h3>
            <p>JavaScript è‡ªåŠ¨è¿›è¡Œçš„ç±»å‹è½¬æ¢ï¼Œä¹Ÿç§°ä¸º"ç±»å‹å¼ºåˆ¶"ï¼ˆType Coercionï¼‰ã€‚</p>
            
            <h2>äºŒã€è½¬æ¢ä¸ºå­—ç¬¦ä¸²</h2>
            
            <h3>2.1 String() å‡½æ•°</h3>
            <pre><code>String(123)        // "123"
String(true)       // "true"
String(null)       // "null"
String(undefined)  // "undefined"
String([1,2,3])    // "1,2,3"
String({a:1})      // "[object Object]"</code></pre>
            
            <h3>2.2 toString() æ–¹æ³•</h3>
            <pre><code>(123).toString()   // "123"
[1,2,3].toString() // "1,2,3"
// null å’Œ undefined æ²¡æœ‰ toString æ–¹æ³•</code></pre>
            
            <h3>2.3 éšå¼è½¬æ¢</h3>
            <ul>
                <li>å­—ç¬¦ä¸²æ‹¼æ¥ï¼š<code>123 + ""  // "123"</code></li>
                <li>æ¨¡æ¿å­—ç¬¦ä¸²ï¼š<code>`${123}`  // "123"</code></li>
            </ul>
            
            <h2>ä¸‰ã€è½¬æ¢ä¸ºæ•°å­—</h2>
            
            <h3>3.1 Number() å‡½æ•°</h3>
            <table>
                <thead>
                    <tr>
                        <th>è¾“å…¥</th>
                        <th>è¾“å‡º</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>Number("123")</code></td>
                        <td>123</td>
                    </tr>
                    <tr>
                        <td><code>Number("12.5")</code></td>
                        <td>12.5</td>
                    </tr>
                    <tr>
                        <td><code>Number("")</code></td>
                        <td>0</td>
                    </tr>
                    <tr>
                        <td><code>Number("abc")</code></td>
                        <td>NaN</td>
                    </tr>
                    <tr>
                        <td><code>Number(true)</code></td>
                        <td>1</td>
                    </tr>
                    <tr>
                        <td><code>Number(false)</code></td>
                        <td>0</td>
                    </tr>
                    <tr>
                        <td><code>Number(null)</code></td>
                        <td>0</td>
                    </tr>
                    <tr>
                        <td><code>Number(undefined)</code></td>
                        <td>NaN</td>
                    </tr>
                </tbody>
            </table>
            
            <h3>3.2 parseInt() å’Œ parseFloat()</h3>
            <pre><code>parseInt("123")      // 123
parseInt("123px")    // 123 (è§£æåˆ°éæ•°å­—åœæ­¢)
parseInt("12.5")     // 12 (åªå–æ•´æ•°éƒ¨åˆ†)
parseFloat("12.5")   // 12.5
parseInt("0x10")     // 16 (åå…­è¿›åˆ¶)
parseInt("10", 2)    // 2 (äºŒè¿›åˆ¶)</code></pre>
            
            <h3>3.3 éšå¼è½¬æ¢</h3>
            <ul>
                <li>ç®—æœ¯è¿ç®—ï¼š<code>"5" - 2  // 3</code></li>
                <li>ä¸€å…ƒåŠ å·ï¼š<code>+"123"  // 123</code></li>
                <li>æ¯”è¾ƒè¿ç®—ï¼š<code>"5" > 3  // true</code></li>
            </ul>
            
            <h2>å››ã€è½¬æ¢ä¸ºå¸ƒå°”å€¼</h2>
            
            <h3>4.1 Boolean() å‡½æ•°</h3>
            <div class="info">
                <strong>å‡å€¼ï¼ˆFalsyï¼‰ï¼š</strong>
                <ul>
                    <li><code>false</code></li>
                    <li><code>0</code>ã€<code>-0</code>ã€<code>0n</code></li>
                    <li><code>""</code>ï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰</li>
                    <li><code>null</code></li>
                    <li><code>undefined</code></li>
                    <li><code>NaN</code></li>
                </ul>
                <strong>å…¶ä»–æ‰€æœ‰å€¼éƒ½æ˜¯çœŸå€¼ï¼ˆTruthyï¼‰ï¼</strong>
            </div>
            
            <h3>4.2 éšå¼è½¬æ¢</h3>
            <ul>
                <li>é€»è¾‘è¿ç®—ï¼š<code>!!"hello"  // true</code></li>
                <li>æ¡ä»¶åˆ¤æ–­ï¼š<code>if (value) {...}</code></li>
                <li>ä¸‰å…ƒè¿ç®—ç¬¦ï¼š<code>value ? a : b</code></li>
            </ul>
            
            <h2>äº”ã€ç›¸ç­‰æ€§æ¯”è¾ƒ</h2>
            
            <h3>5.1 == vs ===</h3>
            <table>
                <thead>
                    <tr>
                        <th>æ¯”è¾ƒ</th>
                        <th>==ï¼ˆå…è®¸ç±»å‹è½¬æ¢ï¼‰</th>
                        <th>===ï¼ˆä¸¥æ ¼ç›¸ç­‰ï¼‰</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>5 == "5"</code></td>
                        <td>true</td>
                        <td>false</td>
                    </tr>
                    <tr>
                        <td><code>0 == false</code></td>
                        <td>true</td>
                        <td>false</td>
                    </tr>
                    <tr>
                        <td><code>null == undefined</code></td>
                        <td>true</td>
                        <td>false</td>
                    </tr>
                    <tr>
                        <td><code>NaN == NaN</code></td>
                        <td>false</td>
                        <td>false</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="warning">
                <strong>æ¨èä½¿ç”¨ ===</strong>ï¼Œé¿å…ç±»å‹è½¬æ¢å¸¦æ¥çš„æ„å¤–ç»“æœã€‚
            </div>
            
            <h3>5.2 Object.is()</h3>
            <p>æ›´ä¸¥æ ¼çš„ç›¸ç­‰æ€§åˆ¤æ–­ï¼š</p>
            <pre><code>Object.is(NaN, NaN)      // true
Object.is(+0, -0)        // false
Object.is(5, 5)          // true</code></pre>
            
            <h2>å…­ã€ç±»å‹åˆ¤æ–­æ–¹æ³•</h2>
            
            <h3>6.1 typeof æ“ä½œç¬¦</h3>
            <pre><code>typeof 123           // "number"
typeof "abc"         // "string"
typeof true          // "boolean"
typeof undefined     // "undefined"
typeof Symbol()      // "symbol"
typeof 123n          // "bigint"
typeof null          // "object" âš ï¸
typeof []            // "object" âš ï¸
typeof {}            // "object"
typeof function(){}  // "function"</code></pre>
            
            <div class="warning">
                <code>typeof null</code> è¿”å› "object" æ˜¯ JavaScript çš„å†å² bugï¼
            </div>
            
            <h3>6.2 instanceof æ“ä½œç¬¦</h3>
            <p>æ£€æµ‹å¯¹è±¡æ˜¯å¦æ˜¯æŸä¸ªæ„é€ å‡½æ•°çš„å®ä¾‹ï¼š</p>
            <pre><code>[] instanceof Array        // true
{} instanceof Object       // true
new Date() instanceof Date // true</code></pre>
            
            <h3>6.3 Object.prototype.toString.call()</h3>
            <p>æœ€ç²¾ç¡®çš„ç±»å‹æ£€æµ‹æ–¹æ³•ï¼š</p>
            <pre><code>Object.prototype.toString.call([])        // "[object Array]"
Object.prototype.toString.call({})        // "[object Object]"
Object.prototype.toString.call(null)      // "[object Null]"
Object.prototype.toString.call(undefined) // "[object Undefined]"</code></pre>
            
            <h3>6.4 Array.isArray()</h3>
            <pre><code>Array.isArray([])   // true
Array.isArray({})   // false</code></pre>
            
            <h3>6.5 Number.isNaN()</h3>
            <pre><code>Number.isNaN(NaN)      // true
Number.isNaN("abc")    // false (ä¸è¿›è¡Œç±»å‹è½¬æ¢)
isNaN("abc")           // true (ä¼šå…ˆè½¬æ¢ä¸ºæ•°å­—)</code></pre>
            
            <h2>ä¸ƒã€ECMAScript æŠ½è±¡æ“ä½œï¼ˆæ·±å…¥åŸç†ï¼‰</h2>
            
            <h3>7.1 ToPrimitive æŠ½è±¡æ“ä½œ</h3>
            <p>è¿™æ˜¯ç±»å‹è½¬æ¢çš„æ ¸å¿ƒï¼æ‰€æœ‰å¯¹è±¡è½¬åŸå§‹å€¼éƒ½è¦ç»è¿‡è¿™ä¸ªæ“ä½œã€‚</p>
            
            <div class="spec">
                <strong>ToPrimitive(input, preferredType) æ‰§è¡Œæ­¥éª¤ï¼š</strong>
                <pre>1. å¦‚æœ input æ˜¯åŸå§‹å€¼ï¼Œç›´æ¥è¿”å›

2. å¦‚æœ input æœ‰ [Symbol.toPrimitive] æ–¹æ³•ï¼š
   - è°ƒç”¨ input[Symbol.toPrimitive](hint)
   - hint å¯èƒ½æ˜¯ "string"ã€"number" æˆ– "default"
   - å¦‚æœè¿”å›åŸå§‹å€¼ï¼Œè¿”å›ç»“æœ
   - å¦‚æœè¿”å›å¯¹è±¡ï¼ŒæŠ›å‡º TypeError

3. å¦‚æœæ²¡æœ‰ Symbol.toPrimitiveï¼š
   
   æƒ…å†µAï¼špreferredType æ˜¯ "string" (hint = "string")
   â”œâ”€ å…ˆè°ƒç”¨ toString() æ–¹æ³•
   â”‚  â””â”€ å¦‚æœè¿”å›åŸå§‹å€¼ï¼Œè¿”å›ç»“æœ
   â””â”€ å†è°ƒç”¨ valueOf() æ–¹æ³•
      â””â”€ å¦‚æœè¿”å›åŸå§‹å€¼ï¼Œè¿”å›ç»“æœ
      â””â”€ å¦‚æœéƒ½ä¸æ˜¯åŸå§‹å€¼ï¼ŒæŠ›å‡º TypeError
   
   æƒ…å†µBï¼špreferredType æ˜¯ "number" æˆ– "default" (hint = "number")
   â”œâ”€ å…ˆè°ƒç”¨ valueOf() æ–¹æ³•
   â”‚  â””â”€ å¦‚æœè¿”å›åŸå§‹å€¼ï¼Œè¿”å›ç»“æœ
   â””â”€ å†è°ƒç”¨ toString() æ–¹æ³•
      â””â”€ å¦‚æœè¿”å›åŸå§‹å€¼ï¼Œè¿”å›ç»“æœ
      â””â”€ å¦‚æœéƒ½ä¸æ˜¯åŸå§‹å€¼ï¼ŒæŠ›å‡º TypeError</pre>
            </div>
            
            <pre><code>// ç¤ºä¾‹ï¼šè‡ªå®šä¹‰ Symbol.toPrimitive
const obj = {
    [Symbol.toPrimitive](hint) {
        console.log('hint:', hint);
        if (hint === 'number') return 42;
        if (hint === 'string') return 'hello';
        return 'default';
    }
};

+obj;         // hint: "number" â†’ 42
String(obj);  // hint: "string" â†’ "hello"
obj + '';     // hint: "default" â†’ "default"</code></pre>
            
            <h3>7.2 ToString æŠ½è±¡æ“ä½œ</h3>
            <div class="spec">
                <strong>ToString(argument) æ‰§è¡Œæ­¥éª¤ï¼š</strong>
                <pre>1. Undefined â†’ "undefined"
2. Null â†’ "null"
3. Boolean â†’ "true" / "false"
4. Number â†’ æ•°å­—çš„å­—ç¬¦ä¸²è¡¨ç¤º
   - NaN â†’ "NaN"
   - +0/-0 â†’ "0"
   - Infinity â†’ "Infinity"
5. String â†’ ç›´æ¥è¿”å›
6. Symbol â†’ æŠ›å‡º TypeError
7. BigInt â†’ BigInt å­—ç¬¦ä¸²ï¼ˆä¸å¸¦ nï¼‰
8. Object:
   â”œâ”€ primValue = ToPrimitive(argument, "string")
   â””â”€ è¿”å› ToString(primValue)</pre>
            </div>
            
            <pre><code>// ç¤ºä¾‹ï¼šå¯¹è±¡è½¬å­—ç¬¦ä¸²çš„æ‰§è¡Œè¿‡ç¨‹
const obj = {
    valueOf() { return 42; },
    toString() { return "hello"; }
};

String(obj)
// æ‰§è¡Œï¼šToPrimitive(obj, "string")
// â†’ å…ˆè°ƒç”¨ toString() â†’ è¿”å› "hello" (åŸå§‹å€¼)
// â†’ ToString("hello") â†’ "hello"</code></pre>
            
            <h3>7.3 ToNumber æŠ½è±¡æ“ä½œ</h3>
            <div class="spec">
                <strong>ToNumber(argument) æ‰§è¡Œæ­¥éª¤ï¼š</strong>
                <pre>1. Undefined â†’ NaN
2. Null â†’ +0
3. Boolean â†’ true: 1, false: +0
4. Number â†’ ç›´æ¥è¿”å›
5. String:
   - "" â†’ +0
   - çº¯æ•°å­—å­—ç¬¦ä¸² â†’ å¯¹åº”æ•°å­—
   - å…¶ä»– â†’ NaN
6. Symbol â†’ æŠ›å‡º TypeError
7. BigInt â†’ æŠ›å‡º TypeError
8. Object:
   â”œâ”€ primValue = ToPrimitive(argument, "number")
   â””â”€ è¿”å› ToNumber(primValue)</pre>
            </div>
            
            <pre><code>// ç¤ºä¾‹ï¼šå¯¹è±¡è½¬æ•°å­—çš„æ‰§è¡Œè¿‡ç¨‹
const obj = {
    valueOf() { return 42; },
    toString() { return "100"; }
};

Number(obj)
// æ‰§è¡Œï¼šToPrimitive(obj, "number")
// â†’ å…ˆè°ƒç”¨ valueOf() â†’ è¿”å› 42 (åŸå§‹å€¼)
// â†’ ToNumber(42) â†’ 42

// å¦‚æœæ²¡æœ‰ valueOfï¼š
const obj2 = {
    toString() { return "100"; }
};

Number(obj2)
// â†’ å…ˆè°ƒç”¨ valueOf() â†’ è¿”å› obj2 æœ¬èº«ï¼ˆä¸æ˜¯åŸå§‹å€¼ï¼‰
// â†’ å†è°ƒç”¨ toString() â†’ è¿”å› "100" (åŸå§‹å€¼)
// â†’ ToNumber("100") â†’ 100</code></pre>
            
            <h3>7.4 ToBoolean æŠ½è±¡æ“ä½œ</h3>
            <p><strong>æ³¨æ„ï¼š</strong>ToBoolean ä¸ä¼šè°ƒç”¨ valueOf æˆ– toStringï¼</p>
            <div class="spec">
                <strong>ToBoolean(argument) - æœ€ç®€å•çš„è½¬æ¢ï¼š</strong>
                <pre>å‡å€¼ï¼ˆè¿”å› falseï¼‰ï¼š
1. undefined
2. null
3. false
4. +0ã€-0ã€NaN
5. "" (ç©ºå­—ç¬¦ä¸²)
6. 0n (BigInté›¶å€¼)

å…¶ä»–æ‰€æœ‰å€¼ï¼šè¿”å› true
ï¼ˆåŒ…æ‹¬å¯¹è±¡ã€æ•°ç»„ã€"false"å­—ç¬¦ä¸²ç­‰ï¼‰</pre>
            </div>
            
            <h2>å…«ã€è¿ç®—ç¬¦çš„ç±»å‹è½¬æ¢ç®—æ³•</h2>
            
            <h3>8.1 åŠ æ³•è¿ç®—ç¬¦ (+) çš„å®Œæ•´ç®—æ³•</h3>
            <p>åŠ æ³•æ˜¯æœ€å¤æ‚çš„è¿ç®—ç¬¦ï¼Œå› ä¸ºå®ƒåŒæ—¶æ”¯æŒæ•°å­—ç›¸åŠ å’Œå­—ç¬¦ä¸²æ‹¼æ¥ã€‚</p>
            
            <div class="spec">
                <strong>left + right æ‰§è¡Œæ­¥éª¤ï¼š</strong>
                <pre>1. lprim = ToPrimitive(left)    // hint æ˜¯ "default"
2. rprim = ToPrimitive(right)   // hint æ˜¯ "default"

3. å¦‚æœ lprim æ˜¯ String æˆ– rprim æ˜¯ Stringï¼š
   â””â”€ è¿”å› ToString(lprim) + ToString(rprim)  // å­—ç¬¦ä¸²æ‹¼æ¥
   
4. å¦åˆ™ï¼š
   â””â”€ è¿”å› ToNumber(lprim) + ToNumber(rprim)  // æ•°å­—ç›¸åŠ </pre>
            </div>
            
            <pre><code>// ç¤ºä¾‹åˆ†æ

// 1. [] + []
[] + []
// â†’ ToPrimitive([]) â†’ valueOf() è¿”å› [] (ä¸æ˜¯åŸå§‹å€¼)
// â†’ toString() è¿”å› "" (åŸå§‹å€¼)
// â†’ "" + "" â†’ ""

// 2. 1 + "2"
1 + "2"
// â†’ lprim = 1, rprim = "2"
// â†’ rprim æ˜¯å­—ç¬¦ä¸²ï¼è§¦å‘å­—ç¬¦ä¸²æ‹¼æ¥
// â†’ ToString(1) + ToString("2") â†’ "1" + "2" â†’ "12"

// 3. 1 + 2
1 + 2
// â†’ lprim = 1, rprim = 2
// â†’ éƒ½ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œè§¦å‘æ•°å­—ç›¸åŠ 
// â†’ ToNumber(1) + ToNumber(2) â†’ 1 + 2 â†’ 3</code></pre>
            
            <h3>8.2 ç›¸ç­‰æ€§æ¯”è¾ƒ (==) çš„å®Œæ•´ç®—æ³•</h3>
            <div class="spec">
                <strong>x == y æ‰§è¡Œæ­¥éª¤ï¼ˆ10æ­¥ç®—æ³•ï¼‰ï¼š</strong>
                <pre>1. å¦‚æœ Type(x) === Type(y)ï¼š
   â””â”€ è¿”å› x === y çš„ç»“æœ

2. å¦‚æœ x æ˜¯ null ä¸” y æ˜¯ undefinedï¼ˆæˆ–ç›¸åï¼‰ï¼š
   â””â”€ è¿”å› true

3. å¦‚æœ x æ˜¯ Number ä¸” y æ˜¯ Stringï¼š
   â””â”€ è¿”å› x == ToNumber(y)

4. å¦‚æœ x æ˜¯ String ä¸” y æ˜¯ Numberï¼š
   â””â”€ è¿”å› ToNumber(x) == y

5. å¦‚æœ x æ˜¯ BigInt ä¸” y æ˜¯ Stringï¼š
   â””â”€ è¿”å› x == StringToBigInt(y)

6. å¦‚æœ x æ˜¯ Booleanï¼š
   â””â”€ è¿”å› ToNumber(x) == y

7. å¦‚æœ y æ˜¯ Booleanï¼š
   â””â”€ è¿”å› x == ToNumber(y)

8. å¦‚æœ x æ˜¯ String/Number/BigInt/Symbol ä¸” y æ˜¯ Objectï¼š
   â””â”€ è¿”å› x == ToPrimitive(y)

9. å¦‚æœ x æ˜¯ Object ä¸” y æ˜¯ String/Number/BigInt/Symbolï¼š
   â””â”€ è¿”å› ToPrimitive(x) == y

10. è¿”å› false</pre>
            </div>
            
            <pre><code>// ç¤ºä¾‹ï¼š[] == ![]
[] == ![]
// æ­¥éª¤1ï¼š![] å…ˆæ±‚å€¼ â†’ !true â†’ false
// æ­¥éª¤2ï¼š[] == false
// æ­¥éª¤3ï¼šy æ˜¯ Booleanï¼Œè½¬ä¸º ToNumber(false) â†’ 0
// æ­¥éª¤4ï¼š[] == 0
// æ­¥éª¤5ï¼šx æ˜¯ Objectï¼Œè½¬ä¸º ToPrimitive([]) â†’ ""
// æ­¥éª¤6ï¼š"" == 0
// æ­¥éª¤7ï¼šx æ˜¯ Stringï¼Œè½¬ä¸º ToNumber("") â†’ 0
// æ­¥éª¤8ï¼š0 == 0 â†’ true

// ç¤ºä¾‹ï¼š"5" == 5
"5" == 5
// â†’ x æ˜¯ Stringï¼Œy æ˜¯ Numberï¼ˆè§„åˆ™4ï¼‰
// â†’ ToNumber("5") == 5
// â†’ 5 == 5 â†’ true</code></pre>
            
            <h2>ä¹ã€å®Œæ•´æ‰§è¡Œæµç¨‹å›¾</h2>
            
            <h3>9.1 Number(obj) çš„æ‰§è¡Œæµç¨‹</h3>
            <div class="spec">
                <pre>Number(obj)
  â†“
ToNumber(obj)
  â†“
åˆ¤æ–­ï¼šobj æ˜¯ Object
  â†“
è°ƒç”¨ ToPrimitive(obj, "number")
  â†“
æ£€æŸ¥ï¼šobj[Symbol.toPrimitive] å­˜åœ¨ï¼Ÿ
  â”œâ”€ æ˜¯ â†’ è°ƒç”¨ obj[Symbol.toPrimitive]("number")
  â”‚        â†“
  â”‚      è¿”å›ç»“æœï¼ˆå¿…é¡»æ˜¯åŸå§‹å€¼ï¼‰
  â”‚        â†“
  â”‚      ToNumber(ç»“æœ)
  â”‚
  â””â”€ å¦ â†’ å…ˆè°ƒç”¨ obj.valueOf()
           â†“
         è¿”å›åŸå§‹å€¼ï¼Ÿ
           â”œâ”€ æ˜¯ â†’ ToNumber(ç»“æœ)
           â”‚
           â””â”€ å¦ â†’ è°ƒç”¨ obj.toString()
                    â†“
                  è¿”å›åŸå§‹å€¼ï¼Ÿ
                    â”œâ”€ æ˜¯ â†’ ToNumber(ç»“æœ)
                    â”‚
                    â””â”€ å¦ â†’ æŠ›å‡º TypeError</pre>
            </div>
            
            <h2>åã€ç‰¹æ®Šæƒ…å†µ</h2>
            
            <h3>10.1 å¸¸è§é™·é˜±çš„åº•å±‚è§£é‡Š</h3>
            <div class="warning">
                <pre><code>// é™·é˜±1ï¼š+ è¿ç®—ç¬¦
"5" + 3          // "53" (å­—ç¬¦ä¸²æ‹¼æ¥)
"5" - 3          // 2 (æ•°å­—è¿ç®—)

// é™·é˜±2ï¼šç©ºæ•°ç»„å’Œå¯¹è±¡
[] + []          // "" (ä¸¤ä¸ªç©ºå­—ç¬¦ä¸²ç›¸åŠ )
[] + {}          // "[object Object]"
{} + []          // 0 (è¯­æ³•æ­§ä¹‰ï¼Œ{} è¢«å½“ä½œä»£ç å—)

// é™·é˜±3ï¼šæ¯”è¾ƒè¿ç®—
[] == ![]        // true (å¤æ‚çš„ç±»å‹è½¬æ¢)
[] == 0          // true

// é™·é˜±4ï¼šè‡ªåŠ¨è£…ç®±
const str = "hello";
str.length       // 5 (è‡ªåŠ¨è½¬æ¢ä¸º String å¯¹è±¡)</code></pre>
            </div>
            
            <h3>10.2 è‡ªåŠ¨è£…ç®±ï¼ˆAuto-boxingï¼‰</h3>
            <pre><code>// åŸå§‹ç±»å‹å¦‚ä½•è®¿é—®æ–¹æ³•ï¼Ÿ
"hello".length
// æ‰§è¡Œè¿‡ç¨‹ï¼š
// 1. åˆ›å»ºä¸´æ—¶ String å¯¹è±¡ï¼šnew String("hello")
// 2. è®¿é—® .length å±æ€§ â†’ 5
// 3. é”€æ¯ä¸´æ—¶å¯¹è±¡
// 4. è¿”å› 5

// è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåŸå§‹å€¼å¯ä»¥è°ƒç”¨æ–¹æ³•ï¼
const str = "hello";
str.toUpperCase();  // ä¸´æ—¶è£…ç®±ä¸º String å¯¹è±¡</code></pre>
            
            <h2>åä¸€ã€æœ€ä½³å®è·µ</h2>
            
            <div class="tip">
                <strong>å»ºè®®ï¼š</strong>
                <ul>
                    <li>å§‹ç»ˆä½¿ç”¨ <code>===</code> å’Œ <code>!==</code></li>
                    <li>æ˜¾å¼è¿›è¡Œç±»å‹è½¬æ¢ï¼Œé¿å…ä¾èµ–éšå¼è½¬æ¢</li>
                    <li>ä½¿ç”¨ <code>Number.isNaN()</code> è€Œä¸æ˜¯ <code>isNaN()</code></li>
                    <li>ä½¿ç”¨ <code>Array.isArray()</code> æ£€æµ‹æ•°ç»„</li>
                    <li>å¯¹äºç²¾ç¡®ç±»å‹åˆ¤æ–­ï¼Œä½¿ç”¨ <code>Object.prototype.toString.call()</code></li>
                </ul>
            </div>
            
            <h2>å‚è€ƒèµ„æ–™</h2>
            <ul>
                <li><a href="https://tc39.es/ecma262/#sec-type-conversion" target="_blank">ECMAScript - Type Conversion</a></li>
                <li><a href="https://tc39.es/ecma262/#sec-abstract-equality-comparison" target="_blank">ECMAScript - Abstract Equality Comparison</a></li>
                <li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Equality_comparisons_and_sameness" target="_blank">MDN - ç›¸ç­‰æ€§åˆ¤æ–­</a></li>
            </ul>
            
            <div class="nav-links">
                <a href="01-datatypes.html" class="nav-link prev">ä¸Šä¸€èŠ‚ï¼šæ•°æ®ç±»å‹è¯¦è§£</a>
                <a href="../index.html" class="nav-link home">è¿”å›é¦–é¡µ</a>
                <a href="02-operators.html" class="nav-link next">ä¸‹ä¸€èŠ‚ï¼šè¿ç®—ç¬¦å®Œå…¨æŒ‡å—</a>
            </div>
        </div>
        
        <div class="code-panel">
            <h2 style="color: #60a5fa; margin-bottom: 1.5rem;">ğŸ’» äº¤äº’å¼ä»£ç ç¤ºä¾‹</h2>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 1ï¼šæ˜¾å¼ç±»å‹è½¬æ¢</h3>
                <div class="code-block">
                    <pre><code>// è½¬æ¢ä¸ºå­—ç¬¦ä¸²
console.log('String(123):', String(123));
console.log('String(true):', String(true));
console.log('String(null):', String(null));
console.log('String([1,2,3]):', String([1,2,3]));

// è½¬æ¢ä¸ºæ•°å­—
console.log('Number("123"):', Number("123"));
console.log('Number(""):', Number(""));
console.log('Number("abc"):', Number("abc"));
console.log('Number(true):', Number(true));
console.log('Number(null):', Number(null));
console.log('Number(undefined):', Number(undefined));

// è½¬æ¢ä¸ºå¸ƒå°”å€¼
console.log('Boolean(0):', Boolean(0));
console.log('Boolean(""):', Boolean(""));
console.log('Boolean("hello"):', Boolean("hello"));
console.log('Boolean([]):', Boolean([]));</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 2ï¼šéšå¼ç±»å‹è½¬æ¢</h3>
                <div class="code-block">
                    <pre><code>// å­—ç¬¦ä¸²æ‹¼æ¥ vs æ•°å­—è¿ç®—
console.log('"5" + 3:', "5" + 3);       // "53"
console.log('"5" - 3:', "5" - 3);       // 2
console.log('"5" * 2:', "5" * 2);       // 10

// ä¸€å…ƒåŠ å·è½¬æ¢
console.log('+"123":', +"123");
console.log('+true:', +true);
console.log('+false:', +false);
console.log('+"abc":', +"abc");

// é€»è¾‘éè½¬æ¢
console.log('!!"hello":', !!"hello");
console.log('!!0:', !!0);
console.log('!![]:', !![]);

// æ¯”è¾ƒè¿ç®—ä¸­çš„è½¬æ¢
console.log('"5" > 3:', "5" > 3);
console.log('true == 1:', true == 1);</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 3ï¼š== vs ===</h3>
                <div class="code-block">
                    <pre><code>console.log('=== å®½æ¾ç›¸ç­‰ (==) ===');
console.log('5 == "5":', 5 == "5");
console.log('0 == false:', 0 == false);
console.log('"" == false:', "" == false);
console.log('null == undefined:', null == undefined);
console.log('[] == 0:', [] == 0);

console.log('\n=== ä¸¥æ ¼ç›¸ç­‰ (===) ===');
console.log('5 === "5":', 5 === "5");
console.log('0 === false:', 0 === false);
console.log('"" === false:', "" === false);
console.log('null === undefined:', null === undefined);
console.log('[] === 0:', [] === 0);

console.log('\n=== Object.is() ===');
console.log('Object.is(NaN, NaN):', Object.is(NaN, NaN));
console.log('NaN === NaN:', NaN === NaN);
console.log('Object.is(+0, -0):', Object.is(+0, -0));
console.log('+0 === -0:', +0 === -0);</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 4ï¼šç±»å‹åˆ¤æ–­</h3>
                <div class="code-block">
                    <pre><code>// typeof
console.log('=== typeof ===');
console.log('typeof 123:', typeof 123);
console.log('typeof "abc":', typeof "abc");
console.log('typeof true:', typeof true);
console.log('typeof null:', typeof null);        // "object"!
console.log('typeof undefined:', typeof undefined);
console.log('typeof []:', typeof []);            // "object"!
console.log('typeof {}:', typeof {});
console.log('typeof function(){}:', typeof function(){});

// ç²¾ç¡®ç±»å‹æ£€æµ‹
function getType(value) {
    return Object.prototype.toString.call(value).slice(8, -1);
}

console.log('\n=== ç²¾ç¡®ç±»å‹ ===');
console.log('getType([]):', getType([]));
console.log('getType({}):', getType({}));
console.log('getType(null):', getType(null));
console.log('getType(undefined):', getType(undefined));
console.log('getType(123):', getType(123));

// ç‰¹æ®Šæ£€æµ‹
console.log('\n=== ç‰¹æ®Šæ£€æµ‹ ===');
console.log('Array.isArray([]):', Array.isArray([]));
console.log('Number.isNaN(NaN):', Number.isNaN(NaN));
console.log('Number.isNaN("abc"):', Number.isNaN("abc"));</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 5ï¼šparseInt é™·é˜±</h3>
                <div class="code-block">
                    <pre><code>// parseInt çš„ç‰¹æ®Šè¡Œä¸º
console.log('parseInt("123"):', parseInt("123"));
console.log('parseInt("123px"):', parseInt("123px"));     // 123
console.log('parseInt("px123"):', parseInt("px123"));     // NaN
console.log('parseInt("12.5"):', parseInt("12.5"));       // 12
console.log('parseFloat("12.5"):', parseFloat("12.5"));   // 12.5

// è¿›åˆ¶è½¬æ¢
console.log('\n=== è¿›åˆ¶è½¬æ¢ ===');
console.log('parseInt("10", 10):', parseInt("10", 10));   // 10
console.log('parseInt("10", 2):', parseInt("10", 2));     // 2
console.log('parseInt("10", 8):', parseInt("10", 8));     // 8
console.log('parseInt("10", 16):', parseInt("10", 16));   // 16

// é™·é˜±ï¼šæ•°ç»„ map
const arr = ["1", "2", "3"];
console.log('\n=== æ•°ç»„ map é™·é˜± ===');
console.log('arr.map(parseInt):', arr.map(parseInt));
// ç›¸å½“äºï¼š[parseInt("1", 0), parseInt("2", 1), parseInt("3", 2)]
// ç»“æœï¼š[1, NaN, NaN]

console.log('æ­£ç¡®å†™æ³•:', arr.map(x => parseInt(x, 10)));</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 6ï¼šç»å…¸é™·é˜±</h3>
                <div class="code-block">
                    <pre><code>// é™·é˜±1ï¼šç©ºæ•°ç»„å’Œå¯¹è±¡
console.log('=== ç©ºæ•°ç»„å’Œå¯¹è±¡ ===');
console.log('[] + []:', [] + []);            // ""
console.log('[1] + [2]:', [1] + [2]);        // "12"
console.log('[] == ![]:', [] == ![]);        // true!

// é™·é˜±2ï¼šåŠ å·è¿ç®—ç¬¦
console.log('\n=== åŠ å·è¿ç®—ç¬¦ ===');
console.log('1 + 2:', 1 + 2);                // 3
console.log('"1" + 2:', "1" + 2);            // "12"
console.log('1 + "2":', 1 + "2");            // "12"
console.log('true + 1:', true + 1);          // 2
console.log('false + 1:', false + 1);        // 1

// é™·é˜±3ï¼šå‡å·è¿ç®—ç¬¦
console.log('\n=== å‡å·è¿ç®—ç¬¦ ===');
console.log('"5" - 3:', "5" - 3);            // 2
console.log('"5" - "3":', "5" - "3");        // 2
console.log('"abc" - 1:', "abc" - 1);        // NaN

// é™·é˜±4ï¼šè‡ªåŠ¨è£…ç®±
console.log('\n=== è‡ªåŠ¨è£…ç®± ===');
const str = "hello";
console.log('str.length:', str.length);       // 5
console.log('typeof str:', typeof str);       // "string"
console.log('str[0]:', str[0]);               // "h"</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 7ï¼šToPrimitive æ·±å…¥</h3>
                <div class="code-block">
                    <pre><code>console.log('=== ToPrimitive æŠ½è±¡æ“ä½œ ===\n');

// 1. Symbol.toPrimitive ä¼˜å…ˆçº§æœ€é«˜
const obj1 = {
    [Symbol.toPrimitive](hint) {
        console.log(`1. hint: "${hint}"`);
        if (hint === 'number') return 42;
        if (hint === 'string') return 'hello';
        return 'default';
    }
};

console.log('Number(obj1):', Number(obj1));   // hint: "number"
console.log('String(obj1):', String(obj1));   // hint: "string"
console.log('obj1 + "":', obj1 + '');         // hint: "default"

// 2. æ²¡æœ‰ Symbol.toPrimitiveï¼Œä½¿ç”¨ valueOf/toString
console.log('\n2. valueOf å’Œ toString çš„è°ƒç”¨é¡ºåº:');
const obj2 = {
    valueOf() {
        console.log('  è°ƒç”¨ valueOf()');
        return 100;
    },
    toString() {
        console.log('  è°ƒç”¨ toString()');
        return 'text';
    }
};

console.log('Number(obj2):');
Number(obj2);  // å…ˆ valueOf

console.log('\nString(obj2):');
String(obj2);  // å…ˆ toString</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 8ï¼šåŠ æ³•è¿ç®—ç¬¦æ·±å…¥åˆ†æ</h3>
                <div class="code-block">
                    <pre><code>console.log('=== åŠ æ³•è¿ç®—ç¬¦çš„æ‰§è¡Œè¿‡ç¨‹ ===\n');

// ä¾‹1ï¼š[] + []
console.log('1. [] + []:');
console.log('  ç»“æœ:', [] + []);
console.log('  è§£é‡Š: ToPrimitive([]) â†’ "" , "" + "" â†’ ""');

// ä¾‹2ï¼š[] + {}
console.log('\n2. [] + {}:');
console.log('  ç»“æœ:', [] + {});
console.log('  è§£é‡Š: ToPrimitive([]) â†’ ""');
console.log('        ToPrimitive({}) â†’ "[object Object]"');
console.log('        "" + "[object Object]" â†’ "[object Object]"');

// ä¾‹3ï¼š1 + "2"
console.log('\n3. 1 + "2":');
console.log('  ç»“æœ:', 1 + "2");
console.log('  è§£é‡Š: rprim æ˜¯ Stringï¼Œè§¦å‘å­—ç¬¦ä¸²æ‹¼æ¥');

// ä¾‹4ï¼šå¸¦ valueOf çš„å¯¹è±¡
const money = {
    valueOf() { return 100; }
};
console.log('\n4. money + 50:');
console.log('  ç»“æœ:', money + 50);
console.log('  è§£é‡Š: ToPrimitive(money) â†’ valueOf() â†’ 100');
console.log('        100 + 50 â†’ 150');</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 9ï¼š== ç›¸ç­‰æ€§æ¯”è¾ƒæ·±å…¥</h3>
                <div class="code-block">
                    <pre><code>console.log('=== ç›¸ç­‰æ€§æ¯”è¾ƒçš„æ‰§è¡Œè¿‡ç¨‹ ===\n');

// ä¾‹1ï¼š[] == ![]
console.log('1. [] == ![] çš„æ‰§è¡Œæ­¥éª¤:');
console.log('  ![] â†’ false');
console.log('  [] == false');
console.log('  ToNumber(false) â†’ 0');
console.log('  [] == 0');
console.log('  ToPrimitive([]) â†’ ""');
console.log('  "" == 0');
console.log('  ToNumber("") â†’ 0');
console.log('  0 == 0 â†’ true');
console.log('  ç»“æœ:', [] == ![]);

// ä¾‹2ï¼š"5" == 5
console.log('\n2. "5" == 5 çš„æ‰§è¡Œæ­¥éª¤:');
console.log('  x æ˜¯ Stringï¼Œy æ˜¯ Number');
console.log('  ToNumber("5") â†’ 5');
console.log('  5 == 5 â†’ true');
console.log('  ç»“æœ:', "5" == 5);

// ä¾‹3ï¼šnull == undefined
console.log('\n3. null == undefined:');
console.log('  ç‰¹æ®Šè§„åˆ™ï¼šç›´æ¥è¿”å› true');
console.log('  ç»“æœ:', null == undefined);

// ä¾‹4ï¼šå¯¹æ¯” === 
console.log('\n4. ä¸¥æ ¼ç›¸ç­‰ (===) ä¸è¿›è¡Œç±»å‹è½¬æ¢:');
console.log('  "5" === 5:', "5" === 5);
console.log('  null === undefined:', null === undefined);</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 10ï¼šå®Œæ•´è½¬æ¢æµç¨‹æ¼”ç¤º</h3>
                <div class="code-block">
                    <pre><code>console.log('=== å®Œæ•´çš„ç±»å‹è½¬æ¢æµç¨‹ ===\n');

// åˆ›å»ºä¸€ä¸ªè¿½è¸ªè½¬æ¢è¿‡ç¨‹çš„å¯¹è±¡
const tracker = {
    valueOf() {
        console.log('  â†’ valueOf() è¢«è°ƒç”¨');
        return this;  // è¿”å›å¯¹è±¡æœ¬èº«ï¼ˆä¸æ˜¯åŸå§‹å€¼ï¼‰
    },
    toString() {
        console.log('  â†’ toString() è¢«è°ƒç”¨');
        return '42';  // è¿”å›åŸå§‹å€¼
    }
};

console.log('1. Number(tracker):');
console.log('  æ‰§è¡Œ ToPrimitive(tracker, "number")');
const result1 = Number(tracker);
console.log('  â†’ ToNumber("42") â†’ 42');
console.log('  æœ€ç»ˆç»“æœ:', result1);

console.log('\n2. String(tracker):');
console.log('  æ‰§è¡Œ ToPrimitive(tracker, "string")');
const result2 = String(tracker);
console.log('  æœ€ç»ˆç»“æœ:', result2);

// å¸¦ Symbol.toPrimitive çš„å¯¹è±¡
console.log('\n3. å¸¦ Symbol.toPrimitive çš„å¯¹è±¡:');
const custom = {
    [Symbol.toPrimitive](hint) {
        console.log(`  â†’ Symbol.toPrimitive("${hint}") è¢«è°ƒç”¨`);
        return hint === 'number' ? 100 : 'custom';
    },
    valueOf() {
        console.log('  â†’ valueOf() (ä¸ä¼šè¢«è°ƒç”¨)');
        return 50;
    }
};

console.log('  +custom:', +custom);
console.log('  String(custom):', String(custom));</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
        </div>
    </div>
    
    <script src="../assets/js/common.js"></script>
</body>
</html>
