<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç›¸ç­‰æ€§æ¯”è¾ƒç®—æ³• - JavaScript æ·±åº¦å­¦ä¹ </title>
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="../assets/css/page.css">
</head>
<body>
    <div class="page-layout">
        <div class="doc-panel">
            <h1>ç›¸ç­‰æ€§æ¯”è¾ƒç®—æ³•</h1>
            
            <h2>æ¦‚è¿°</h2>
            <p>JavaScript æä¾›äº†å¤šç§ç›¸ç­‰æ€§æ¯”è¾ƒæ–¹å¼ï¼Œæ¯ç§éƒ½æœ‰ä¸åŒçš„è¡Œä¸ºã€‚ç†è§£ ECMAScript è§„èŒƒä¸­å®šä¹‰çš„ç›¸ç­‰æ€§ç®—æ³•ï¼Œæ˜¯é¿å…æ¯”è¾ƒé™·é˜±çš„å…³é”®ã€‚</p>
            
            <h2>ä¸€ã€å››ç§ç›¸ç­‰æ€§æ¯”è¾ƒ</h2>
            
            <h3>1.1 æ¯”è¾ƒæ–¹å¼</h3>
            <div class="info">
                <ul>
                    <li><strong>==</strong>ï¼ˆå®½æ¾ç›¸ç­‰ï¼‰ï¼šè¿›è¡Œç±»å‹è½¬æ¢åæ¯”è¾ƒ</li>
                    <li><strong>===</strong>ï¼ˆä¸¥æ ¼ç›¸ç­‰ï¼‰ï¼šä¸è¿›è¡Œç±»å‹è½¬æ¢</li>
                    <li><strong>Object.is()</strong>ï¼šä¸ === ç±»ä¼¼ï¼Œä½†å¤„ç† NaN å’Œ +0/-0</li>
                    <li><strong>SameValueZero</strong>ï¼šç”¨äº Setã€Map ç­‰</li>
                </ul>
            </div>
            
            <h3>1.2 å¿«é€Ÿå¯¹æ¯”</h3>
            <pre><code>// === ä¸¥æ ¼ç›¸ç­‰
5 === 5;           // true
5 === '5';         // false
NaN === NaN;       // false
+0 === -0;         // true

// == å®½æ¾ç›¸ç­‰
5 == 5;            // true
5 == '5';          // trueï¼ˆç±»å‹è½¬æ¢ï¼‰
null == undefined; // true

// Object.is()
Object.is(5, 5);           // true
Object.is(5, '5');         // false
Object.is(NaN, NaN);       // trueï¼ˆç‰¹æ®Šï¼‰
Object.is(+0, -0);         // falseï¼ˆç‰¹æ®Šï¼‰</code></pre>
            
            <h2>äºŒã€== å®½æ¾ç›¸ç­‰ç®—æ³•</h2>
            
            <h3>2.1 ç›¸åŒç±»å‹</h3>
            <pre><code>// ç›¸åŒç±»å‹æ—¶ï¼Œè¡Œä¸ºç±»ä¼¼ ===
5 == 5;            // true
'hello' == 'hello'; // true
true == true;      // true

// å¯¹è±¡æ¯”è¾ƒå¼•ç”¨
const obj = {};
obj == obj;        // true
{} == {};          // falseï¼ˆä¸åŒå¼•ç”¨ï¼‰</code></pre>
            
            <h3>2.2 ä¸åŒç±»å‹è½¬æ¢è§„åˆ™</h3>
            <pre><code>// 1. null == undefinedï¼ˆç‰¹æ®Šè§„åˆ™ï¼‰
null == undefined;     // true
null == null;          // true
undefined == undefined; // true

// 2. Number vs Stringï¼šString è½¬ Number
5 == '5';              // trueï¼ˆ'5' â†’ 5ï¼‰
0 == '';               // trueï¼ˆ'' â†’ 0ï¼‰
1 == '1';              // true

// 3. Boolean è½¬ Number
true == 1;             // trueï¼ˆtrue â†’ 1ï¼‰
false == 0;            // trueï¼ˆfalse â†’ 0ï¼‰
true == '1';           // trueï¼ˆtrue â†’ 1, '1' â†’ 1ï¼‰

// 4. Object è½¬ Primitive
[1] == 1;              // trueï¼ˆ[1] â†’ '1' â†’ 1ï¼‰
['1'] == 1;            // true
[1, 2] == '1,2';       // trueï¼ˆ[1,2] â†’ '1,2'ï¼‰

// 5. å…¶ä»–æƒ…å†µéƒ½æ˜¯ false
null == 0;             // false
undefined == 0;        // false
null == false;         // false</code></pre>
            
            <h3>2.3 é™·é˜±ç¤ºä¾‹</h3>
            <pre><code>// å¸¸è§é™·é˜±
'' == 0;               // true
'0' == 0;              // true
'0' == false;          // true
false == '0';          // true

// ä½†æ˜¯ï¼
'' == '0';             // falseï¼ˆç›¸åŒç±»å‹ï¼Œç›´æ¥æ¯”è¾ƒï¼‰

// ä¼ é€’æ€§å¤±æ•ˆ
'0' == 0;              // true
0 == '';               // true
'0' == '';             // falseï¼ˆï¼ï¼‰

// æ•°ç»„çš„é™·é˜±
[] == ![];             // true
// æ­¥éª¤ï¼š
// 1. ![] â†’ false
// 2. [] == false
// 3. [] â†’ '' â†’ 0
// 4. false â†’ 0
// 5. 0 == 0 â†’ true</code></pre>
            
            <h2>ä¸‰ã€=== ä¸¥æ ¼ç›¸ç­‰ç®—æ³•</h2>
            
            <h3>3.1 åŸºæœ¬è§„åˆ™</h3>
            <pre><code>// ç±»å‹ä¸åŒç›´æ¥è¿”å› false
5 === '5';             // false
1 === true;            // false
null === undefined;    // false

// ç±»å‹ç›¸åŒ
5 === 5;               // true
'hello' === 'hello';   // true

// ç‰¹æ®Šå€¼
NaN === NaN;           // falseï¼ˆå”¯ä¸€ä¾‹å¤–ï¼‰
+0 === -0;             // true

// å¯¹è±¡æ¯”è¾ƒå¼•ç”¨
const obj = {};
obj === obj;           // true
{} === {};             // false</code></pre>
            
            <h3>3.2 NaN çš„ç‰¹æ®Šå¤„ç†</h3>
            <pre><code>// NaN ä¸ç­‰äºä»»ä½•å€¼
NaN === NaN;           // false
NaN !== NaN;           // true

// æ£€æŸ¥ NaN
Number.isNaN(NaN);     // true
Number.isNaN(value);   // æ¨èæ–¹å¼

// æˆ–ä½¿ç”¨ Object.is
Object.is(NaN, NaN);   // true</code></pre>
            
            <h3>3.3 +0 å’Œ -0</h3>
            <pre><code>// === è®¤ä¸º +0 å’Œ -0 ç›¸ç­‰
+0 === -0;             // true

// åŒºåˆ†å®ƒä»¬
function isNegativeZero(value) {
    return value === 0 && 1 / value === -Infinity;
}

isNegativeZero(-0);    // true
isNegativeZero(+0);    // false

// æˆ–ä½¿ç”¨ Object.is
Object.is(+0, -0);     // false</code></pre>
            
            <h2>å››ã€Object.is() ç®—æ³•</h2>
            
            <h3>4.1 ä¸ === çš„åŒºåˆ«</h3>
            <pre><code>// Object.is åŸºæœ¬ç­‰åŒäº ===ï¼Œä½†æœ‰ä¸¤ä¸ªä¾‹å¤–

// 1. NaN å¤„ç†
NaN === NaN;           // false
Object.is(NaN, NaN);   // true âœ“

// 2. +0/-0 å¤„ç†
+0 === -0;             // true
Object.is(+0, -0);     // false âœ“

// å…¶ä»–æƒ…å†µç›¸åŒ
Object.is(1, 1);       // true
Object.is('a', 'a');   // true
Object.is({}, {});     // false</code></pre>
            
            <h3>4.2 polyfill å®ç°</h3>
            <pre><code>if (!Object.is) {
    Object.is = function(x, y) {
        // SameValue ç®—æ³•
        if (x === y) {
            // å¤„ç† +0 å’Œ -0
            return x !== 0 || 1 / x === 1 / y;
        } else {
            // å¤„ç† NaN
            return x !== x && y !== y;
        }
    };
}</code></pre>
            
            <h2>äº”ã€SameValueZero ç®—æ³•</h2>
            
            <h3>5.1 ç”¨é€”</h3>
            <p>SameValueZero ç”¨äº Setã€Mapã€includes() ç­‰ï¼Œä¸ Object.is ç±»ä¼¼ï¼Œä½†è®¤ä¸º +0 å’Œ -0 ç›¸ç­‰ã€‚</p>
            
            <pre><code>// Set ä½¿ç”¨ SameValueZero
const set = new Set();
set.add(NaN);
set.add(NaN);
console.log(set.size);     // 1ï¼ˆNaN è¢«è§†ä¸ºç›¸ç­‰ï¼‰

set.add(+0);
set.add(-0);
console.log(set.size);     // 2ï¼ˆ+0 å’Œ -0 è¢«è§†ä¸ºç›¸ç­‰ï¼‰

// Array.includes ä½¿ç”¨ SameValueZero
[NaN].includes(NaN);       // true
[+0].includes(-0);         // true

// Array.indexOf ä½¿ç”¨ä¸¥æ ¼ç›¸ç­‰
[NaN].indexOf(NaN);        // -1ï¼ˆæ‰¾ä¸åˆ°ï¼‰
[+0].indexOf(-0);          // 0ï¼ˆæ‰¾åˆ°äº†ï¼‰</code></pre>
            
            <h2>å…­ã€å¯¹è±¡ç›¸ç­‰æ€§</h2>
            
            <h3>6.1 å¼•ç”¨æ¯”è¾ƒ</h3>
            <pre><code>// å¯¹è±¡æ¯”è¾ƒå¼•ç”¨ï¼Œä¸æ¯”è¾ƒå†…å®¹
const obj1 = { x: 1 };
const obj2 = { x: 1 };
const obj3 = obj1;

obj1 === obj2;         // falseï¼ˆä¸åŒå¼•ç”¨ï¼‰
obj1 === obj3;         // trueï¼ˆç›¸åŒå¼•ç”¨ï¼‰

// æ•°ç»„ä¹Ÿæ˜¯å¯¹è±¡
[1, 2] === [1, 2];     // false
const arr = [1, 2];
arr === arr;           // true</code></pre>
            
            <h3>6.2 æ·±åº¦ç›¸ç­‰</h3>
            <pre><code>// éœ€è¦è‡ªå·±å®ç°æ·±åº¦ç›¸ç­‰
function deepEqual(a, b) {
    // ä¸¥æ ¼ç›¸ç­‰
    if (a === b) return true;
    
    // null æ£€æŸ¥
    if (a == null || b == null) return false;
    
    // ç±»å‹æ£€æŸ¥
    if (typeof a !== 'object' || typeof b !== 'object') {
        return false;
    }
    
    // é”®æ•°é‡æ£€æŸ¥
    const keysA = Object.keys(a);
    const keysB = Object.keys(b);
    if (keysA.length !== keysB.length) return false;
    
    // é€’å½’æ¯”è¾ƒ
    for (const key of keysA) {
        if (!keysB.includes(key)) return false;
        if (!deepEqual(a[key], b[key])) return false;
    }
    
    return true;
}

deepEqual({ x: 1 }, { x: 1 });  // true
deepEqual([1, 2], [1, 2]);      // true</code></pre>
            
            <h2>ä¸ƒã€æ¯”è¾ƒé™·é˜±</h2>
            
            <h3>7.1 å¸¸è§é”™è¯¯</h3>
            <pre><code>// 1. æ•°ç»„/å¯¹è±¡æ¯”è¾ƒ
[1, 2, 3] == '1,2,3';  // trueï¼ˆæ•°ç»„è½¬å­—ç¬¦ä¸²ï¼‰
[1, 2, 3] === '1,2,3'; // false

// 2. å¸ƒå°”å€¼æ¯”è¾ƒ
if (obj.prop == true) {}  // ä¸æ¨è
if (obj.prop) {}          // æ¨è

// 3. null/undefined æ£€æŸ¥
if (value == null) {}     // æ£€æŸ¥ null å’Œ undefined
if (value === null) {}    // åªæ£€æŸ¥ null

// 4. NaN æ£€æŸ¥
if (value === NaN) {}     // âŒ æ°¸è¿œä¸º false
if (Number.isNaN(value)) {} // âœ“ æ­£ç¡®

// 5. ç©ºæ•°ç»„/å¯¹è±¡
[] == false;              // true
[] === false;             // false
Boolean([]);              // true</code></pre>
            
            <h3>7.2 åç›´è§‰çš„ç»“æœ</h3>
            <pre><code>// è¿™äº›éƒ½æ˜¯ trueï¼
[] == ![];                // true
'' == [null];             // true
0 == '\n';                // true
[null] == '';             // true
[undefined] == '';        // true

// å»ºè®®ï¼šæ°¸è¿œä½¿ç”¨ ===</code></pre>
            
            <h2>å…«ã€æœ€ä½³å®è·µ</h2>
            
            <div class="tip">
                <ol>
                    <li><strong>ä¼˜å…ˆä½¿ç”¨ ===</strong>ï¼šé¿å…ç±»å‹è½¬æ¢çš„é™·é˜±</li>
                    <li><strong>== ä»…ç”¨äº null æ£€æŸ¥</strong>ï¼šif (value == null)</li>
                    <li><strong>NaN ç”¨ Number.isNaN()</strong>ï¼šä¸è¦ç”¨ ===</li>
                    <li><strong>å¯¹è±¡æ¯”è¾ƒç”¨æ·±åº¦ç›¸ç­‰</strong>ï¼šä¸èƒ½ç”¨ ===</li>
                    <li><strong>æ•°ç»„æŸ¥æ‰¾ç”¨ includes</strong>ï¼šæ”¯æŒ NaN</li>
                    <li><strong>é¿å… == çš„éšå¼è½¬æ¢</strong>ï¼šéš¾ä»¥é¢„æµ‹å’Œç»´æŠ¤</li>
                    <li><strong>ç†è§£ Object.is()</strong>ï¼šå¤„ç†ç‰¹æ®Šå€¼</li>
                </ol>
            </div>
            
            <h2>å‚è€ƒèµ„æ–™</h2>
            <ul>
                <li><a href="https://tc39.es/ecma262/#sec-abstract-equality-comparison" target="_blank">ECMAScript - Abstract Equality</a></li>
                <li><a href="https://tc39.es/ecma262/#sec-strict-equality-comparison" target="_blank">ECMAScript - Strict Equality</a></li>
                <li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Equality_comparisons_and_sameness" target="_blank">MDN - ç›¸ç­‰æ€§åˆ¤æ–­</a></li>
            </ul>
            
            <div class="nav-links">
                <a href="16-type-coercion.html" class="nav-link prev">ä¸Šä¸€èŠ‚ï¼šç±»å‹å¼ºåˆ¶è½¬æ¢</a>
                <a href="../index.html" class="nav-link home">è¿”å›é¦–é¡µ</a>
                <a href="16-boxing.html" class="nav-link next">ä¸‹ä¸€èŠ‚ï¼šè£…ç®±ä¸æ‹†ç®±</a>
            </div>
        </div>
        
        <div class="code-panel">
            <h2 style="color: #60a5fa; margin-bottom: 1.5rem;">ğŸ’» äº¤äº’å¼ä»£ç ç¤ºä¾‹</h2>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 1ï¼š== vs ===</h3>
                <div class="code-block">
                    <pre><code>// == å’Œ === çš„åŒºåˆ«
console.log('=== == vs === ===\n');

console.log('1. ç›¸åŒç±»å‹:');
console.log('  5 == 5:', 5 == 5);
console.log('  5 === 5:', 5 === 5);

console.log('\n2. ä¸åŒç±»å‹:');
console.log('  5 == "5":', 5 == '5');
console.log('  5 === "5":', 5 === '5');

console.log('\n3. null å’Œ undefined:');
console.log('  null == undefined:', null == undefined);
console.log('  null === undefined:', null === undefined);

console.log('\n4. å¸ƒå°”å€¼:');
console.log('  1 == true:', 1 == true);
console.log('  1 === true:', 1 === true);

console.log('\n5. å¯¹è±¡:');
const obj = {};
console.log('  obj == obj:', obj == obj);
console.log('  {} == {}:', {} == {});

console.log('\næ¨è: ä¼˜å…ˆä½¿ç”¨ ===');</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 2ï¼š== çš„é™·é˜±</h3>
                <div class="code-block">
                    <pre><code>// == çš„ç±»å‹è½¬æ¢é™·é˜±
console.log('=== == çš„é™·é˜± ===\n');

console.log('1. ç©ºå­—ç¬¦ä¸²:');
console.log('  "" == 0:', '' == 0);
console.log('  "0" == 0:', '0' == 0);
console.log('  "" == "0":', '' == '0');
console.log('  ä¼ é€’æ€§å¤±æ•ˆï¼');

console.log('\n2. æ•°ç»„:');
console.log('  [] == ![]:', [] == ![]);
console.log('  [] == 0:', [] == 0);
console.log('  [""] == "":', [''] == '');

console.log('\n3. null:');
console.log('  null == 0:', null == 0);
console.log('  null == false:', null == false);
console.log('  null == undefined:', null == undefined);

console.log('\n4. åç›´è§‰:');
console.log('  [null] == "":', [null] == '');
console.log('  [undefined] == "":', [undefined] == '');
console.log('  0 == "\\n":', 0 == '\n');

console.log('\né¿å…: ä¸è¦ä¾èµ– == çš„éšå¼è½¬æ¢');</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 3ï¼šNaN çš„æ¯”è¾ƒ</h3>
                <div class="code-block">
                    <pre><code>// NaN çš„ç‰¹æ®Šæ€§
console.log('=== NaN æ¯”è¾ƒ ===\n');

console.log('1. === çš„è¡Œä¸º:');
console.log('  NaN === NaN:', NaN === NaN);
console.log('  NaN !== NaN:', NaN !== NaN);

console.log('\n2. == çš„è¡Œä¸º:');
console.log('  NaN == NaN:', NaN == NaN);

console.log('\n3. Object.is:');
console.log('  Object.is(NaN, NaN):', Object.is(NaN, NaN));

console.log('\n4. Number.isNaN:');
console.log('  Number.isNaN(NaN):', Number.isNaN(NaN));
console.log('  Number.isNaN("abc"):', Number.isNaN('abc'));

console.log('\n5. isNaNï¼ˆä¸æ¨èï¼‰:');
console.log('  isNaN(NaN):', isNaN(NaN));
console.log('  isNaN("abc"):', isNaN('abc'));
console.log('  ä¼šè¿›è¡Œç±»å‹è½¬æ¢');

console.log('\næ¨è: ä½¿ç”¨ Number.isNaN() æˆ– Object.is()');</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 4ï¼š+0 å’Œ -0</h3>
                <div class="code-block">
                    <pre><code>// +0 å’Œ -0 çš„æ¯”è¾ƒ
console.log('=== +0 å’Œ -0 ===\n');

console.log('1. === çš„è¡Œä¸º:');
console.log('  +0 === -0:', +0 === -0);

console.log('\n2. == çš„è¡Œä¸º:');
console.log('  +0 == -0:', +0 == -0);

console.log('\n3. Object.is:');
console.log('  Object.is(+0, -0):', Object.is(+0, -0));

console.log('\n4. åŒºåˆ†æ–¹æ³•:');
function isNegativeZero(value) {
    return value === 0 && 1 / value === -Infinity;
}
console.log('  isNegativeZero(+0):', isNegativeZero(+0));
console.log('  isNegativeZero(-0):', isNegativeZero(-0));

console.log('\n5. æ•°å­¦è¿ç®—:');
console.log('  1 / +0:', 1 / +0);
console.log('  1 / -0:', 1 / -0);

console.log('\nè¯´æ˜: === è®¤ä¸º +0 å’Œ -0 ç›¸ç­‰');
console.log('      Object.is è®¤ä¸ºå®ƒä»¬ä¸ç›¸ç­‰');</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 5ï¼šObject.is vs ===</h3>
                <div class="code-block">
                    <pre><code>// Object.is ä¸ === çš„å¯¹æ¯”
console.log('=== Object.is vs === ===\n');

console.log('1. æ™®é€šå€¼ï¼ˆç›¸åŒï¼‰:');
console.log('  1 === 1:', 1 === 1);
console.log('  Object.is(1, 1):', Object.is(1, 1));

console.log('\n2. NaNï¼ˆä¸åŒï¼‰:');
console.log('  NaN === NaN:', NaN === NaN);
console.log('  Object.is(NaN, NaN):', Object.is(NaN, NaN));

console.log('\n3. +0 å’Œ -0ï¼ˆä¸åŒï¼‰:');
console.log('  +0 === -0:', +0 === -0);
console.log('  Object.is(+0, -0):', Object.is(+0, -0));

console.log('\n4. å¯¹è±¡ï¼ˆç›¸åŒï¼‰:');
const obj = {};
console.log('  obj === obj:', obj === obj);
console.log('  Object.is(obj, obj):', Object.is(obj, obj));
console.log('  {} === {}:', {} === {});
console.log('  Object.is({}, {}):', Object.is({}, {}));

console.log('\næ€»ç»“:');
console.log('  Object.is æ›´"æ•°å­¦"');
console.log('  NaN ç­‰äº NaN');
console.log('  +0 ä¸ç­‰äº -0');</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 6ï¼šSameValueZero</h3>
                <div class="code-block">
                    <pre><code>// SameValueZero ç®—æ³•
console.log('=== SameValueZero ===\n');

console.log('1. Set ä½¿ç”¨ SameValueZero:');
const set = new Set();
set.add(NaN);
set.add(NaN);
console.log('  æ·»åŠ ä¸¤æ¬¡ NaNï¼Œsize:', set.size);

set.add(+0);
set.add(-0);
console.log('  æ·»åŠ  +0 å’Œ -0ï¼Œsize:', set.size);

console.log('\n2. includes vs indexOf:');
console.log('  [NaN].includes(NaN):', [NaN].includes(NaN));
console.log('  [NaN].indexOf(NaN):', [NaN].indexOf(NaN));

console.log('\n  [+0].includes(-0):', [+0].includes(-0));
console.log('  [+0].indexOf(-0):', [+0].indexOf(-0));

console.log('\n3. Map é”®æ¯”è¾ƒ:');
const map = new Map();
map.set(NaN, 'value1');
map.set(NaN, 'value2');
console.log('  è®¾ç½®ä¸¤æ¬¡ NaN é”®ï¼Œsize:', map.size);
console.log('  map.get(NaN):', map.get(NaN));

console.log('\nè¯´æ˜:');
console.log('  SameValueZero: NaN ç›¸ç­‰ï¼Œ+0 å’Œ -0 ç›¸ç­‰');
console.log('  ç”¨äº Setã€Mapã€includes ç­‰');</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
        </div>
    </div>
    
    <script src="../assets/js/common.js"></script>
</body>
</html>
