<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é—­åŒ…çš„å†…å­˜æ¨¡å‹ - JavaScript æ·±åº¦å­¦ä¹ </title>
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="../assets/css/page.css">
</head>
<body>
    <div class="page-layout">
        <div class="doc-panel">
            <h1>é—­åŒ…çš„å†…å­˜æ¨¡å‹</h1>
            
            <h2>æ¦‚è¿°</h2>
            <p>é—­åŒ…ï¼ˆClosureï¼‰æ˜¯ JavaScript æœ€å¼ºå¤§ä¹Ÿæœ€å®¹æ˜“è¯¯ç”¨çš„ç‰¹æ€§ä¹‹ä¸€ã€‚ç†è§£é—­åŒ…çš„å†…å­˜æ¨¡å‹å¯¹äºç¼–å†™é«˜æ•ˆã€æ— å†…å­˜æ³„æ¼çš„ä»£ç è‡³å…³é‡è¦ã€‚</p>
            
            <h2>ä¸€ã€ä»€ä¹ˆæ˜¯é—­åŒ…</h2>
            
            <h3>1.1 å®šä¹‰</h3>
            <div class="info">
                <p><strong>é—­åŒ… = å‡½æ•° + å‡½æ•°èƒ½å¤Ÿè®¿é—®çš„è‡ªç”±å˜é‡</strong></p>
                <p>ä»æŠ€æœ¯è§’åº¦è®²ï¼Œæ‰€æœ‰ JavaScript å‡½æ•°éƒ½æ˜¯é—­åŒ…ï¼Œå› ä¸ºå®ƒä»¬éƒ½åœ¨åˆ›å»ºæ—¶ä¿å­˜äº†ä¸Šå±‚ä½œç”¨åŸŸçš„å¼•ç”¨ã€‚</p>
            </div>
            
            <h3>1.2 ç»å…¸ç¤ºä¾‹</h3>
            <pre><code>function createCounter() {
    let count = 0;  // è‡ªç”±å˜é‡
    
    return function() {
        return ++count;
    };
}

const counter = createCounter();
console.log(counter());  // 1
console.log(counter());  // 2
console.log(counter());  // 3

// count å˜é‡åœ¨ createCounter æ‰§è¡Œå®Œåä»ç„¶å­˜åœ¨
// å› ä¸ºè¿”å›çš„å‡½æ•°ä¿æŒäº†å¯¹å®ƒçš„å¼•ç”¨</code></pre>
            
            <h2>äºŒã€é—­åŒ…çš„å†…å­˜ç»“æ„</h2>
            
            <h3>2.1 å†…å­˜åˆ†é…</h3>
            <pre><code>function outer() {
    var a = 1;
    var b = 2;
    var c = 3;
    
    return function inner() {
        console.log(a);  // åªä½¿ç”¨ a
    };
}

const fn = outer();

// å†…å­˜ä¸­çš„ç»“æ„ï¼š
// 1. fn å‡½æ•°å¯¹è±¡
// 2. fn.[[Scope]] æŒ‡å‘ outer çš„ä½œç”¨åŸŸ
// 3. outer çš„ä½œç”¨åŸŸåŒ…å« a, b, cï¼ˆå³ä½¿åªç”¨äº† aï¼‰
// 
// å†…å­˜å¸ƒå±€ï¼š
// +------------------+
// | fn (å‡½æ•°å¯¹è±¡)     |
// +------------------+
//        |
//        v
// +------------------+
// | [[Scope]]        |
// +------------------+
//        |
//        v
// +------------------+
// | outer ä½œç”¨åŸŸ     |
// | - a: 1          |
// | - b: 2          |
// | - c: 3          |
// +------------------+</code></pre>
            
            <h3>2.2 ä½œç”¨åŸŸé“¾ä¿æŒ</h3>
            <pre><code>function level1() {
    var v1 = 1;
    
    function level2() {
        var v2 = 2;
        
        function level3() {
            var v3 = 3;
            console.log(v1, v2, v3);
        }
        
        return level3;
    }
    
    return level2();
}

const fn = level1();

// fn.[[Scope]] = [level3VO, level2VO, level1VO, globalVO]
// æ•´ä¸ªä½œç”¨åŸŸé“¾éƒ½è¢«ä¿æŒåœ¨å†…å­˜ä¸­</code></pre>
            
            <h2>ä¸‰ã€é—­åŒ…ä¸åƒåœ¾å›æ”¶</h2>
            
            <h3>3.1 ä½•æ—¶å›æ”¶</h3>
            <pre><code>function createClosure() {
    var data = new Array(1000000);  // å¤§æ•°ç»„
    
    return function() {
        console.log(data.length);
    };
}

var closure = createClosure();
// data ä¸ä¼šè¢«å›æ”¶ï¼Œå› ä¸º closure å¼•ç”¨äº†å®ƒ

closure = null;  // è§£é™¤å¼•ç”¨
// ç°åœ¨ data å¯ä»¥è¢«å›æ”¶äº†</code></pre>
            
            <h3>3.2 åƒåœ¾å›æ”¶æ—¶æœº</h3>
            <pre><code>function outer() {
    var largeData = new Array(1000000);
    
    function inner1() {
        console.log(largeData.length);  // ä½¿ç”¨ largeData
    }
    
    function inner2() {
        console.log('No data');  // ä¸ä½¿ç”¨ largeData
    }
    
    return { inner1, inner2 };
}

const obj = outer();

// inner1 å’Œ inner2 éƒ½å¼•ç”¨åŒä¸€ä¸ªä½œç”¨åŸŸ
// largeData ä¸ä¼šè¢«å›æ”¶ï¼Œå³ä½¿ inner2 ä¸ä½¿ç”¨å®ƒ</code></pre>
            
            <h2>å››ã€å¸¸è§çš„é—­åŒ…åœºæ™¯</h2>
            
            <h3>4.1 æ¨¡å—æ¨¡å¼</h3>
            <pre><code>const Module = (function() {
    // ç§æœ‰å˜é‡
    let privateVar = 0;
    
    function privateMethod() {
        return 'Private';
    }
    
    // å…¬å…±æ¥å£
    return {
        publicMethod() {
            privateVar++;
            return privateMethod();
        },
        getCount() {
            return privateVar;
        }
    };
})();

Module.publicMethod();
console.log(Module.getCount());  // 1
console.log(Module.privateVar);  // undefinedï¼ˆç§æœ‰ï¼‰</code></pre>
            
            <h3>4.2 äº‹ä»¶å¤„ç†å™¨</h3>
            <pre><code>function setupButtons() {
    for (var i = 0; i < 3; i++) {
        (function(index) {
            document.getElementById('btn-' + index)
                .addEventListener('click', function() {
                    console.log('Button ' + index);  // é—­åŒ…æ•è· index
                });
        })(i);
    }
}

// æ¯ä¸ªäº‹ä»¶å¤„ç†å™¨éƒ½ä¿æŒå¯¹ index çš„å¼•ç”¨</code></pre>
            
            <h3>4.3 å‡½æ•°å·¥å‚</h3>
            <pre><code>function createMultiplier(multiplier) {
    return function(num) {
        return num * multiplier;
    };
}

const double = createMultiplier(2);
const triple = createMultiplier(3);

console.log(double(5));  // 10
console.log(triple(5));  // 15

// double å’Œ triple å„è‡ªä¿æŒå¯¹ä¸åŒ multiplier çš„å¼•ç”¨</code></pre>
            
            <h2>äº”ã€å†…å­˜æ³„æ¼åœºæ™¯</h2>
            
            <h3>5.1 æ„å¤–çš„å…¨å±€å˜é‡</h3>
            <pre><code>function createLeak() {
    // å¿˜è®° var/let/const
    leakedVar = 'I am global';  // æ„å¤–åˆ›å»ºå…¨å±€å˜é‡
    
    return function() {
        console.log(leakedVar);
    };
}

// leakedVar æ°¸è¿œä¸ä¼šè¢«å›æ”¶</code></pre>
            
            <h3>5.2 å¾ªç¯å¼•ç”¨</h3>
            <pre><code>function createCircular() {
    var obj1 = {};
    var obj2 = {};
    
    obj1.ref = obj2;
    obj2.ref = obj1;  // å¾ªç¯å¼•ç”¨
    
    return function() {
        console.log(obj1, obj2);
    };
}

// åœ¨è€ç‰ˆæœ¬ IE ä¸­å¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼
// ç°ä»£æµè§ˆå™¨çš„ GC å¯ä»¥å¤„ç†</code></pre>
            
            <h3>5.3 å®šæ—¶å™¨ä¸­çš„é—­åŒ…</h3>
            <pre><code>function startTimer() {
    var largeData = new Array(1000000);
    
    setInterval(function() {
        console.log(largeData.length);
    }, 1000);
    
    // largeData æ°¸è¿œä¸ä¼šè¢«å›æ”¶
    // å› ä¸ºå®šæ—¶å™¨ä¸€ç›´è¿è¡Œ
}

// è§£å†³æ–¹æ¡ˆï¼šæ¸…é™¤å®šæ—¶å™¨
function startTimerCorrect() {
    var largeData = new Array(1000000);
    
    var timer = setInterval(function() {
        console.log(largeData.length);
    }, 1000);
    
    // åœ¨é€‚å½“æ—¶æœºæ¸…é™¤
    setTimeout(function() {
        clearInterval(timer);
    }, 10000);
}</code></pre>
            
            <h3>5.4 DOM å¼•ç”¨</h3>
            <pre><code>function createDOMLeak() {
    var element = document.getElementById('myDiv');
    
    return function() {
        console.log(element.innerHTML);
    };
}

// å³ä½¿ DOM å…ƒç´ è¢«åˆ é™¤ï¼Œé—­åŒ…ä»ç„¶å¼•ç”¨å®ƒ
// å¯¼è‡´ DOM èŠ‚ç‚¹æ— æ³•å›æ”¶

// è§£å†³æ–¹æ¡ˆï¼š
function createDOMCorrect() {
    var element = document.getElementById('myDiv');
    var html = element.innerHTML;  // åªä¿å­˜éœ€è¦çš„æ•°æ®
    element = null;  // è§£é™¤ DOM å¼•ç”¨
    
    return function() {
        console.log(html);
    };
}</code></pre>
            
            <h2>å…­ã€é—­åŒ…ä¼˜åŒ–æŠ€å·§</h2>
            
            <h3>6.1 æœ€å°åŒ–é—­åŒ…ä½œç”¨åŸŸ</h3>
            <pre><code>// ä¸å¥½ âŒ
function bad() {
    var largeData1 = new Array(1000000);
    var largeData2 = new Array(1000000);
    var largeData3 = new Array(1000000);
    
    return function() {
        console.log(largeData1[0]);  // åªç”¨ largeData1
    };
    // ä½† largeData2, largeData3 ä¹Ÿè¢«ä¿æŒ
}

// å¥½ âœ…
function good() {
    var largeData1 = new Array(1000000);
    var data = largeData1[0];  // åªä¿å­˜éœ€è¦çš„
    
    return function() {
        console.log(data);
    };
    // largeData1 å¯ä»¥è¢«å›æ”¶
}</code></pre>
            
            <h3>6.2 åŠæ—¶è§£é™¤å¼•ç”¨</h3>
            <pre><code>var closures = [];

function createClosures() {
    for (let i = 0; i < 100; i++) {
        closures.push(function() {
            console.log(i);
        });
    }
}

createClosures();

// ä½¿ç”¨å®Œåæ¸…ç†
closures.forEach(fn => fn());
closures = null;  // è§£é™¤å¼•ç”¨</code></pre>
            
            <h3>6.3 ä½¿ç”¨ WeakMap/WeakSet</h3>
            <pre><code>// ä½¿ç”¨ WeakMap é¿å…å†…å­˜æ³„æ¼
const privateData = new WeakMap();

class MyClass {
    constructor() {
        privateData.set(this, {
            secret: 'private data'
        });
    }
    
    getSecret() {
        return privateData.get(this).secret;
    }
}

let obj = new MyClass();
console.log(obj.getSecret());

obj = null;  // privateData ä¸­çš„æ•°æ®ä¼šè¢«è‡ªåŠ¨å›æ”¶</code></pre>
            
            <h2>ä¸ƒã€è°ƒè¯•é—­åŒ…</h2>
            
            <h3>7.1 æ£€æŸ¥ä½œç”¨åŸŸ</h3>
            <pre><code>function outer() {
    var a = 1;
    
    function inner() {
        debugger;  // åœ¨æ­¤å¤„æ–­ç‚¹
        console.log(a);
    }
    
    return inner;
}

// åœ¨å¼€å‘è€…å·¥å…·ä¸­å¯ä»¥æŸ¥çœ‹ï¼š
// - Scope Chain
// - Closure å˜é‡
// - å†…å­˜å ç”¨</code></pre>
            
            <h3>7.2 ä½¿ç”¨æ€§èƒ½åˆ†æå·¥å…·</h3>
            <pre><code>// Chrome DevTools:
// 1. Memory > Take Heap Snapshot
// 2. æŸ¥æ‰¾ closure å…³é”®å­—
// 3. åˆ†æé—­åŒ…å ç”¨çš„å†…å­˜
// 4. å¯¹æ¯”å¤šæ¬¡å¿«ç…§ï¼Œæ‰¾å‡ºå†…å­˜å¢é•¿</code></pre>
            
            <h2>å…«ã€æœ€ä½³å®è·µ</h2>
            
            <div class="tip">
                <ol>
                    <li><strong>ç†è§£é—­åŒ…åŸç†</strong>ï¼šçŸ¥é“ä»€ä¹ˆæ—¶å€™åˆ›å»ºé—­åŒ…</li>
                    <li><strong>æœ€å°åŒ–ä½œç”¨åŸŸ</strong>ï¼šåªä¿ç•™å¿…è¦çš„å˜é‡</li>
                    <li><strong>åŠæ—¶è§£é™¤å¼•ç”¨</strong>ï¼šä¸ç”¨çš„é—­åŒ…è®¾ä¸º null</li>
                    <li><strong>é¿å…å¾ªç¯å¼•ç”¨</strong>ï¼šç‰¹åˆ«æ˜¯ DOM å¼•ç”¨</li>
                    <li><strong>æ¸…é™¤å®šæ—¶å™¨</strong>ï¼šé¿å…é•¿æœŸè¿è¡Œçš„é—­åŒ…</li>
                    <li><strong>ä½¿ç”¨å¼±å¼•ç”¨</strong>ï¼šWeakMap/WeakSet</li>
                    <li><strong>å®šæœŸæ£€æµ‹</strong>ï¼šä½¿ç”¨å¼€å‘è€…å·¥å…·ç›‘æ§</li>
                </ol>
            </div>
            
            <h2>å‚è€ƒèµ„æ–™</h2>
            <ul>
                <li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Closures" target="_blank">MDN - é—­åŒ…</a></li>
                <li><a href="https://v8.dev/blog/trash-talk" target="_blank">V8 - Trash talk (GC)</a></li>
            </ul>
            
            <div class="nav-links">
                <a href="14-scope-chain.html" class="nav-link prev">ä¸Šä¸€èŠ‚ï¼šä½œç”¨åŸŸé“¾</a>
                <a href="../index.html" class="nav-link home">è¿”å›é¦–é¡µ</a>
                <a href="15-prototype-chain.html" class="nav-link next">ä¸‹ä¸€èŠ‚ï¼šåŸå‹é“¾å®ç°</a>
            </div>
        </div>
        
        <div class="code-panel">
            <h2 style="color: #60a5fa; margin-bottom: 1.5rem;">ğŸ’» äº¤äº’å¼ä»£ç ç¤ºä¾‹</h2>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 1ï¼šåŸºæœ¬é—­åŒ…</h3>
                <div class="code-block">
                    <pre><code>// é—­åŒ…åŸºç¡€ç¤ºä¾‹
console.log('=== åŸºæœ¬é—­åŒ… ===\n');

function createCounter() {
    let count = 0;  // ç§æœ‰å˜é‡
    
    return function() {
        return ++count;
    };
}

const counter1 = createCounter();
const counter2 = createCounter();

console.log('counter1:');
console.log('  ç¬¬1æ¬¡è°ƒç”¨:', counter1());  // 1
console.log('  ç¬¬2æ¬¡è°ƒç”¨:', counter1());  // 2
console.log('  ç¬¬3æ¬¡è°ƒç”¨:', counter1());  // 3

console.log('\ncounter2ï¼ˆç‹¬ç«‹ï¼‰:');
console.log('  ç¬¬1æ¬¡è°ƒç”¨:', counter2());  // 1
console.log('  ç¬¬2æ¬¡è°ƒç”¨:', counter2());  // 2

console.log('\næ¯ä¸ªé—­åŒ…éƒ½æœ‰ç‹¬ç«‹çš„ count å˜é‡');</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 2ï¼šé—­åŒ…çš„å†…å­˜ç»“æ„</h3>
                <div class="code-block">
                    <pre><code>// é—­åŒ…å†…å­˜ç»“æ„æ¼”ç¤º
console.log('=== é—­åŒ…å†…å­˜ç»“æ„ ===\n');

function outer() {
    var a = 1;
    var b = 2;
    var c = 3;
    
    console.log('outer åˆ›å»ºäº†å˜é‡: a, b, c');
    
    return function inner() {
        console.log('inner åªä½¿ç”¨ a:', a);
        // ä½† b, c ä¹Ÿåœ¨é—­åŒ…ä½œç”¨åŸŸä¸­
    };
}

const fn = outer();
console.log('\nouter æ‰§è¡Œå®Œæ¯•');
console.log('ä½† fn ä»ç„¶ä¿æŒå¯¹ outer ä½œç”¨åŸŸçš„å¼•ç”¨');
console.log('åŒ…æ‹¬æœªä½¿ç”¨çš„ b, c');

console.log('\nè°ƒç”¨ fn:');
fn();

console.log('\nå†…å­˜ä¸­ä¿å­˜:');
console.log('  - fn å‡½æ•°å¯¹è±¡');
console.log('  - fn.[[Scope]] â†’ outer ä½œç”¨åŸŸ');
console.log('  - outer ä½œç”¨åŸŸåŒ…å« a, b, c');</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 3ï¼šå¾ªç¯ä¸­çš„é—­åŒ…é™·é˜±</h3>
                <div class="code-block">
                    <pre><code>// å¾ªç¯ä¸­çš„é—­åŒ…é—®é¢˜
console.log('=== å¾ªç¯é—­åŒ…é™·é˜± ===\n');

console.log('é—®é¢˜: ä½¿ç”¨ var');
var funcs1 = [];
for (var i = 0; i < 3; i++) {
    funcs1.push(function() {
        return i;
    });
}
console.log('è¾“å‡º:', funcs1.map(f => f()));  // [3, 3, 3]
console.log('åŸå› : æ‰€æœ‰å‡½æ•°å…±äº«åŒä¸€ä¸ª i\n');

console.log('è§£å†³æ–¹æ¡ˆ1: IIFE');
var funcs2 = [];
for (var i = 0; i < 3; i++) {
    funcs2.push((function(index) {
        return function() {
            return index;
        };
    })(i));
}
console.log('è¾“å‡º:', funcs2.map(f => f()));  // [0, 1, 2]

console.log('\nè§£å†³æ–¹æ¡ˆ2: let');
var funcs3 = [];
for (let i = 0; i < 3; i++) {
    funcs3.push(function() {
        return i;
    });
}
console.log('è¾“å‡º:', funcs3.map(f => f()));  // [0, 1, 2]</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 4ï¼šæ¨¡å—æ¨¡å¼</h3>
                <div class="code-block">
                    <pre><code>// ä½¿ç”¨é—­åŒ…å®ç°æ¨¡å—æ¨¡å¼
console.log('=== æ¨¡å—æ¨¡å¼ ===\n');

const Calculator = (function() {
    // ç§æœ‰å˜é‡
    let history = [];
    
    // ç§æœ‰æ–¹æ³•
    function log(operation, result) {
        history.push({ operation, result, time: Date.now() });
    }
    
    // å…¬å…±æ¥å£
    return {
        add(a, b) {
            const result = a + b;
            log(`${a} + ${b}`, result);
            return result;
        },
        
        subtract(a, b) {
            const result = a - b;
            log(`${a} - ${b}`, result);
            return result;
        },
        
        getHistory() {
            return history.map(h => 
                `${h.operation} = ${h.result}`
            );
        }
    };
})();

console.log('10 + 5 =', Calculator.add(10, 5));
console.log('10 - 5 =', Calculator.subtract(10, 5));
console.log('\nå†å²è®°å½•:');
Calculator.getHistory().forEach(h => console.log('  ' + h));

console.log('\nç§æœ‰å˜é‡æ— æ³•ç›´æ¥è®¿é—®:');
console.log('  history:', typeof Calculator.history);  // undefined</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 5ï¼šå†…å­˜æ³„æ¼ç¤ºä¾‹</h3>
                <div class="code-block">
                    <pre><code>// å†…å­˜æ³„æ¼åœºæ™¯æ¼”ç¤º
console.log('=== å†…å­˜æ³„æ¼åœºæ™¯ ===\n');

console.log('åœºæ™¯1: æœªä½¿ç”¨çš„å˜é‡');
function createLeak1() {
    var unused = new Array(1000);  // å¤§æ•°ç»„
    var used = 1;
    
    return function() {
        return used;  // åªç”¨ used
    };
    // ä½† unused ä¹Ÿåœ¨é—­åŒ…ä¸­ï¼Œæ— æ³•å›æ”¶
}
const fn1 = createLeak1();
console.log('è¿”å›å‡½æ•°ä¿æŒäº† unused çš„å¼•ç”¨');

console.log('\nåœºæ™¯2: å®šæ—¶å™¨');
let timerId;
function createLeak2() {
    var data = new Array(1000);
    
    timerId = setInterval(() => {
        console.log('  Timer:', data.length);
    }, 1000);
    
    // data æ°¸è¿œä¸ä¼šè¢«å›æ”¶
}
// createLeak2();  // å–æ¶ˆæ³¨é‡Šä¼šå¯åŠ¨å®šæ—¶å™¨

console.log('å®šæ—¶å™¨æŒç»­å¼•ç”¨ data');

console.log('\nè§£å†³æ–¹æ¡ˆ:');
console.log('1. æœ€å°åŒ–é—­åŒ…ä½œç”¨åŸŸ');
console.log('2. åŠæ—¶æ¸…é™¤å®šæ—¶å™¨');
console.log('3. è§£é™¤ä¸éœ€è¦çš„å¼•ç”¨');</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 6ï¼šé—­åŒ…ä¼˜åŒ–</h3>
                <div class="code-block">
                    <pre><code>// é—­åŒ…ä¼˜åŒ–æŠ€å·§
console.log('=== é—­åŒ…ä¼˜åŒ– ===\n');

console.log('ä¼˜åŒ–å‰:');
function createBad() {
    var largeArray = new Array(1000000).fill(1);
    var largeObject = { data: new Array(1000000) };
    var smallValue = 42;
    
    return function() {
        return smallValue;  // åªç”¨ smallValue
    };
    // ä½† largeArray å’Œ largeObject ä¹Ÿåœ¨é—­åŒ…ä¸­
}
const bad = createBad();
console.log('  ä¿æŒäº†æ‰€æœ‰å˜é‡çš„å¼•ç”¨');
console.log('  åŒ…æ‹¬æœªä½¿ç”¨çš„å¤§å¯¹è±¡\n');

console.log('ä¼˜åŒ–å:');
function createGood() {
    var largeArray = new Array(1000000).fill(1);
    var largeObject = { data: new Array(1000000) };
    var smallValue = 42;
    
    // æå–éœ€è¦çš„å€¼
    var value = smallValue;
    
    // æ¸…é™¤å¤§å¯¹è±¡å¼•ç”¨
    largeArray = null;
    largeObject = null;
    
    return function() {
        return value;
    };
}
const good = createGood();
console.log('  åªä¿æŒå¿…è¦çš„å¼•ç”¨');
console.log('  å¤§å¯¹è±¡å¯ä»¥è¢«å›æ”¶\n');

console.log('ä¼˜åŒ–æ•ˆæœ:');
console.log('  âœ“ å‡å°‘å†…å­˜å ç”¨');
console.log('  âœ“ æé«˜ GC æ•ˆç‡');
console.log('  âœ“ é¿å…å†…å­˜æ³„æ¼');</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
        </div>
    </div>
    
    <script src="../assets/js/common.js"></script>
</body>
</html>
