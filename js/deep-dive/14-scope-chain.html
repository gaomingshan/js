<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä½œç”¨åŸŸé“¾çš„æœ¬è´¨ - JavaScript æ·±åº¦å­¦ä¹ </title>
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="../assets/css/page.css">
</head>
<body>
    <div class="page-layout">
        <div class="doc-panel">
            <h1>ä½œç”¨åŸŸé“¾çš„æœ¬è´¨</h1>
            
            <h2>æ¦‚è¿°</h2>
            <p>ä½œç”¨åŸŸé“¾ï¼ˆScope Chainï¼‰æ˜¯ JavaScript æŸ¥æ‰¾å˜é‡çš„æœºåˆ¶ï¼Œå®ƒå†³å®šäº†å˜é‡å’Œå‡½æ•°çš„å¯è®¿é—®æ€§ã€‚ç†è§£ä½œç”¨åŸŸé“¾æ˜¯æŒæ¡é—­åŒ…ã€å˜é‡æŸ¥æ‰¾çš„å…³é”®ã€‚</p>
            
            <h2>ä¸€ã€ä½œç”¨åŸŸåŸºç¡€</h2>
            
            <h3>1.1 ä½œç”¨åŸŸç±»å‹</h3>
            <div class="info">
                <ul>
                    <li><strong>å…¨å±€ä½œç”¨åŸŸ</strong>ï¼šåœ¨ä»£ç ä»»ä½•åœ°æ–¹éƒ½èƒ½è®¿é—®</li>
                    <li><strong>å‡½æ•°ä½œç”¨åŸŸ</strong>ï¼šå‡½æ•°å†…éƒ¨å¯è®¿é—®</li>
                    <li><strong>å—çº§ä½œç”¨åŸŸ</strong>ï¼š{} å†…éƒ¨å¯è®¿é—®ï¼ˆES6+ let/constï¼‰</li>
                </ul>
            </div>
            
            <h3>1.2 è¯æ³•ä½œç”¨åŸŸ</h3>
            <pre><code>// JavaScript ä½¿ç”¨è¯æ³•ä½œç”¨åŸŸï¼ˆé™æ€ä½œç”¨åŸŸï¼‰
// ä½œç”¨åŸŸåœ¨å‡½æ•°å®šä¹‰æ—¶ç¡®å®šï¼Œè€Œä¸æ˜¯è°ƒç”¨æ—¶

var value = 1;

function foo() {
    console.log(value);
}

function bar() {
    var value = 2;
    foo();  // è¾“å‡º 1ï¼Œè€Œä¸æ˜¯ 2
}

bar();

// åŸå› ï¼šfoo å®šä¹‰åœ¨å…¨å±€ï¼Œå®ƒçš„ä½œç”¨åŸŸé“¾åœ¨å®šä¹‰æ—¶ç¡®å®š
// foo çš„ä½œç”¨åŸŸé“¾ï¼š[fooä½œç”¨åŸŸ, å…¨å±€ä½œç”¨åŸŸ]</code></pre>
            
            <h2>äºŒã€ä½œç”¨åŸŸé“¾çš„æ„æˆ</h2>
            
            <h3>2.1 ä½œç”¨åŸŸé“¾ç»“æ„</h3>
            <pre><code>// ä½œç”¨åŸŸé“¾æ˜¯ä¸€ä¸ªå¯¹è±¡åˆ—è¡¨
ScopeChain = [
    å½“å‰æ‰§è¡Œä¸Šä¸‹æ–‡çš„å˜é‡å¯¹è±¡,
    å¤–å±‚å‡½æ•°çš„å˜é‡å¯¹è±¡,
    ...,
    å…¨å±€å˜é‡å¯¹è±¡
]

// ç¤ºä¾‹
var global = 'Global';

function outer() {
    var outerVar = 'Outer';
    
    function inner() {
        var innerVar = 'Inner';
        console.log(innerVar, outerVar, global);
    }
    
    inner();
}

// inner å‡½æ•°çš„ä½œç”¨åŸŸé“¾ï¼š
// [innerVO, outerVO, globalVO]</code></pre>
            
            <h3>2.2 [[Scope]] å±æ€§</h3>
            <pre><code>// å‡½æ•°åˆ›å»ºæ—¶ï¼Œä¼šä¿å­˜çˆ¶çº§ä½œç”¨åŸŸåˆ°å†…éƒ¨å±æ€§ [[Scope]]
function createFunction() {
    var localVar = 'local';
    
    function innerFunc() {
        console.log(localVar);
    }
    
    return innerFunc;
}

const fn = createFunction();

// fn.[[Scope]] = [createFunctionVO, globalVO]
// å³ä½¿ createFunction æ‰§è¡Œå®Œæ¯•ï¼Œfn ä»ç„¶å¯ä»¥è®¿é—® localVar</code></pre>
            
            <h2>ä¸‰ã€ä½œç”¨åŸŸé“¾çš„åˆ›å»ºè¿‡ç¨‹</h2>
            
            <h3>3.1 å‡½æ•°åˆ›å»º</h3>
            <pre><code>// 1. å‡½æ•°åˆ›å»ºæ—¶
function foo() {
    var a = 1;
}

// ä¿å­˜çˆ¶çº§ä½œç”¨åŸŸé“¾
foo.[[Scope]] = [
    globalContext.VO  // å…¨å±€å˜é‡å¯¹è±¡
];</code></pre>
            
            <h3>3.2 å‡½æ•°æ‰§è¡Œ</h3>
            <pre><code>// 2. å‡½æ•°æ‰§è¡Œæ—¶
foo();

// åˆ›å»ºæ‰§è¡Œä¸Šä¸‹æ–‡
fooContext = {
    AO: {
        arguments: {...},
        a: undefined
    },
    Scope: foo.[[Scope]]  // å¤åˆ¶
}

// 3. å°† AO æ·»åŠ åˆ°ä½œç”¨åŸŸé“¾å‰ç«¯
fooContext.Scope = [fooContext.AO].concat(foo.[[Scope]]);
// ç»“æœï¼š[fooAO, globalVO]</code></pre>
            
            <h3>3.3 å®Œæ•´æµç¨‹</h3>
            <pre><code>var x = 10;

function outer(y) {
    var z = 20;
    
    function inner(w) {
        var v = 30;
        console.log(x, y, z, w, v);
    }
    
    return inner;
}

const fn = outer(15);
fn(25);

// æ‰§è¡Œæµç¨‹ï¼š
// 1. åˆ›å»º outer å‡½æ•°
outer.[[Scope]] = [globalVO]

// 2. æ‰§è¡Œ outer(15)
outerContext.Scope = [outerAO, globalVO]
outerAO = { y: 15, z: 20, inner: function }

// 3. åˆ›å»º inner å‡½æ•°
inner.[[Scope]] = outerContext.Scope
// = [outerAO, globalVO]

// 4. æ‰§è¡Œ inner(25)
innerContext.Scope = [innerAO, outerAO, globalVO]
innerAO = { w: 25, v: 30 }</code></pre>
            
            <h2>å››ã€å˜é‡æŸ¥æ‰¾æœºåˆ¶</h2>
            
            <h3>4.1 æŸ¥æ‰¾è¿‡ç¨‹</h3>
            <pre><code>var a = 1;

function foo() {
    var b = 2;
    
    function bar() {
        var c = 3;
        console.log(a + b + c);
    }
    
    bar();
}

foo();

// bar ä¸­è®¿é—®å˜é‡çš„æŸ¥æ‰¾è¿‡ç¨‹ï¼š
// 1. æŸ¥æ‰¾ cï¼šåœ¨ barAO ä¸­æ‰¾åˆ° âœ“
// 2. æŸ¥æ‰¾ bï¼šåœ¨ barAO ä¸­æ²¡æ‰¾åˆ°ï¼Œå» fooAO æ‰¾åˆ° âœ“
// 3. æŸ¥æ‰¾ aï¼šåœ¨ barAOã€fooAO éƒ½æ²¡æ‰¾åˆ°ï¼Œå» globalVO æ‰¾åˆ° âœ“

// ä½œç”¨åŸŸé“¾ï¼š[barAO, fooAO, globalVO]</code></pre>
            
            <h3>4.2 æ€§èƒ½ä¼˜åŒ–</h3>
            <pre><code>// ä½œç”¨åŸŸé“¾è¶Šé•¿ï¼ŒæŸ¥æ‰¾è¶Šæ…¢
function level1() {
    var a = 1;
    function level2() {
        var b = 2;
        function level3() {
            var c = 3;
            function level4() {
                var d = 4;
                function level5() {
                    // è®¿é—® a éœ€è¦éå†æ•´ä¸ªä½œç”¨åŸŸé“¾
                    console.log(a);  // æ…¢
                    console.log(d);  // è¾ƒå¿«ï¼ˆæ›´è¿‘ï¼‰
                }
            }
        }
    }
}

// ä¼˜åŒ–ï¼šç¼“å­˜å¤–å±‚å˜é‡
function optimized() {
    var globalVar = window.someGlobalVar;  // ç¼“å­˜
    for (let i = 0; i < 1000; i++) {
        console.log(globalVar);  // å¿«
    }
}</code></pre>
            
            <h2>äº”ã€å—çº§ä½œç”¨åŸŸ</h2>
            
            <h3>5.1 let/const å—çº§ä½œç”¨åŸŸ</h3>
            <pre><code>// var æ²¡æœ‰å—çº§ä½œç”¨åŸŸ
{
    var x = 1;
}
console.log(x);  // 1

// let/const æœ‰å—çº§ä½œç”¨åŸŸ
{
    let y = 2;
    const z = 3;
}
console.log(y);  // ReferenceError
console.log(z);  // ReferenceError</code></pre>
            
            <h3>5.2 for å¾ªç¯ä¸­çš„å—çº§ä½œç”¨åŸŸ</h3>
            <pre><code>// var çš„é—®é¢˜
for (var i = 0; i < 3; i++) {
    setTimeout(() => console.log(i), 100);
}
// è¾“å‡ºï¼š3, 3, 3ï¼ˆå…±äº«åŒä¸€ä¸ª iï¼‰

// let çš„è§£å†³
for (let i = 0; i < 3; i++) {
    setTimeout(() => console.log(i), 100);
}
// è¾“å‡ºï¼š0, 1, 2ï¼ˆæ¯æ¬¡è¿­ä»£éƒ½æœ‰ç‹¬ç«‹çš„ iï¼‰

// åŸç†ï¼šæ¯æ¬¡è¿­ä»£éƒ½åˆ›å»ºæ–°çš„å—çº§ä½œç”¨åŸŸ</code></pre>
            
            <h3>5.3 æš‚æ—¶æ€§æ­»åŒºï¼ˆTDZï¼‰</h3>
            <pre><code>// let/const çš„æš‚æ—¶æ€§æ­»åŒº
{
    // TDZ å¼€å§‹
    console.log(x);  // ReferenceError
    
    let x = 10;      // TDZ ç»“æŸ
    console.log(x);  // 10
}

// åŸå› ï¼šlet/const åœ¨å£°æ˜å‰ä¸èƒ½è®¿é—®
// å³ä½¿å¤–å±‚æœ‰åŒåå˜é‡
var x = 1;
{
    console.log(x);  // ReferenceErrorï¼ˆä¸æ˜¯ 1ï¼‰
    let x = 2;
}</code></pre>
            
            <h2>å…­ã€ä½œç”¨åŸŸä¸é—­åŒ…</h2>
            
            <h3>6.1 é—­åŒ…çš„æœ¬è´¨</h3>
            <pre><code>// é—­åŒ… = å‡½æ•° + ä½œç”¨åŸŸé“¾
function createCounter() {
    let count = 0;
    
    return function() {
        return ++count;
    };
}

const counter = createCounter();

// counter.[[Scope]] = [createCounterAO, globalVO]
// createCounterAO åŒ…å« count
// å³ä½¿ createCounter æ‰§è¡Œå®Œï¼Œcount ä»ç„¶å­˜åœ¨</code></pre>
            
            <h3>6.2 é—­åŒ…ä¸ä½œç”¨åŸŸé“¾</h3>
            <pre><code>function outer() {
    var a = 1;
    var b = 2;
    var c = 3;
    
    return function inner() {
        console.log(a);  // åªä½¿ç”¨ a
    };
}

const fn = inner();

// fn.[[Scope]] = [outerAO, globalVO]
// outerAO åŒ…å« a, b, cï¼ˆå³ä½¿åªç”¨äº† aï¼‰
// è¿™æ˜¯å†…å­˜æ³„æ¼çš„ä¸€ä¸ªæ¥æº</code></pre>
            
            <h2>ä¸ƒã€ä½œç”¨åŸŸé“¾ä¼˜åŒ–</h2>
            
            <h3>7.1 é¿å…æ·±å±‚åµŒå¥—</h3>
            <pre><code>// ä¸å¥½ âŒ
function deep() {
    function level2() {
        function level3() {
            function level4() {
                // ä½œç”¨åŸŸé“¾å¤ªé•¿
            }
        }
    }
}

// å¥½ âœ…
function shallow() {
    // æ‰å¹³åŒ–ç»“æ„
}

function helper1() {
    // ç‹¬ç«‹å‡½æ•°
}

function helper2() {
    // ç‹¬ç«‹å‡½æ•°
}</code></pre>
            
            <h3>7.2 ç¼“å­˜ä½œç”¨åŸŸé“¾æŸ¥æ‰¾</h3>
            <pre><code>// ä¸å¥½ âŒ
function process() {
    for (let i = 0; i < 1000; i++) {
        document.getElementById('result').innerHTML += i;
        // æ¯æ¬¡éƒ½æŸ¥æ‰¾ document å’Œ getElementById
    }
}

// å¥½ âœ…
function processOptimized() {
    const element = document.getElementById('result');
    let html = '';
    for (let i = 0; i < 1000; i++) {
        html += i;
    }
    element.innerHTML = html;
}</code></pre>
            
            <h3>7.3 with å’Œ eval çš„é—®é¢˜</h3>
            <pre><code>// é¿å…ä½¿ç”¨ withï¼ˆç ´åä½œç”¨åŸŸé“¾ï¼‰
var obj = { x: 1 };
with (obj) {
    console.log(x);  // éš¾ä»¥ä¼˜åŒ–
}

// é¿å…ä½¿ç”¨ evalï¼ˆåŠ¨æ€ä½œç”¨åŸŸï¼‰
eval('var x = 1;');  // æ±¡æŸ“ä½œç”¨åŸŸ</code></pre>
            
            <h2>å…«ã€æœ€ä½³å®è·µ</h2>
            
            <div class="tip">
                <ol>
                    <li><strong>ä¼˜å…ˆä½¿ç”¨ let/const</strong>ï¼šå—çº§ä½œç”¨åŸŸæ›´æ¸…æ™°</li>
                    <li><strong>é¿å…å…¨å±€å˜é‡</strong>ï¼šå‡å°‘ä½œç”¨åŸŸé“¾æŸ¥æ‰¾</li>
                    <li><strong>ç¼“å­˜å¤–å±‚å˜é‡</strong>ï¼šæé«˜è®¿é—®æ•ˆç‡</li>
                    <li><strong>é¿å…æ·±å±‚åµŒå¥—</strong>ï¼šå‡å°‘ä½œç”¨åŸŸé“¾é•¿åº¦</li>
                    <li><strong>åŠæ—¶é‡Šæ”¾é—­åŒ…</strong>ï¼šé¿å…å†…å­˜æ³„æ¼</li>
                    <li><strong>ä¸ç”¨ with/eval</strong>ï¼šå½±å“ä¼˜åŒ–å’Œæ€§èƒ½</li>
                </ol>
            </div>
            
            <h2>å‚è€ƒèµ„æ–™</h2>
            <ul>
                <li><a href="https://tc39.es/ecma262/#sec-lexical-environments" target="_blank">ECMAScript - Lexical Environments</a></li>
                <li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Closures" target="_blank">MDN - é—­åŒ…</a></li>
            </ul>
            
            <div class="nav-links">
                <a href="14-execution-context.html" class="nav-link prev">ä¸Šä¸€èŠ‚ï¼šæ‰§è¡Œä¸Šä¸‹æ–‡</a>
                <a href="../index.html" class="nav-link home">è¿”å›é¦–é¡µ</a>
                <a href="14-closure-memory.html" class="nav-link next">ä¸‹ä¸€èŠ‚ï¼šé—­åŒ…å†…å­˜æ¨¡å‹</a>
            </div>
        </div>
        
        <div class="code-panel">
            <h2 style="color: #60a5fa; margin-bottom: 1.5rem;">ğŸ’» äº¤äº’å¼ä»£ç ç¤ºä¾‹</h2>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 1ï¼šè¯æ³•ä½œç”¨åŸŸ</h3>
                <div class="code-block">
                    <pre><code>// è¯æ³•ä½œç”¨åŸŸæ¼”ç¤º
console.log('=== è¯æ³•ä½œç”¨åŸŸ ===\n');

var value = 'Global';

function foo() {
    console.log('foo è®¿é—® value:', value);
}

function bar() {
    var value = 'Bar Local';
    console.log('bar çš„ value:', value);
    foo();  // foo è¾“å‡ºä»€ä¹ˆï¼Ÿ
}

console.log('æ‰§è¡Œ bar():');
bar();

console.log('\nç»“è®º:');
console.log('  foo è¾“å‡º "Global"ï¼Œè€Œä¸æ˜¯ "Bar Local"');
console.log('  åŸå› : foo å®šä¹‰åœ¨å…¨å±€ï¼Œä½œç”¨åŸŸåœ¨å®šä¹‰æ—¶ç¡®å®š');
console.log('  foo çš„ä½œç”¨åŸŸé“¾: [fooVO, globalVO]');</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 2ï¼šä½œç”¨åŸŸé“¾æ„å»º</h3>
                <div class="code-block">
                    <pre><code>// ä½œç”¨åŸŸé“¾æ„å»ºè¿‡ç¨‹
console.log('=== ä½œç”¨åŸŸé“¾æ„å»º ===\n');

var global = 'Global';

function outer(outerParam) {
    var outerVar = 'Outer';
    
    console.log('outer ä½œç”¨åŸŸé“¾:');
    console.log('  [outerVO, globalVO]');
    console.log('  å¯è®¿é—®: global, outerParam, outerVar\n');
    
    function inner(innerParam) {
        var innerVar = 'Inner';
        
        console.log('inner ä½œç”¨åŸŸé“¾:');
        console.log('  [innerVO, outerVO, globalVO]');
        console.log('  å¯è®¿é—®: global, outerParam, outerVar,');
        console.log('          innerParam, innerVar\n');
        
        console.log('è®¿é—®å˜é‡:');
        console.log('  global:', global);
        console.log('  outerParam:', outerParam);
        console.log('  outerVar:', outerVar);
        console.log('  innerParam:', innerParam);
        console.log('  innerVar:', innerVar);
    }
    
    inner('InnerArg');
}

outer('OuterArg');</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 3ï¼šå˜é‡æŸ¥æ‰¾è¿‡ç¨‹</h3>
                <div class="code-block">
                    <pre><code>// å˜é‡æŸ¥æ‰¾è¿‡ç¨‹æ¨¡æ‹Ÿ
console.log('=== å˜é‡æŸ¥æ‰¾ ===\n');

const scopeChain = [
    { name: 'innerVO', vars: { c: 3 } },
    { name: 'outerVO', vars: { b: 2 } },
    { name: 'globalVO', vars: { a: 1 } }
];

function findVariable(varName) {
    console.log(`æŸ¥æ‰¾å˜é‡ "${varName}":`);
    
    for (let i = 0; i < scopeChain.length; i++) {
        const scope = scopeChain[i];
        console.log(`  ${i + 1}. åœ¨ ${scope.name} ä¸­æŸ¥æ‰¾...`);
        
        if (varName in scope.vars) {
            console.log(`     âœ“ æ‰¾åˆ°! å€¼ä¸º ${scope.vars[varName]}`);
            return scope.vars[varName];
        } else {
            console.log(`     âœ— æœªæ‰¾åˆ°`);
        }
    }
    
    console.log(`     Ã— ReferenceError: ${varName} is not defined`);
    return undefined;
}

findVariable('c');
console.log('');
findVariable('b');
console.log('');
findVariable('a');
console.log('');
findVariable('d');</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 4ï¼šå—çº§ä½œç”¨åŸŸ</h3>
                <div class="code-block">
                    <pre><code>// å—çº§ä½œç”¨åŸŸæ¼”ç¤º
console.log('=== å—çº§ä½œç”¨åŸŸ ===\n');

console.log('1. var æ²¡æœ‰å—çº§ä½œç”¨åŸŸ:');
{
    var x = 1;
    console.log('  å—å†… x:', x);
}
console.log('  å—å¤– x:', x);  // ä»ç„¶å¯è®¿é—®

console.log('\n2. let/const æœ‰å—çº§ä½œç”¨åŸŸ:');
{
    let y = 2;
    const z = 3;
    console.log('  å—å†… y:', y, 'z:', z);
}
try {
    console.log('  å—å¤– y:', y);
} catch(e) {
    console.log('  å—å¤– y: ReferenceError');
}

console.log('\n3. for å¾ªç¯ä¸­çš„å·®å¼‚:');
console.log('  var ç‰ˆæœ¬:');
for (var i = 0; i < 3; i++) {
    setTimeout(() => console.log('    i:', i), 0);
}

setTimeout(() => {
    console.log('\n  let ç‰ˆæœ¬:');
    for (let j = 0; j < 3; j++) {
        setTimeout(() => console.log('    j:', j), 0);
    }
}, 100);</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 5ï¼šæš‚æ—¶æ€§æ­»åŒº</h3>
                <div class="code-block">
                    <pre><code>// æš‚æ—¶æ€§æ­»åŒºï¼ˆTDZï¼‰æ¼”ç¤º
console.log('=== æš‚æ—¶æ€§æ­»åŒº ===\n');

console.log('1. var çš„è¡Œä¸ºï¼ˆæå‡ï¼‰:');
console.log('  è®¿é—® a:', typeof a);  // undefined
var a = 1;
console.log('  èµ‹å€¼å a:', a);

console.log('\n2. let çš„ TDZ:');
try {
    console.log('  è®¿é—® b:', b);  // ReferenceError
    let b = 2;
} catch(e) {
    console.log('  é”™è¯¯:', e.message);
}
let b = 2;
console.log('  å£°æ˜å b:', b);

console.log('\n3. å¤–å±‚å˜é‡ä¸å½±å“ TDZ:');
var x = 'outer';
{
    console.log('  å—å¤– x:', 'outer');
    try {
        console.log('  å—å†…è®¿é—® x:', x);
        let x = 'inner';  // TDZ
    } catch(e) {
        console.log('  é”™è¯¯: ReferenceError');
        console.log('  åŸå› : let x ä½¿å¾—æ•´ä¸ªå—å†…éƒ½åœ¨ TDZ');
    }
}</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 6ï¼šä½œç”¨åŸŸé“¾ä¼˜åŒ–</h3>
                <div class="code-block">
                    <pre><code>// ä½œç”¨åŸŸé“¾ä¼˜åŒ–
console.log('=== ä½œç”¨åŸŸé“¾ä¼˜åŒ– ===\n');

console.log('ç¤ºä¾‹: å¾ªç¯ä¸­è®¿é—®å¤–å±‚å˜é‡\n');

// æ¨¡æ‹Ÿæ€§èƒ½æµ‹è¯•
const iterations = 1000;

console.log('1. æœªä¼˜åŒ–ï¼ˆæ¯æ¬¡æŸ¥æ‰¾ï¼‰:');
let start1 = Date.now();
{
    const outerValue = 'test';
    let result = '';
    for (let i = 0; i < iterations; i++) {
        result += outerValue;  // æ¯æ¬¡éƒ½æŸ¥æ‰¾ä½œç”¨åŸŸé“¾
    }
}
console.log('  è€—æ—¶:', Date.now() - start1, 'ms');

console.log('\n2. ä¼˜åŒ–ï¼ˆç¼“å­˜å˜é‡ï¼‰:');
let start2 = Date.now();
{
    const outerValue = 'test';
    const cached = outerValue;  // ç¼“å­˜
    let result = '';
    for (let i = 0; i < iterations; i++) {
        result += cached;  // ç›´æ¥è®¿é—®æœ¬åœ°å˜é‡
    }
}
console.log('  è€—æ—¶:', Date.now() - start2, 'ms');

console.log('\nä¼˜åŒ–å»ºè®®:');
console.log('  âœ“ ç¼“å­˜å¤–å±‚å˜é‡');
console.log('  âœ“ å‡å°‘ä½œç”¨åŸŸé“¾æ·±åº¦');
console.log('  âœ“ ä½¿ç”¨å±€éƒ¨å˜é‡');</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
        </div>
    </div>
    
    <script src="../assets/js/common.js"></script>
</body>
</html>
