<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Symbol ä¸ BigInt - JavaScript æ·±åº¦å­¦ä¹ </title>
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="../assets/css/page.css">
</head>
<body>
    <div class="page-layout">
        <div class="doc-panel">
            <h1>Symbol ä¸ BigInt</h1>
            
            <h2>æ¦‚è¿°</h2>
            <p>Symbolï¼ˆES6ï¼‰å’Œ BigIntï¼ˆES2020ï¼‰æ˜¯ JavaScript ä¸­çš„ä¸¤ç§ç‰¹æ®ŠåŸå§‹ç±»å‹ã€‚Symbol ç”¨äºåˆ›å»ºå”¯ä¸€æ ‡è¯†ç¬¦ï¼ŒBigInt ç”¨äºè¡¨ç¤ºä»»æ„ç²¾åº¦çš„æ•´æ•°ã€‚</p>
            
            <h2>ä¸€ã€Symbol</h2>
            
            <h3>1.1 åˆ›å»º Symbol</h3>
            <pre><code>// åŸºæœ¬åˆ›å»º
const sym1 = Symbol();
const sym2 = Symbol('description');

// æ¯ä¸ª Symbol éƒ½æ˜¯å”¯ä¸€çš„
Symbol() === Symbol();  // false
Symbol('foo') === Symbol('foo');  // false</code></pre>
            
            <h3>1.2 Symbol ç‰¹æ€§</h3>
            <div class="info">
                <ul>
                    <li>æ¯ä¸ª Symbol å€¼éƒ½æ˜¯å”¯ä¸€çš„</li>
                    <li>Symbol å€¼ä¸èƒ½ä¸å…¶ä»–ç±»å‹è¿ç®—</li>
                    <li>ä½œä¸ºå¯¹è±¡å±æ€§æ—¶ä¸ä¼šè¢«å¸¸è§„æ–¹æ³•éå†åˆ°</li>
                    <li>å¯ä»¥æ·»åŠ æè¿°ï¼Œä½†ä»…ç”¨äºè°ƒè¯•</li>
                </ul>
            </div>
            
            <h3>1.3 Symbol ä½œä¸ºå±æ€§é”®</h3>
            <pre><code>const sym = Symbol('key');
const obj = {
    [sym]: 'value',
    name: 'Alice'
};

console.log(obj[sym]);  // 'value'
console.log(obj.name);  // 'Alice'

// Symbol å±æ€§ä¸ä¼šè¢«éå†
Object.keys(obj);           // ['name']
for (let key in obj) {}     // åªéå† name
JSON.stringify(obj);        // {"name":"Alice"}

// è·å– Symbol å±æ€§
Object.getOwnPropertySymbols(obj);  // [Symbol(key)]</code></pre>
            
            <h3>1.4 Symbol.for() å’Œ Symbol.keyFor()</h3>
            <pre><code>// Symbol.for() - å…¨å±€æ³¨å†Œ
const s1 = Symbol.for('app.id');
const s2 = Symbol.for('app.id');
s1 === s2;  // trueï¼ˆå…±äº«åŒä¸€ä¸ª Symbolï¼‰

// Symbol.keyFor() - è·å–å…¨å±€ Symbol çš„é”®
Symbol.keyFor(s1);  // 'app.id'

const s3 = Symbol('foo');
Symbol.keyFor(s3);  // undefinedï¼ˆä¸æ˜¯å…¨å±€ Symbolï¼‰</code></pre>
            
            <h3>1.5 å†…ç½® Symbol</h3>
            <table>
                <thead>
                    <tr>
                        <th>å†…ç½® Symbol</th>
                        <th>è¯´æ˜</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>Symbol.iterator</code></td>
                        <td>å®šä¹‰å¯¹è±¡çš„é»˜è®¤è¿­ä»£å™¨</td>
                    </tr>
                    <tr>
                        <td><code>Symbol.toStringTag</code></td>
                        <td>å®šä¹‰ Object.prototype.toString çš„è¿”å›å€¼</td>
                    </tr>
                    <tr>
                        <td><code>Symbol.hasInstance</code></td>
                        <td>å®šä¹‰ instanceof è¡Œä¸º</td>
                    </tr>
                    <tr>
                        <td><code>Symbol.toPrimitive</code></td>
                        <td>å®šä¹‰ç±»å‹è½¬æ¢è¡Œä¸º</td>
                    </tr>
                </tbody>
            </table>
            
            <h3>1.6 Symbol åº”ç”¨åœºæ™¯</h3>
            <pre><code>// 1. ç§æœ‰å±æ€§
const _private = Symbol('private');
class MyClass {
    constructor() {
        this[_private] = 'secret';
    }
    getPrivate() {
        return this[_private];
    }
}

// 2. é˜²æ­¢å±æ€§åå†²çª
const size = Symbol('size');
const obj = {
    [size]: 100,
    size: 'large'  // ä¸å†²çª
};

// 3. å®šä¹‰å¸¸é‡
const COLOR_RED = Symbol('red');
const COLOR_GREEN = Symbol('green');</code></pre>
            
            <h2>äºŒã€BigInt</h2>
            
            <h3>2.1 åˆ›å»º BigInt</h3>
            <pre><code>// ä½¿ç”¨ n åç¼€
const big1 = 123n;
const big2 = 0x1ffffffffn;

// ä½¿ç”¨æ„é€ å‡½æ•°
const big3 = BigInt(123);
const big4 = BigInt('123456789012345678901234567890');

// ä¸èƒ½ç”¨ new
// new BigInt(123);  // TypeError</code></pre>
            
            <h3>2.2 BigInt ç‰¹æ€§</h3>
            <div class="info">
                <ul>
                    <li>å¯ä»¥è¡¨ç¤ºä»»æ„å¤§çš„æ•´æ•°</li>
                    <li>ä¸èƒ½ä¸ Number æ··åˆè¿ç®—</li>
                    <li>ä¸æ”¯æŒ Math å¯¹è±¡çš„æ–¹æ³•</li>
                    <li>é™¤æ³•è¿ç®—ä¼šå‘ä¸‹å–æ•´</li>
                    <li>ä¸èƒ½ç”¨äº JSON.stringify</li>
                </ul>
            </div>
            
            <h3>2.3 BigInt è¿ç®—</h3>
            <pre><code>const a = 10n;
const b = 20n;

// ç®—æœ¯è¿ç®—
a + b;   // 30n
a * b;   // 200n
a / b;   // 0nï¼ˆå‘ä¸‹å–æ•´ï¼‰
a % b;   // 10n
a ** b;  // 100000000000000000000n

// æ¯”è¾ƒè¿ç®—
10n === 10;    // falseï¼ˆç±»å‹ä¸åŒï¼‰
10n == 10;     // true
10n < 20;      // true
10n < 20n;     // true</code></pre>
            
            <h3>2.4 BigInt å’Œ Number è½¬æ¢</h3>
            <pre><code>// BigInt è½¬ Numberï¼ˆå¯èƒ½ä¸¢å¤±ç²¾åº¦ï¼‰
Number(10n);     // 10

// Number è½¬ BigInt
BigInt(10);      // 10n

// ä¸èƒ½æ··åˆè¿ç®—
// 10n + 10;     // TypeError
10n + BigInt(10);  // 20n</code></pre>
            
            <h3>2.5 BigInt æ–¹æ³•</h3>
            <pre><code>const big = 123n;

// toString()
big.toString();       // '123'
big.toString(2);      // '1111011'ï¼ˆäºŒè¿›åˆ¶ï¼‰
big.toString(16);     // '7b'ï¼ˆåå…­è¿›åˆ¶ï¼‰

// valueOf()
big.valueOf();        // 123n

// toLocaleString()
(1234567890n).toLocaleString('zh-CN');  // '1,234,567,890'</code></pre>
            
            <h3>2.6 BigInt åº”ç”¨åœºæ™¯</h3>
            <pre><code>// 1. å¤§æ•´æ•°è®¡ç®—
const factorial = (n) => {
    let result = 1n;
    for (let i = 1n; i <= n; i++) {
        result *= i;
    }
    return result;
};

factorial(20n);  // 2432902008176640000n

// 2. æ—¶é—´æˆ³ï¼ˆçº³ç§’ï¼‰
const timestamp = BigInt(Date.now()) * 1000000n;

// 3. ç²¾ç¡®çš„é‡‘é¢è®¡ç®—ï¼ˆåˆ†ä¸ºå•ä½ï¼‰
const price = 99n;  // 0.99å…ƒ
const quantity = 100n;
const total = price * quantity;  // 9900åˆ†</code></pre>
            
            <h2>ä¸‰ã€Symbol vs BigInt</h2>
            
            <table>
                <thead>
                    <tr>
                        <th>ç‰¹æ€§</th>
                        <th>Symbol</th>
                        <th>BigInt</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ç”¨é€”</td>
                        <td>å”¯ä¸€æ ‡è¯†ç¬¦</td>
                        <td>å¤§æ•´æ•°</td>
                    </tr>
                    <tr>
                        <td>typeof</td>
                        <td>'symbol'</td>
                        <td>'bigint'</td>
                    </tr>
                    <tr>
                        <td>å”¯ä¸€æ€§</td>
                        <td>æ¯ä¸ªéƒ½å”¯ä¸€</td>
                        <td>å€¼ç›¸åŒåˆ™ç›¸ç­‰</td>
                    </tr>
                    <tr>
                        <td>è¿ç®—</td>
                        <td>ä¸æ”¯æŒ</td>
                        <td>æ”¯æŒç®—æœ¯è¿ç®—</td>
                    </tr>
                    <tr>
                        <td>JSON</td>
                        <td>ä¸æ”¯æŒ</td>
                        <td>ä¸æ”¯æŒ</td>
                    </tr>
                </tbody>
            </table>
            
            <h2>å››ã€æœ€ä½³å®è·µ</h2>
            
            <div class="tip">
                <strong>Symbolï¼š</strong>
                <ul>
                    <li>ä½¿ç”¨ Symbol.for() åˆ›å»ºå…¨å±€å…±äº«çš„ Symbol</li>
                    <li>ç»™ Symbol æ·»åŠ æœ‰æ„ä¹‰çš„æè¿°</li>
                    <li>ä½¿ç”¨ Symbol å®šä¹‰ç§æœ‰å±æ€§</li>
                    <li>åˆ©ç”¨å†…ç½® Symbol è‡ªå®šä¹‰å¯¹è±¡è¡Œä¸º</li>
                </ul>
                
                <strong>BigIntï¼š</strong>
                <ul>
                    <li>åªç”¨äºæ•´æ•°ï¼Œä¸ç”¨äºæµ®ç‚¹æ•°</li>
                    <li>æ³¨æ„ä¸ Number çš„ç±»å‹è½¬æ¢</li>
                    <li>é™¤æ³•ä¼šå‘ä¸‹å–æ•´</li>
                    <li>ä¸èƒ½ç”¨äº Math å¯¹è±¡æ–¹æ³•</li>
                    <li>JSON åºåˆ—åŒ–éœ€è¦è‡ªå®šä¹‰å¤„ç†</li>
                </ul>
            </div>
            
            <h2>å‚è€ƒèµ„æ–™</h2>
            <ul>
                <li><a href="https://tc39.es/ecma262/#sec-symbol-objects" target="_blank">ECMAScript - Symbol Objects</a></li>
                <li><a href="https://tc39.es/ecma262/#sec-bigint-objects" target="_blank">ECMAScript - BigInt Objects</a></li>
                <li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Symbol" target="_blank">MDN - Symbol</a></li>
                <li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/BigInt" target="_blank">MDN - BigInt</a></li>
            </ul>
            
            <div class="nav-links">
                <a href="08-set-map.html" class="nav-link prev">ä¸Šä¸€èŠ‚ï¼šSet ä¸ Map</a>
                <a href="../index.html" class="nav-link home">è¿”å›é¦–é¡µ</a>
                <a href="../index.html" class="nav-link next">è¿›é˜¶ç¯‡</a>
            </div>
        </div>
        
        <div class="code-panel">
            <h2 style="color: #60a5fa; margin-bottom: 1.5rem;">ğŸ’» äº¤äº’å¼ä»£ç ç¤ºä¾‹</h2>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 1ï¼šSymbol åŸºç¡€</h3>
                <div class="code-block">
                    <pre><code>// åˆ›å»º Symbol
const sym1 = Symbol();
const sym2 = Symbol('description');
const sym3 = Symbol('description');

console.log('typeof sym1:', typeof sym1);
console.log('sym1 === sym2:', sym1 === sym2);
console.log('sym2 === sym3:', sym2 === sym3);

// æè¿°
console.log('\nsym2.description:', sym2.description);

// Symbol.for()
const globalSym1 = Symbol.for('app.id');
const globalSym2 = Symbol.for('app.id');
console.log('\nglobalSym1 === globalSym2:', globalSym1 === globalSym2);

// Symbol.keyFor()
console.log('Symbol.keyFor(globalSym1):', Symbol.keyFor(globalSym1));
console.log('Symbol.keyFor(sym1):', Symbol.keyFor(sym1));</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 2ï¼šSymbol ä½œä¸ºå±æ€§é”®</h3>
                <div class="code-block">
                    <pre><code>const id = Symbol('id');
const user = {
    name: 'Alice',
    age: 25,
    [id]: 12345
};

console.log('user:', user);
console.log('user[id]:', user[id]);

// å¸¸è§„éå†çœ‹ä¸åˆ° Symbol å±æ€§
console.log('\nObject.keys:', Object.keys(user));
console.log('Object.values:', Object.values(user));
console.log('JSON.stringify:', JSON.stringify(user));

// è·å– Symbol å±æ€§
const symbols = Object.getOwnPropertySymbols(user);
console.log('\ngetOwnPropertySymbols:', symbols);
console.log('symbol description:', symbols[0].description);

// è·å–æ‰€æœ‰å±æ€§ï¼ˆåŒ…æ‹¬ Symbolï¼‰
console.log('\nReflect.ownKeys:', Reflect.ownKeys(user));</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 3ï¼šSymbol åº”ç”¨</h3>
                <div class="code-block">
                    <pre><code>// åº”ç”¨1ï¼šç§æœ‰å±æ€§
const _balance = Symbol('balance');

class BankAccount {
    constructor(initial) {
        this[_balance] = initial;
    }
    
    deposit(amount) {
        this[_balance] += amount;
    }
    
    getBalance() {
        return this[_balance];
    }
}

const account = new BankAccount(1000);
account.deposit(500);
console.log('ä½™é¢:', account.getBalance());
console.log('ç›´æ¥è®¿é—®:', account[_balance]); // undefinedï¼ˆä¸åŒçš„ Symbolï¼‰

// åº”ç”¨2ï¼šé˜²æ­¢å±æ€§åå†²çª
const lib1Size = Symbol('size');
const lib2Size = Symbol('size');

const obj = {
    [lib1Size]: 100,
    [lib2Size]: 200,
    size: 'large'
};

console.log('\nobj[lib1Size]:', obj[lib1Size]);
console.log('obj[lib2Size]:', obj[lib2Size]);
console.log('obj.size:', obj.size);</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 4ï¼šBigInt åŸºç¡€</h3>
                <div class="code-block">
                    <pre><code>// åˆ›å»º BigInt
const big1 = 123n;
const big2 = BigInt(456);
const big3 = BigInt('789012345678901234567890');

console.log('big1:', big1);
console.log('big2:', big2);
console.log('big3:', big3);

console.log('\ntypeof big1:', typeof big1);

// è¿ç®—
const a = 10n;
const b = 3n;

console.log('\nç®—æœ¯è¿ç®—:');
console.log('10n + 3n =', a + b);
console.log('10n - 3n =', a - b);
console.log('10n * 3n =', a * b);
console.log('10n / 3n =', a / b, '(å‘ä¸‹å–æ•´)');
console.log('10n % 3n =', a % b);
console.log('2n ** 10n =', 2n ** 10n);

// æ¯”è¾ƒ
console.log('\næ¯”è¾ƒ:');
console.log('10n === 10:', 10n === 10);
console.log('10n == 10:', 10n == 10);
console.log('10n < 20:', 10n < 20);</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 5ï¼šBigInt åº”ç”¨</h3>
                <div class="code-block">
                    <pre><code>// å¤§æ•´æ•°è®¡ç®—ï¼šé˜¶ä¹˜
function factorial(n) {
    if (n <= 1n) return 1n;
    let result = 1n;
    for (let i = 2n; i <= n; i++) {
        result *= i;
    }
    return result;
}

console.log('10! =', factorial(10n));
console.log('20! =', factorial(20n));

// å¤§æ•´æ•°ï¼šæ–æ³¢é‚£å¥‘æ•°åˆ—
function fibonacci(n) {
    if (n <= 1n) return n;
    let a = 0n, b = 1n;
    for (let i = 2n; i <= n; i++) {
        [a, b] = [b, a + b];
    }
    return b;
}

console.log('\nfib(10) =', fibonacci(10n));
console.log('fib(50) =', fibonacci(50n));
console.log('fib(100) =', fibonacci(100n));

// Number ç²¾åº¦é—®é¢˜ vs BigInt
console.log('\nNumber ç²¾åº¦é—®é¢˜:');
console.log('Number:', 9007199254740992 + 1);
console.log('BigInt:', 9007199254740992n + 1n);</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 6ï¼šSymbol å’Œ BigInt ç»¼åˆ</h3>
                <div class="code-block">
                    <pre><code>// Symbol ç”¨äºå”¯ä¸€æ ‡è¯†
const ID = Symbol('id');
const BALANCE = Symbol('balance');

// BigInt ç”¨äºç²¾ç¡®è®¡ç®—
class Account {
    constructor(id, balance) {
        this[ID] = id;
        this[BALANCE] = BigInt(balance);
    }
    
    deposit(amount) {
        this[BALANCE] += BigInt(amount);
    }
    
    withdraw(amount) {
        const value = BigInt(amount);
        if (this[BALANCE] >= value) {
            this[BALANCE] -= value;
            return true;
        }
        return false;
    }
    
    getBalance() {
        return this[BALANCE];
    }
    
    getId() {
        return this[ID];
    }
}

const account = new Account('ACC001', 1000000n);
console.log('åˆå§‹ä½™é¢:', account.getBalance());

account.deposit(50000n);
console.log('å­˜æ¬¾å:', account.getBalance());

account.withdraw(30000n);
console.log('å–æ¬¾å:', account.getBalance());

// Symbol å±æ€§ä¸ä¼šè¢«éå†
console.log('\nObject.keys:', Object.keys(account));
console.log('JSON:', JSON.stringify(account));</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
        </div>
    </div>
    
    <script src="../assets/js/common.js"></script>
</body>
</html>
