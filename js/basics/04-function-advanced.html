<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜é˜¶å‡½æ•°ä¸æŸ¯é‡ŒåŒ– - JavaScript æ·±åº¦å­¦ä¹ </title>
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="../assets/css/page.css">
</head>
<body>
    <div class="page-layout">
        <div class="doc-panel">
            <h1>é«˜é˜¶å‡½æ•°ä¸æŸ¯é‡ŒåŒ–</h1>
            
            <h2>æ¦‚è¿°</h2>
            <p>é«˜é˜¶å‡½æ•°ï¼ˆHigher-Order Functionï¼‰æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒæ¦‚å¿µï¼Œå¯ä»¥è®©ä»£ç æ›´åŠ ç®€æ´ã€å¯å¤ç”¨ã€‚æŸ¯é‡ŒåŒ–æ˜¯é«˜é˜¶å‡½æ•°çš„ä¸€ç§é‡è¦åº”ç”¨ã€‚</p>
            
            <h2>ä¸€ã€é«˜é˜¶å‡½æ•°</h2>
            
            <h3>1.1 ä»€ä¹ˆæ˜¯é«˜é˜¶å‡½æ•°</h3>
            <div class="info">
                <strong>é«˜é˜¶å‡½æ•°å®šä¹‰ï¼š</strong>
                æ»¡è¶³ä»¥ä¸‹è‡³å°‘ä¸€ä¸ªæ¡ä»¶çš„å‡½æ•°ï¼š
                <ul>
                    <li>æ¥å—ä¸€ä¸ªæˆ–å¤šä¸ªå‡½æ•°ä½œä¸ºå‚æ•°</li>
                    <li>è¿”å›ä¸€ä¸ªå‡½æ•°ä½œä¸ºç»“æœ</li>
                </ul>
            </div>
            
            <h3>1.2 æ¥å—å‡½æ•°ä½œä¸ºå‚æ•°</h3>
            <pre><code>// æ•°ç»„æ–¹æ³•éƒ½æ˜¯é«˜é˜¶å‡½æ•°
[1, 2, 3].map(x => x * 2);
[1, 2, 3].filter(x => x > 1);
[1, 2, 3].reduce((acc, cur) => acc + cur, 0);

// è‡ªå®šä¹‰é«˜é˜¶å‡½æ•°
function repeat(n, action) {
    for (let i = 0; i < n; i++) {
        action(i);
    }
}

repeat(3, console.log);  // 0, 1, 2</code></pre>
            
            <h3>1.3 è¿”å›å‡½æ•°ä½œä¸ºç»“æœ</h3>
            <pre><code>function createMultiplier(factor) {
    return function(number) {
        return number * factor;
    };
}

const double = createMultiplier(2);
const triple = createMultiplier(3);

console.log(double(5));  // 10
console.log(triple(5));  // 15</code></pre>
            
            <h2>äºŒã€å¸¸ç”¨é«˜é˜¶å‡½æ•°æ¨¡å¼</h2>
            
            <h3>2.1 map - æ˜ å°„</h3>
            <pre><code>const numbers = [1, 2, 3, 4, 5];
const doubled = numbers.map(x => x * 2);
// [2, 4, 6, 8, 10]</code></pre>
            
            <h3>2.2 filter - è¿‡æ»¤</h3>
            <pre><code>const numbers = [1, 2, 3, 4, 5];
const evens = numbers.filter(x => x % 2 === 0);
// [2, 4]</code></pre>
            
            <h3>2.3 reduce - å½’çº¦</h3>
            <pre><code>const numbers = [1, 2, 3, 4, 5];
const sum = numbers.reduce((acc, cur) => acc + cur, 0);
// 15</code></pre>
            
            <h3>2.4 some / every - æ–­è¨€</h3>
            <pre><code>const numbers = [1, 2, 3, 4, 5];
numbers.some(x => x > 3);   // trueï¼ˆè‡³å°‘ä¸€ä¸ªï¼‰
numbers.every(x => x > 0);  // trueï¼ˆæ‰€æœ‰ï¼‰</code></pre>
            
            <h2>ä¸‰ã€æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰</h2>
            
            <h3>3.1 ä»€ä¹ˆæ˜¯æŸ¯é‡ŒåŒ–</h3>
            <p>æŸ¯é‡ŒåŒ–æ˜¯å°†å¤šå‚æ•°å‡½æ•°è½¬æ¢ä¸ºä¸€ç³»åˆ—å•å‚æ•°å‡½æ•°çš„æŠ€æœ¯ã€‚</p>
            
            <pre><code>// æ™®é€šå‡½æ•°
function add(a, b, c) {
    return a + b + c;
}
add(1, 2, 3);  // 6

// æŸ¯é‡ŒåŒ–å
function curriedAdd(a) {
    return function(b) {
        return function(c) {
            return a + b + c;
        };
    };
}
curriedAdd(1)(2)(3);  // 6

// ES6 ç®€å†™
const curriedAdd = a => b => c => a + b + c;</code></pre>
            
            <h3>3.2 æŸ¯é‡ŒåŒ–çš„ä¼˜åŠ¿</h3>
            <ul>
                <li><strong>å‚æ•°å¤ç”¨</strong>ï¼šé¢„è®¾éƒ¨åˆ†å‚æ•°ï¼Œåˆ›å»ºç‰¹å®šåŠŸèƒ½çš„å‡½æ•°</li>
                <li><strong>å»¶è¿Ÿæ‰§è¡Œ</strong>ï¼šå¯ä»¥åˆ†æ­¥ä¼ å…¥å‚æ•°</li>
                <li><strong>å‡½æ•°ç»„åˆ</strong>ï¼šä¾¿äºç»„åˆå…¶ä»–å‡½æ•°</li>
            </ul>
            
            <h3>3.3 å®ç°é€šç”¨æŸ¯é‡ŒåŒ–å‡½æ•°</h3>
            <pre><code>function curry(fn) {
    return function curried(...args) {
        if (args.length >= fn.length) {
            return fn.apply(this, args);
        } else {
            return function(...nextArgs) {
                return curried.apply(this, args.concat(nextArgs));
            };
        }
    };
}

// ä½¿ç”¨
function sum(a, b, c) {
    return a + b + c;
}

const curriedSum = curry(sum);

curriedSum(1)(2)(3);     // 6
curriedSum(1, 2)(3);     // 6
curriedSum(1)(2, 3);     // 6
curriedSum(1, 2, 3);     // 6</code></pre>
            
            <h2>å››ã€åå‡½æ•°åº”ç”¨ï¼ˆPartial Applicationï¼‰</h2>
            
            <h3>4.1 åå‡½æ•° vs æŸ¯é‡ŒåŒ–</h3>
            <div class="info">
                <ul>
                    <li><strong>æŸ¯é‡ŒåŒ–</strong>ï¼šå°† n å…ƒå‡½æ•°è½¬æ¢ä¸º n ä¸ªä¸€å…ƒå‡½æ•°</li>
                    <li><strong>åå‡½æ•°</strong>ï¼šå›ºå®šå‡½æ•°çš„éƒ¨åˆ†å‚æ•°ï¼Œè¿”å›æ¥å—å‰©ä½™å‚æ•°çš„æ–°å‡½æ•°</li>
                </ul>
            </div>
            
            <h3>4.2 å®ç°åå‡½æ•°</h3>
            <pre><code>function partial(fn, ...presetArgs) {
    return function(...laterArgs) {
        return fn(...presetArgs, ...laterArgs);
    };
}

// ä½¿ç”¨
function multiply(a, b, c) {
    return a * b * c;
}

const double = partial(multiply, 2);
double(3, 4);  // 24 (2 * 3 * 4)</code></pre>
            
            <h3>4.3 ä½¿ç”¨ bind å®ç°åå‡½æ•°</h3>
            <pre><code>const greet = (greeting, name) => `${greeting}, ${name}!`;

const sayHello = greet.bind(null, 'Hello');
sayHello('Alice');  // "Hello, Alice!"</code></pre>
            
            <h2>äº”ã€å‡½æ•°ç»„åˆï¼ˆFunction Compositionï¼‰</h2>
            
            <h3>5.1 ä»€ä¹ˆæ˜¯å‡½æ•°ç»„åˆ</h3>
            <p>å°†å¤šä¸ªå‡½æ•°ç»„åˆæˆä¸€ä¸ªå‡½æ•°ï¼Œä»å³åˆ°å·¦æ‰§è¡Œã€‚</p>
            
            <pre><code>// æ•°å­¦è¡¨è¾¾ï¼šf(g(x))
const compose = (f, g) => x => f(g(x));

// å¤šä¸ªå‡½æ•°ç»„åˆ
const compose = (...fns) => x => 
    fns.reduceRight((acc, fn) => fn(acc), x);</code></pre>
            
            <h3>5.2 pipe å‡½æ•°</h3>
            <p>ä¸ compose ç›¸åï¼Œä»å·¦åˆ°å³æ‰§è¡Œï¼š</p>
            
            <pre><code>const pipe = (...fns) => x => 
    fns.reduce((acc, fn) => fn(acc), x);

// ä½¿ç”¨
const addOne = x => x + 1;
const double = x => x * 2;
const square = x => x * x;

const transform = pipe(addOne, double, square);
transform(2);  // ((2 + 1) * 2)^2 = 36</code></pre>
            
            <h2>å…­ã€å¸¸ç”¨å‡½æ•°å¼å·¥å…·</h2>
            
            <h3>6.1 identity - æ’ç­‰å‡½æ•°</h3>
            <pre><code>const identity = x => x;

// ç”¨äºè¿‡æ»¤å‡å€¼
[0, 1, false, 2, '', 3].filter(identity);
// [1, 2, 3]</code></pre>
            
            <h3>6.2 constant - å¸¸é‡å‡½æ•°</h3>
            <pre><code>const constant = value => () => value;

const getTrue = constant(true);
getTrue();  // true</code></pre>
            
            <h3>6.3 flip - ç¿»è½¬å‚æ•°</h3>
            <pre><code>const flip = fn => (a, b) => fn(b, a);

const divide = (a, b) => a / b;
const flippedDivide = flip(divide);

divide(10, 2);         // 5
flippedDivide(10, 2);  // 0.2</code></pre>
            
            <h3>6.4 memoize - è®°å¿†åŒ–</h3>
            <p>ç¼“å­˜å‡½æ•°ç»“æœï¼Œé¿å…é‡å¤è®¡ç®—ï¼š</p>
            
            <pre><code>function memoize(fn) {
    const cache = new Map();
    return function(...args) {
        const key = JSON.stringify(args);
        if (cache.has(key)) {
            return cache.get(key);
        }
        const result = fn.apply(this, args);
        cache.set(key, result);
        return result;
    };
}</code></pre>
            
            <h2>ä¸ƒã€å®é™…åº”ç”¨</h2>
            
            <h3>7.1 æ•°æ®å¤„ç†ç®¡é“</h3>
            <pre><code>const users = [
    { name: 'Alice', age: 25, active: true },
    { name: 'Bob', age: 30, active: false },
    { name: 'Charlie', age: 28, active: true }
];

const result = users
    .filter(u => u.active)
    .map(u => u.name)
    .sort();

console.log(result);  // ['Alice', 'Charlie']</code></pre>
            
            <h3>7.2 è¡¨å•éªŒè¯</h3>
            <pre><code>const required = value => value.trim() !== '';
const minLength = min => value => value.length >= min;
const maxLength = max => value => value.length <= max;
const isEmail = value => /^[^@]+@[^@]+$/.test(value);

const validate = (value, ...validators) => 
    validators.every(validator => validator(value));

// ä½¿ç”¨
const username = 'alice';
const isValid = validate(
    username,
    required,
    minLength(3),
    maxLength(20)
);</code></pre>
            
            <h3>7.3 é˜²æŠ–å’ŒèŠ‚æµ</h3>
            <pre><code>// é˜²æŠ–
function debounce(fn, delay) {
    let timer;
    return function(...args) {
        clearTimeout(timer);
        timer = setTimeout(() => fn.apply(this, args), delay);
    };
}

// èŠ‚æµ
function throttle(fn, delay) {
    let last = 0;
    return function(...args) {
        const now = Date.now();
        if (now - last >= delay) {
            last = now;
            fn.apply(this, args);
        }
    };
}</code></pre>
            
            <h2>å…«ã€æœ€ä½³å®è·µ</h2>
            
            <div class="tip">
                <ol>
                    <li><strong>çº¯å‡½æ•°</strong>ï¼šå°½é‡ç¼–å†™æ— å‰¯ä½œç”¨çš„å‡½æ•°</li>
                    <li><strong>å•ä¸€èŒè´£</strong>ï¼šæ¯ä¸ªå‡½æ•°åªåšä¸€ä»¶äº‹</li>
                    <li><strong>å¯ç»„åˆ</strong>ï¼šè®¾è®¡ä¾¿äºç»„åˆçš„å°å‡½æ•°</li>
                    <li><strong>å£°æ˜å¼</strong>ï¼šä½¿ç”¨ map/filter/reduce ä»£æ›¿å¾ªç¯</li>
                    <li><strong>ä¸å¯å˜æ€§</strong>ï¼šé¿å…ä¿®æ”¹åŸå§‹æ•°æ®</li>
                    <li><strong>å‘½å</strong>ï¼šä½¿ç”¨æ¸…æ™°çš„å‡½æ•°å</li>
                </ol>
            </div>
            
            <h2>å‚è€ƒèµ„æ–™</h2>
            <ul>
                <li><a href="https://github.com/getify/Functional-Light-JS" target="_blank">Functional-Light JavaScript</a></li>
                <li><a href="https://mostly-adequate.gitbook.io/mostly-adequate-guide/" target="_blank">Professor Frisby's Mostly Adequate Guide to Functional Programming</a></li>
                <li><a href="https://ramdajs.com/" target="_blank">Ramda - å‡½æ•°å¼ç¼–ç¨‹åº“</a></li>
            </ul>
            
            <div class="nav-links">
                <a href="04-arrow-function.html" class="nav-link prev">ä¸Šä¸€èŠ‚ï¼šç®­å¤´å‡½æ•°</a>
                <a href="../index.html" class="nav-link home">è¿”å›é¦–é¡µ</a>
                <a href="05-prototype.html" class="nav-link next">ä¸‹ä¸€èŠ‚ï¼šåŸå‹ä¸åŸå‹é“¾</a>
            </div>
        </div>
        
        <div class="code-panel">
            <h2 style="color: #60a5fa; margin-bottom: 1.5rem;">ğŸ’» äº¤äº’å¼ä»£ç ç¤ºä¾‹</h2>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 1ï¼šé«˜é˜¶å‡½æ•°åŸºç¡€</h3>
                <div class="code-block">
                    <pre><code>// æ¥å—å‡½æ•°ä½œä¸ºå‚æ•°
function repeat(n, action) {
    for (let i = 0; i < n; i++) {
        action(i);
    }
}

console.log('=== repeat ç¤ºä¾‹ ===');
repeat(3, i => console.log(`ç¬¬ ${i + 1} æ¬¡`));

// è¿”å›å‡½æ•°
function createGreeter(greeting) {
    return function(name) {
        return `${greeting}, ${name}!`;
    };
}

const sayHello = createGreeter('Hello');
const sayHi = createGreeter('Hi');

console.log('\n=== è¿”å›å‡½æ•°ç¤ºä¾‹ ===');
console.log(sayHello('Alice'));
console.log(sayHi('Bob'));</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 2ï¼šæŸ¯é‡ŒåŒ–</h3>
                <div class="code-block">
                    <pre><code>// æ‰‹åŠ¨æŸ¯é‡ŒåŒ–
const add = a => b => c => a + b + c;

console.log('add(1)(2)(3):', add(1)(2)(3));

// éƒ¨åˆ†åº”ç”¨
const add5 = add(5);
const add5and10 = add5(10);
console.log('add5and10(2):', add5and10(2));

// é€šç”¨æŸ¯é‡ŒåŒ–å‡½æ•°
function curry(fn) {
    return function curried(...args) {
        if (args.length >= fn.length) {
            return fn.apply(this, args);
        }
        return function(...nextArgs) {
            return curried.apply(this, args.concat(nextArgs));
        };
    };
}

function multiply(a, b, c) {
    return a * b * c;
}

const curriedMultiply = curry(multiply);

console.log('\n=== é€šç”¨æŸ¯é‡ŒåŒ– ===');
console.log('curriedMultiply(2)(3)(4):', curriedMultiply(2)(3)(4));
console.log('curriedMultiply(2, 3)(4):', curriedMultiply(2, 3)(4));
console.log('curriedMultiply(2)(3, 4):', curriedMultiply(2)(3, 4));</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 3ï¼šå‡½æ•°ç»„åˆ</h3>
                <div class="code-block">
                    <pre><code>// pipe - ä»å·¦åˆ°å³
const pipe = (...fns) => x => 
    fns.reduce((acc, fn) => fn(acc), x);

// compose - ä»å³åˆ°å·¦
const compose = (...fns) => x => 
    fns.reduceRight((acc, fn) => fn(acc), x);

// å®šä¹‰åŸºæœ¬å‡½æ•°
const addOne = x => x + 1;
const double = x => x * 2;
const square = x => x * x;

// ä½¿ç”¨ pipe
const pipeline = pipe(addOne, double, square);
console.log('pipe(addOne, double, square)(2):');
console.log('  (2 + 1) * 2 = 6, 6^2 =', pipeline(2));

// ä½¿ç”¨ compose
const composition = compose(square, double, addOne);
console.log('\ncompose(square, double, addOne)(2):');
console.log('  (2 + 1) * 2 = 6, 6^2 =', composition(2));

// å®ç”¨ä¾‹å­ï¼šæ–‡æœ¬å¤„ç†
const trim = str => str.trim();
const lowercase = str => str.toLowerCase();
const capitalize = str => str.charAt(0).toUpperCase() + str.slice(1);

const normalizeText = pipe(trim, lowercase, capitalize);
console.log('\nnormalizeText("  HELLO  "):', normalizeText("  HELLO  "));</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 4ï¼šmap/filter/reduce</h3>
                <div class="code-block">
                    <pre><code>const numbers = [1, 2, 3, 4, 5];

// map - æ˜ å°„
const doubled = numbers.map(x => x * 2);
console.log('map:', doubled);

// filter - è¿‡æ»¤
const evens = numbers.filter(x => x % 2 === 0);
console.log('filter:', evens);

// reduce - å½’çº¦
const sum = numbers.reduce((acc, cur) => acc + cur, 0);
console.log('reduce sum:', sum);

// é“¾å¼è°ƒç”¨
const result = numbers
    .map(x => x * 2)         // [2, 4, 6, 8, 10]
    .filter(x => x > 5)      // [6, 8, 10]
    .reduce((a, b) => a + b, 0);  // 24

console.log('\né“¾å¼è°ƒç”¨ç»“æœ:', result);

// å®ç”¨ï¼šæ•°æ®å¤„ç†
const users = [
    { name: 'Alice', age: 25, score: 85 },
    { name: 'Bob', age: 30, score: 92 },
    { name: 'Charlie', age: 28, score: 78 },
    { name: 'David', age: 22, score: 95 }
];

const highScorers = users
    .filter(u => u.score >= 85)
    .map(u => u.name)
    .sort();

console.log('\né«˜åˆ†å­¦ç”Ÿ:', highScorers);</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 5ï¼šè®°å¿†åŒ–</h3>
                <div class="code-block">
                    <pre><code>// è®°å¿†åŒ–å‡½æ•°
function memoize(fn) {
    const cache = new Map();
    return function(...args) {
        const key = JSON.stringify(args);
        if (cache.has(key)) {
            console.log('ä»ç¼“å­˜è¿”å›:', key);
            return cache.get(key);
        }
        console.log('è®¡ç®—ç»“æœ:', key);
        const result = fn.apply(this, args);
        cache.set(key, result);
        return result;
    };
}

// æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼ˆæœªä¼˜åŒ–ç‰ˆæœ¬ï¼‰
function fibonacci(n) {
    if (n <= 1) return n;
    return fibonacci(n - 1) + fibonacci(n - 2);
}

// è®°å¿†åŒ–ç‰ˆæœ¬
const memoFib = memoize(fibonacci);

console.log('=== é¦–æ¬¡è°ƒç”¨ ===');
console.log('memoFib(10):', memoFib(10));

console.log('\n=== å†æ¬¡è°ƒç”¨ï¼ˆä½¿ç”¨ç¼“å­˜ï¼‰===');
console.log('memoFib(10):', memoFib(10));

console.log('\n=== è®¡ç®—å¦ä¸€ä¸ªå€¼ ===');
console.log('memoFib(8):', memoFib(8));</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
            
            <div class="code-example">
                <h3>ç¤ºä¾‹ 6ï¼šå®ç”¨å·¥å…·å‡½æ•°</h3>
                <div class="code-block">
                    <pre><code>// åå‡½æ•°åº”ç”¨
function partial(fn, ...presetArgs) {
    return function(...laterArgs) {
        return fn(...presetArgs, ...laterArgs);
    };
}

function greet(greeting, name, punctuation) {
    return `${greeting}, ${name}${punctuation}`;
}

const sayHello = partial(greet, 'Hello');
console.log(sayHello('Alice', '!'));
console.log(sayHello('Bob', '.'));

// é˜²æŠ–
function debounce(fn, delay) {
    let timer;
    return function(...args) {
        clearTimeout(timer);
        timer = setTimeout(() => {
            fn.apply(this, args);
        }, delay);
    };
}

// èŠ‚æµ
function throttle(fn, delay) {
    let last = 0;
    return function(...args) {
        const now = Date.now();
        if (now - last >= delay) {
            last = now;
            fn.apply(this, args);
        }
    };
}

console.log('\né˜²æŠ–å’ŒèŠ‚æµå‡½æ•°å·²å®šä¹‰');

// å‡½æ•°ç»„åˆå·¥å…·
const identity = x => x;
const constant = value => () => value;

console.log('\nidentity(42):', identity(42));
console.log('constant(42)():', constant(42)());

// è¿‡æ»¤å‡å€¼
const values = [0, 1, false, 2, '', 3, null, 4, undefined, 5];
console.log('è¿‡æ»¤å‡å€¼:', values.filter(identity));</code></pre>
                </div>
                <button class="run-btn">â–¶ è¿è¡Œä»£ç </button>
                <div class="output"></div>
            </div>
        </div>
    </div>
    
    <script src="../assets/js/common.js"></script>
</body>
</html>
