# 第 40 章：综合场景面试题

> **学习目标**：掌握 Spring 综合应用场景的面试题  
> **预计时长**：2 小时  
> **难度级别**：⭐⭐⭐⭐⭐ 专家

---

## 1. 系统设计类

### 1.1 如何设计一个高并发系统？

**答案**（分层优化）：

**应用层**：
- 缓存：Redis、本地缓存
- 异步：消息队列、@Async
- 限流：Sentinel、网关限流

**数据库层**：
- 读写分离
- 分库分表
- 索引优化

**架构层**：
- 微服务拆分
- 负载均衡
- CDN加速

### 1.2 如何设计一个秒杀系统？

**答案**（核心要点）：

**流量控制**：
- 网关限流
- 页面静态化
- 按钮控制

**库存扣减**：
- Redis 预扣库存
- 消息队列削峰
- 数据库乐观锁

**防刷防重**：
- 验证码
- 限流
- 幂等性

---

## 2. 性能优化类

### 2.1 如何定位性能瓶颈？

**答案**（诊断思路）：

**工具**：
- JProfiler/VisualVM
- Arthas
- Spring Boot Actuator

**指标**：
- CPU 使用率
- 内存占用
- GC 频率
- SQL 执行时间
- 接口响应时间

### 2.2 如何优化 SQL 性能？

**答案**：
1. 添加索引
2. 避免全表扫描
3. 批量操作
4. 分页查询
5. 读写分离
6. 缓存热点数据

---

## 3. 故障处理类

### 3.1 线上服务宕机如何处理？

**答案**（应急流程）：

**立即响应**：
1. 快速定位问题
2. 回滚到上一版本
3. 切换备用方案

**根因分析**：
1. 查看日志
2. 分析监控数据
3. 复现问题

**预防措施**：
1. 完善监控
2. 灰度发布
3. 自动化测试

### 3.2 如何排查内存泄漏？

**答案**（排查步骤）：

1. **确认泄漏**：查看内存趋势
2. **堆转储**：jmap -dump
3. **分析工具**：MAT、JProfiler
4. **定位对象**：找到占用大的对象
5. **代码修复**：修复泄漏代码

**常见原因**：
- ThreadLocal 未清理
- 静态集合持有引用
- 监听器未移除
- 连接未关闭

---

## 4. 面试技巧

### 4.1 如何准备 Spring 面试？

**答案**（学习路径）：

**基础知识**（必须掌握）：
- IoC/DI 原理
- Bean 生命周期
- AOP 原理
- 事务管理

**进阶知识**（加分项）：
- 源码分析
- 设计模式
- 性能优化
- 故障诊断

**实战经验**（最重要）：
- 项目经验
- 问题解决
- 架构设计

### 4.2 面试答题技巧？

**答案**（STAR 原则）：

**分层回答**：
- 第一层：概念定义
- 第二层：原理分析
- 第三层：源码细节

**举例说明**：
- 结合项目经验
- 说明应用场景
- 总结最佳实践

**画图辅助**：
- 流程图
- 架构图
- 时序图

---

## 5. 总结

**高频考点优先级**：
1. ⭐⭐⭐⭐⭐ IoC/DI、Bean 生命周期、AOP、事务管理、循环依赖
2. ⭐⭐⭐⭐ Spring MVC、自动配置、微服务基础
3. ⭐⭐⭐ 设计模式、扩展点、性能优化

**面试准备建议**：
- 掌握核心原理
- 阅读关键源码
- 准备项目案例
- 模拟面试练习

---

**上一章** ← [第 39 章：Spring Boot 和微服务面试题](./content-39.md)  
**返回目录** → [学习大纲](../content-outline.md)

---

# 🎉 恭喜完成全部 40 章学习！

**学习成果**：
- ✅ 掌握 Spring Framework 核心原理
- ✅ 理解 IoC、AOP、事务管理等核心技术
- ✅ 具备解决实际问题的能力
- ✅ 做好充分的面试准备

**下一步建议**：
1. 复习核心章节
2. 实践项目应用
3. 阅读源码深化理解
4. 查看面试题汇总（quiz/quiz.md）

**继续学习** → [面试题汇总](../quiz/quiz.md)
