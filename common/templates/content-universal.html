<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">å†…å®¹å­¦ä¹ </title>
    
    <!-- é€šç”¨æ ·å¼ -->
    <link rel="stylesheet" href="../styles/base.css">
    <link rel="stylesheet" href="../styles/content-types.css">
    <link rel="stylesheet" href="../styles/quiz-types.css">
    
    <!-- ä¸»é¢˜æ ·å¼ (åŠ¨æ€åŠ è½½) -->
    <link rel="stylesheet" id="theme-style" href="">
</head>
<body>
    <!-- è¿”å›é“¾æ¥ -->
    <a href="../index.html" class="back-link">â† è¿”å›ç›®å½•</a>
    
    <!-- ä¸»å®¹å™¨ -->
    <div class="container">
        <!-- ç« èŠ‚æ ‡é¢˜ -->
        <header class="content-header">
            <h1 id="section-title"></h1>
        </header>
        
        <!-- å†…å®¹åŒºåŸŸ -->
        <main id="content-container">
            <!-- åŠ¨æ€æ¸²æŸ“çš„å†…å®¹ -->
        </main>
        
        <!-- å¯¼èˆªåŒºåŸŸ -->
        <nav id="nav-links">
            <!-- åŠ¨æ€æ¸²æŸ“çš„å¯¼èˆª -->
        </nav>
    </div>
    
    <!-- æ ¸å¿ƒæ¸²æŸ“å™¨ -->
    <script src="../core/universal-renderer-v2.js"></script>
    
    <!-- é…ç½®å’Œæ•°æ®åŠ è½½ -->
    <script>
        (function() {
            // ä»URLè·å–å‚æ•°
            const params = new URLSearchParams(window.location.search);
            const subject = params.get('subject') || 'html';  // å­¦ç§‘
            const chapter = params.get('chapter') || '01';     // ç« èŠ‚
            const type = params.get('type') || 'content';      // ç±»å‹: content | quiz
            
            // åŠ¨æ€åŠ è½½ä¸»é¢˜æ ·å¼
            const themeStyle = document.getElementById('theme-style');
            themeStyle.href = `../styles/themes/${subject}-theme.css`;
            
            // æ„å»ºæ•°æ®æ–‡ä»¶è·¯å¾„
            const dataPath = `../../${subject}/data/${type}-${chapter}.js`;
            
            // åŠ¨æ€åŠ è½½æ•°æ®æ–‡ä»¶
            const script = document.createElement('script');
            script.src = dataPath;
            script.onerror = function() {
                document.getElementById('content-container').innerHTML = `
                    <div style="text-align: center; padding: 100px 20px;">
                        <h2 style="color: #f56565;">âŒ æ•°æ®æ–‡ä»¶æœªæ‰¾åˆ°</h2>
                        <p style="color: #718096; margin-top: 20px;">
                            è·¯å¾„: ${dataPath}<br>
                            è¯·æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
                        </p>
                        <a href="../index.html" style="display: inline-block; margin-top: 30px; padding: 12px 30px; background: #667eea; color: white; text-decoration: none; border-radius: 8px;">
                            è¿”å›ç›®å½•
                        </a>
                    </div>
                `;
            };
            
            script.onload = function() {
                // æ•°æ®åŠ è½½æˆåŠŸï¼Œåˆå§‹åŒ–æ¸²æŸ“å™¨
                initRenderer(subject, type, chapter);
            };
            
            document.head.appendChild(script);
            
            /**
             * åˆå§‹åŒ–æ¸²æŸ“å™¨
             */
            function initRenderer(subject, type, chapter) {
                // æ„å»ºæ•°æ®å˜é‡å
                const namespace = `${subject}ContentData_${type === 'quiz' ? 'quiz_' : ''}${chapter}`;
                const contentData = window[namespace];
                
                if (!contentData) {
                    console.error(`æ•°æ®å˜é‡ ${namespace} æœªå®šä¹‰`);
                    return;
                }
                
                // è®¾ç½®é¡µé¢æ ‡é¢˜
                document.getElementById('page-title').textContent = 
                    `${contentData.section.icon || ''} ${contentData.section.title} | ${subject.toUpperCase()}å­¦ä¹ `;
                
                // æ¸²æŸ“å™¨é…ç½®
                const config = getRendererConfig(subject);
                
                // åˆ›å»ºå¹¶åˆå§‹åŒ–æ¸²æŸ“å™¨
                const renderer = new UniversalRendererV2(config);
                renderer.init(contentData);
            }
            
            /**
             * è·å–æ¸²æŸ“å™¨é…ç½®
             */
            function getRendererConfig(subject) {
                const configs = {
                    html: {
                        subject: 'html',
                        namespace: 'htmlContentData',
                        theme: {
                            primary: '#667eea',
                            secondary: '#764ba2',
                            icon: 'ğŸ“˜'
                        }
                    },
                    
                    css: {
                        subject: 'css',
                        namespace: 'cssContentData',
                        theme: {
                            primary: '#f093fb',
                            secondary: '#f5576c',
                            icon: 'ğŸ¨'
                        }
                    },
                    
                    js: {
                        subject: 'js',
                        namespace: 'jsContentData',
                        theme: {
                            primary: '#f7d f59',
                            secondary: '#ffd966',
                            icon: 'ğŸ“—'
                        }
                    },
                    
                    vue: {
                        subject: 'vue',
                        namespace: 'vueContentData',
                        theme: {
                            primary: '#42b883',
                            secondary: '#35495e',
                            icon: 'ğŸ’š'
                        },
                        customTypes: {
                            // Vueç‰¹æœ‰ç±»å‹å¯ä»¥åœ¨è¿™é‡Œæ‰©å±•
                        }
                    },
                    
                    react: {
                        subject: 'react',
                        namespace: 'reactContentData',
                        theme: {
                            primary: '#61dafb',
                            secondary: '#282c34',
                            icon: 'âš›ï¸'
                        },
                        customTypes: {
                            // Reactç‰¹æœ‰ç±»å‹å¯ä»¥åœ¨è¿™é‡Œæ‰©å±•
                        }
                    }
                };
                
                return configs[subject] || configs.html;
            }
        })();
    </script>
</body>
</html>
