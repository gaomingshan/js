# 如何理解工具定位

## 概述

“我该选 Vite 还是 webpack？”这种问题经常在一开始就出现，但它往往跳过了更关键的一步：**先搞清楚你在做什么类型的工程、需要什么范式与能力边界**。

理解工具定位最有效的方式，是用几个“定位坐标轴”来观察它：

- 它优先优化的是 **Dev 体验** 还是 **Prod 产物控制**？
- 它更像 **应用平台** 还是 **构建引擎**？
- 它的生态依赖 **兼容历史** 还是 **拥抱现代**？

---

## 一、坐标轴 1：Dev 体验优先 vs 产物控制优先

### 1.1 Dev 体验优先（反馈速度与 HMR）

特征：

- 冷启动快、增量更新快
- 更依赖“按需转换 + 缓存”
- 对现代浏览器特性（ESM）利用更充分

典型：Vite

### 1.2 产物控制优先（复杂场景与细粒度优化）

特征：

- 拆包策略、runtime、缓存策略可深度定制
- 兼容历史包袱与复杂资源管线
- 适合长期演进的大型工程

典型：webpack（以及以兼容 webpack 生态为目标的一些工具）

> **关键点**
>
> “产物控制强”通常意味着“配置与学习成本更高”，这是 trade-off，不是缺点。

---

## 二、坐标轴 2：应用级工具 vs 构建引擎

### 2.1 应用级工具（提供一整套开发与构建体验）

你得到的是：

- dev server、HMR、默认约定
- 常用能力内置（环境变量、HTML 模板、静态资源处理）
- 插件体系与框架集成

典型：Vite、Rsbuild、Parcel

### 2.2 构建引擎（提供底层能力，方便被嵌入与组合）

你得到的是：

- 更“可编程”的 API（作为库被调用）
- 更靠近“编译器/链接器”的能力边界

典型：esbuild、Rollup、Rspack（更偏 bundler 引擎）

> **直觉理解**
>
> 应用级工具解决“你如何舒服地开发”，引擎解决“你能做到什么、做到多快”。

---

## 三、坐标轴 3：生态兼容优先 vs 现代化优先

### 3.1 生态兼容优先

- 兼容大量历史 loader/plugin
- 迁移成本低
- 但体系更复杂（因为要兼容）

典型：webpack；Rspack 也以兼容 webpack 生态为重要目标之一

### 3.2 现代化优先

- 倾向 ESM、现代浏览器、现代工程默认值
- 插件 API 更简洁、性能更好
- 但在某些历史场景需要额外方案

典型：Vite/Rollup（生态也很强，但整体更偏现代 ESM）

---

## 四、定位方法：用“问题清单”倒推工具

### 4.1 你在做应用还是库？

- 应用：先看 Dev Server/HMR 与框架生态
- 库：先看产物格式、多入口、external、tree shaking

### 4.2 你的约束是什么？

- 是否需要兼容老浏览器？
- 是否有大量历史 webpack loader/plugin？
- 是否是 monorepo、多包共享构建？

### 4.3 你的目标是什么？

- Dev 反馈速度优先？
- 产物体积与缓存策略优先？
- 团队配置可维护性优先？

> **建议**
>
> 选型的顺序应该是：
>
> ```text
> 业务形态（应用/库/SSR）
>   → 构建范式（bundle-first or ESM dev）
>     → 引擎选择（webpack/Rollup/Rspack/esbuild…）
>       → 应用级工具（Vite/Rsbuild/Parcel…）
> ```

---

## 五、把定位落回你会遇到的工具

- **webpack**：应用级构建系统 + bundler，引入成本高，但可控性与生态极强
- **Rollup**：偏“产物质量/库构建”的 bundler，ESM 友好、tree shaking 强
- **esbuild**：高速构建引擎，常作为底层组件/预构建工具
- **Rspack**：更快的 bundler，引导你在“更现代的性能”下继续用 webpack 生态
- **Rsbuild**：应用级工具，提供企业级默认值与工程体验
- **Vite**：以 ESM Dev 范式为核心，Dev 体验优秀，Prod 通常交给 Rollup
- **Parcel**：零配置体验，适合快速启动与中小型项目

---

## 参考资料

- [Vite - Guide](https://vite.dev/guide/)
- [webpack - Concepts](https://webpack.js.org/concepts/)
- [Rollup - Documentation](https://rollupjs.org/)
- [Rsbuild](https://rsbuild.dev/)
